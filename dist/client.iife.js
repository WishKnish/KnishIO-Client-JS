var KnishIO=function(xe){"use strict";const Fs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bs="ARRAYBUFFER not supported by this environment",Ps="UINT8ARRAY not supported by this environment";function $s(r,e,t,n){let i,s,o;const a=e||[0],c=(t=t||0)>>>3,l=n===-1?3:0;for(i=0;i<r.length;i+=1)o=i+c,s=o>>>2,a.length<=s&&a.push(0),a[s]|=r[i]<<8*(l+n*(o%4));return{value:a,binLen:8*r.length+t}}function Gt(r,e,t){switch(e){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(r){case"HEX":return function(n,i,s){return function(o,a,c,l){let u,d,p,y;if(o.length%2!=0)throw new Error("String of HEX type must be in byte increments");const v=a||[0],E=(c=c||0)>>>3,w=l===-1?3:0;for(u=0;u<o.length;u+=2){if(d=parseInt(o.substr(u,2),16),isNaN(d))throw new Error("String of HEX type contains invalid characters");for(y=(u>>>1)+E,p=y>>>2;v.length<=p;)v.push(0);v[p]|=d<<8*(w+l*(y%4))}return{value:v,binLen:4*o.length+c}}(n,i,s,t)};case"TEXT":return function(n,i,s){return function(o,a,c,l,u){let d,p,y,v,E,w,b,k,S=0;const I=c||[0],O=(l=l||0)>>>3;if(a==="UTF8")for(b=u===-1?3:0,y=0;y<o.length;y+=1)for(d=o.charCodeAt(y),p=[],128>d?p.push(d):2048>d?(p.push(192|d>>>6),p.push(128|63&d)):55296>d||57344<=d?p.push(224|d>>>12,128|d>>>6&63,128|63&d):(y+=1,d=65536+((1023&d)<<10|1023&o.charCodeAt(y)),p.push(240|d>>>18,128|d>>>12&63,128|d>>>6&63,128|63&d)),v=0;v<p.length;v+=1){for(w=S+O,E=w>>>2;I.length<=E;)I.push(0);I[E]|=p[v]<<8*(b+u*(w%4)),S+=1}else for(b=u===-1?2:0,k=a==="UTF16LE"&&u!==1||a!=="UTF16LE"&&u===1,y=0;y<o.length;y+=1){for(d=o.charCodeAt(y),k===!0&&(v=255&d,d=v<<8|d>>>8),w=S+O,E=w>>>2;I.length<=E;)I.push(0);I[E]|=d<<8*(b+u*(w%4)),S+=2}return{value:I,binLen:8*S+l}}(n,e,i,s,t)};case"B64":return function(n,i,s){return function(o,a,c,l){let u,d,p,y,v,E,w,b=0;const k=a||[0],S=(c=c||0)>>>3,I=l===-1?3:0,O=o.indexOf("=");if(o.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(o=o.replace(/=/g,""),O!==-1&&O<o.length)throw new Error("Invalid '=' found in base-64 string");for(d=0;d<o.length;d+=4){for(v=o.substr(d,4),y=0,p=0;p<v.length;p+=1)u=Fs.indexOf(v.charAt(p)),y|=u<<18-6*p;for(p=0;p<v.length-1;p+=1){for(w=b+S,E=w>>>2;k.length<=E;)k.push(0);k[E]|=(y>>>16-8*p&255)<<8*(I+l*(w%4)),b+=1}}return{value:k,binLen:8*b+c}}(n,i,s,t)};case"BYTES":return function(n,i,s){return function(o,a,c,l){let u,d,p,y;const v=a||[0],E=(c=c||0)>>>3,w=l===-1?3:0;for(d=0;d<o.length;d+=1)u=o.charCodeAt(d),y=d+E,p=y>>>2,v.length<=p&&v.push(0),v[p]|=u<<8*(w+l*(y%4));return{value:v,binLen:8*o.length+c}}(n,i,s,t)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(Bs)}return function(n,i,s){return function(o,a,c,l){return $s(new Uint8Array(o),a,c,l)}(n,i,s,t)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(Ps)}return function(n,i,s){return $s(n,i,s,t)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function Ls(r,e,t,n){switch(r){case"HEX":return function(i){return function(s,o,a,c){const l="0123456789abcdef";let u,d,p="";const y=o/8,v=a===-1?3:0;for(u=0;u<y;u+=1)d=s[u>>>2]>>>8*(v+a*(u%4)),p+=l.charAt(d>>>4&15)+l.charAt(15&d);return c.outputUpper?p.toUpperCase():p}(i,e,t,n)};case"B64":return function(i){return function(s,o,a,c){let l,u,d,p,y,v="";const E=o/8,w=a===-1?3:0;for(l=0;l<E;l+=3)for(p=l+1<E?s[l+1>>>2]:0,y=l+2<E?s[l+2>>>2]:0,d=(s[l>>>2]>>>8*(w+a*(l%4))&255)<<16|(p>>>8*(w+a*((l+1)%4))&255)<<8|y>>>8*(w+a*((l+2)%4))&255,u=0;u<4;u+=1)v+=8*l+6*u<=o?Fs.charAt(d>>>6*(3-u)&63):c.b64Pad;return v}(i,e,t,n)};case"BYTES":return function(i){return function(s,o,a){let c,l,u="";const d=o/8,p=a===-1?3:0;for(c=0;c<d;c+=1)l=s[c>>>2]>>>8*(p+a*(c%4))&255,u+=String.fromCharCode(l);return u}(i,e,t)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(Bs)}return function(i){return function(s,o,a){let c;const l=o/8,u=new ArrayBuffer(l),d=new Uint8Array(u),p=a===-1?3:0;for(c=0;c<l;c+=1)d[c]=s[c>>>2]>>>8*(p+a*(c%4))&255;return u}(i,e,t)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(Ps)}return function(i){return function(s,o,a){let c;const l=o/8,u=a===-1?3:0,d=new Uint8Array(l);for(c=0;c<l;c+=1)d[c]=s[c>>>2]>>>8*(u+a*(c%4))&255;return d}(i,e,t)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const _r=4294967296,B=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],lt=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],ft=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Sr="Chosen SHA variant is not supported",Us="Cannot set numRounds with MAC";function fn(r,e){let t,n;const i=r.binLen>>>3,s=e.binLen>>>3,o=i<<3,a=4-i<<3;if(i%4!=0){for(t=0;t<s;t+=4)n=i+t>>>2,r.value[n]|=e.value[t>>>2]<<o,r.value.push(0),r.value[n+1]|=e.value[t>>>2]>>>a;return(r.value.length<<2)-4>=s+i&&r.value.pop(),{value:r.value,binLen:r.binLen+e.binLen}}return{value:r.value.concat(e.value),binLen:r.binLen+e.binLen}}function qs(r){const e={outputUpper:!1,b64Pad:"=",outputLen:-1},t=r||{},n="Output length must be a multiple of 8";if(e.outputUpper=t.outputUpper||!1,t.b64Pad&&(e.b64Pad=t.b64Pad),t.outputLen){if(t.outputLen%8!=0)throw new Error(n);e.outputLen=t.outputLen}else if(t.shakeLen){if(t.shakeLen%8!=0)throw new Error(n);e.outputLen=t.shakeLen}if(typeof e.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof e.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return e}function wt(r,e,t,n){const i=r+" must include a value and format";if(!e){if(!n)throw new Error(i);return n}if(e.value===void 0||!e.format)throw new Error(i);return Gt(e.format,e.encoding||"UTF8",t)(e.value)}let hn=class{constructor(e,t,n){const i=n||{};if(this.t=t,this.i=i.encoding||"UTF8",this.numRounds=i.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=e,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(e){let t,n=0;const i=this.m>>>5,s=this.C(e,this.h,this.u),o=s.binLen,a=s.value,c=o>>>5;for(t=0;t<c;t+=i)n+this.m<=o&&(this.U=this.v(a.slice(t,t+i),this.U),n+=this.m);return this.A+=n,this.h=a.slice(n>>>5),this.u=o%this.m,this.l=!0,this}getHash(e,t){let n,i,s=this.R;const o=qs(t);if(this.K){if(o.outputLen===-1)throw new Error("Output length must be specified in options");s=o.outputLen}const a=Ls(e,s,this.T,o);if(this.H&&this.g)return a(this.g(o));for(i=this.F(this.h.slice(),this.u,this.A,this.L(this.U),s),n=1;n<this.numRounds;n+=1)this.K&&s%32!=0&&(i[i.length-1]&=16777215>>>24-s%32),i=this.F(i,s,0,this.B(this.o),s);return a(i)}setHMACKey(e,t,n){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const i=Gt(t,(n||{}).encoding||"UTF8",this.T);this.k(i(e))}k(e){const t=this.m>>>3,n=t/4-1;let i;if(this.numRounds!==1)throw new Error(Us);if(this.H)throw new Error("MAC key already set");for(t<e.binLen/8&&(e.value=this.F(e.value,e.binLen,0,this.B(this.o),this.R));e.value.length<=n;)e.value.push(0);for(i=0;i<=n;i+=1)this.S[i]=909522486^e.value[i],this.p[i]=1549556828^e.value[i];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(e,t){const n=qs(t);return Ls(e,this.R,this.T,n)(this.Y())}Y(){let e;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");const t=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return e=this.v(this.p,this.B(this.o)),e=this.F(t,this.R,this.m,e,this.R),e}};function Jt(r,e){return r<<e|r>>>32-e}function et(r,e){return r>>>e|r<<32-e}function js(r,e){return r>>>e}function Vs(r,e,t){return r^e^t}function Qs(r,e,t){return r&e^~r&t}function Hs(r,e,t){return r&e^r&t^e&t}function Ic(r){return et(r,2)^et(r,13)^et(r,22)}function Oe(r,e){const t=(65535&r)+(65535&e);return(65535&(r>>>16)+(e>>>16)+(t>>>16))<<16|65535&t}function Ac(r,e,t,n){const i=(65535&r)+(65535&e)+(65535&t)+(65535&n);return(65535&(r>>>16)+(e>>>16)+(t>>>16)+(n>>>16)+(i>>>16))<<16|65535&i}function kr(r,e,t,n,i){const s=(65535&r)+(65535&e)+(65535&t)+(65535&n)+(65535&i);return(65535&(r>>>16)+(e>>>16)+(t>>>16)+(n>>>16)+(i>>>16)+(s>>>16))<<16|65535&s}function Oc(r){return et(r,7)^et(r,18)^js(r,3)}function Cc(r){return et(r,6)^et(r,11)^et(r,25)}function Rc(r){return[1732584193,4023233417,2562383102,271733878,3285377520]}function Ws(r,e){let t,n,i,s,o,a,c;const l=[];for(t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],c=0;c<80;c+=1)l[c]=c<16?r[c]:Jt(l[c-3]^l[c-8]^l[c-14]^l[c-16],1),a=c<20?kr(Jt(t,5),Qs(n,i,s),o,1518500249,l[c]):c<40?kr(Jt(t,5),Vs(n,i,s),o,1859775393,l[c]):c<60?kr(Jt(t,5),Hs(n,i,s),o,2400959708,l[c]):kr(Jt(t,5),Vs(n,i,s),o,3395469782,l[c]),o=s,s=i,i=Jt(n,30),n=t,t=a;return e[0]=Oe(t,e[0]),e[1]=Oe(n,e[1]),e[2]=Oe(i,e[2]),e[3]=Oe(s,e[3]),e[4]=Oe(o,e[4]),e}function Nc(r,e,t,n){let i;const s=15+(e+65>>>9<<4),o=e+t;for(;r.length<=s;)r.push(0);for(r[e>>>5]|=128<<24-e%32,r[s]=4294967295&o,r[s-1]=o/_r|0,i=0;i<r.length;i+=16)n=Ws(r.slice(i,i+16),n);return n}let Mc=class extends hn{constructor(e,t,n){if(e!=="SHA-1")throw new Error(Sr);super(e,t,n);const i=n||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=Gt(this.t,this.i,this.T),this.v=Ws,this.L=function(s){return s.slice()},this.B=Rc,this.F=Nc,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,i.hmacKey&&this.k(wt("hmacKey",i.hmacKey,this.T))}};function zs(r){let e;return e=r=="SHA-224"?lt.slice():ft.slice(),e}function Ks(r,e){let t,n,i,s,o,a,c,l,u,d,p;const y=[];for(t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],p=0;p<64;p+=1)y[p]=p<16?r[p]:Ac(et(v=y[p-2],17)^et(v,19)^js(v,10),y[p-7],Oc(y[p-15]),y[p-16]),u=kr(l,Cc(o),Qs(o,a,c),B[p],y[p]),d=Oe(Ic(t),Hs(t,n,i)),l=c,c=a,a=o,o=Oe(s,u),s=i,i=n,n=t,t=Oe(u,d);var v;return e[0]=Oe(t,e[0]),e[1]=Oe(n,e[1]),e[2]=Oe(i,e[2]),e[3]=Oe(s,e[3]),e[4]=Oe(o,e[4]),e[5]=Oe(a,e[5]),e[6]=Oe(c,e[6]),e[7]=Oe(l,e[7]),e}let Dc=class extends hn{constructor(e,t,n){if(e!=="SHA-224"&&e!=="SHA-256")throw new Error(Sr);super(e,t,n);const i=n||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=Gt(this.t,this.i,this.T),this.v=Ks,this.L=function(s){return s.slice()},this.B=zs,this.F=function(s,o,a,c){return function(l,u,d,p,y){let v,E;const w=15+(u+65>>>9<<4),b=u+d;for(;l.length<=w;)l.push(0);for(l[u>>>5]|=128<<24-u%32,l[w]=4294967295&b,l[w-1]=b/_r|0,v=0;v<l.length;v+=16)p=Ks(l.slice(v,v+16),p);return E=y==="SHA-224"?[p[0],p[1],p[2],p[3],p[4],p[5],p[6]]:p,E}(s,o,a,c,e)},this.U=zs(e),this.m=512,this.R=e==="SHA-224"?224:256,this.K=!1,i.hmacKey&&this.k(wt("hmacKey",i.hmacKey,this.T))}};class x{constructor(e,t){this.N=e,this.I=t}}function Gs(r,e){let t;return e>32?(t=64-e,new x(r.I<<e|r.N>>>t,r.N<<e|r.I>>>t)):e!==0?(t=32-e,new x(r.N<<e|r.I>>>t,r.I<<e|r.N>>>t)):r}function tt(r,e){let t;return e<32?(t=32-e,new x(r.N>>>e|r.I<<t,r.I>>>e|r.N<<t)):(t=64-e,new x(r.I>>>e|r.N<<t,r.N>>>e|r.I<<t))}function Js(r,e){return new x(r.N>>>e,r.I>>>e|r.N<<32-e)}function Fc(r,e,t){return new x(r.N&e.N^r.N&t.N^e.N&t.N,r.I&e.I^r.I&t.I^e.I&t.I)}function Bc(r){const e=tt(r,28),t=tt(r,34),n=tt(r,39);return new x(e.N^t.N^n.N,e.I^t.I^n.I)}function Ke(r,e){let t,n;t=(65535&r.I)+(65535&e.I),n=(r.I>>>16)+(e.I>>>16)+(t>>>16);const i=(65535&n)<<16|65535&t;return t=(65535&r.N)+(65535&e.N)+(n>>>16),n=(r.N>>>16)+(e.N>>>16)+(t>>>16),new x((65535&n)<<16|65535&t,i)}function Pc(r,e,t,n){let i,s;i=(65535&r.I)+(65535&e.I)+(65535&t.I)+(65535&n.I),s=(r.I>>>16)+(e.I>>>16)+(t.I>>>16)+(n.I>>>16)+(i>>>16);const o=(65535&s)<<16|65535&i;return i=(65535&r.N)+(65535&e.N)+(65535&t.N)+(65535&n.N)+(s>>>16),s=(r.N>>>16)+(e.N>>>16)+(t.N>>>16)+(n.N>>>16)+(i>>>16),new x((65535&s)<<16|65535&i,o)}function $c(r,e,t,n,i){let s,o;s=(65535&r.I)+(65535&e.I)+(65535&t.I)+(65535&n.I)+(65535&i.I),o=(r.I>>>16)+(e.I>>>16)+(t.I>>>16)+(n.I>>>16)+(i.I>>>16)+(s>>>16);const a=(65535&o)<<16|65535&s;return s=(65535&r.N)+(65535&e.N)+(65535&t.N)+(65535&n.N)+(65535&i.N)+(o>>>16),o=(r.N>>>16)+(e.N>>>16)+(t.N>>>16)+(n.N>>>16)+(i.N>>>16)+(s>>>16),new x((65535&o)<<16|65535&s,a)}function Tr(r,e){return new x(r.N^e.N,r.I^e.I)}function Lc(r){const e=tt(r,19),t=tt(r,61),n=Js(r,6);return new x(e.N^t.N^n.N,e.I^t.I^n.I)}function Uc(r){const e=tt(r,1),t=tt(r,8),n=Js(r,7);return new x(e.N^t.N^n.N,e.I^t.I^n.I)}function qc(r){const e=tt(r,14),t=tt(r,18),n=tt(r,41);return new x(e.N^t.N^n.N,e.I^t.I^n.I)}const jc=[new x(B[0],3609767458),new x(B[1],602891725),new x(B[2],3964484399),new x(B[3],2173295548),new x(B[4],4081628472),new x(B[5],3053834265),new x(B[6],2937671579),new x(B[7],3664609560),new x(B[8],2734883394),new x(B[9],1164996542),new x(B[10],1323610764),new x(B[11],3590304994),new x(B[12],4068182383),new x(B[13],991336113),new x(B[14],633803317),new x(B[15],3479774868),new x(B[16],2666613458),new x(B[17],944711139),new x(B[18],2341262773),new x(B[19],2007800933),new x(B[20],1495990901),new x(B[21],1856431235),new x(B[22],3175218132),new x(B[23],2198950837),new x(B[24],3999719339),new x(B[25],766784016),new x(B[26],2566594879),new x(B[27],3203337956),new x(B[28],1034457026),new x(B[29],2466948901),new x(B[30],3758326383),new x(B[31],168717936),new x(B[32],1188179964),new x(B[33],1546045734),new x(B[34],1522805485),new x(B[35],2643833823),new x(B[36],2343527390),new x(B[37],1014477480),new x(B[38],1206759142),new x(B[39],344077627),new x(B[40],1290863460),new x(B[41],3158454273),new x(B[42],3505952657),new x(B[43],106217008),new x(B[44],3606008344),new x(B[45],1432725776),new x(B[46],1467031594),new x(B[47],851169720),new x(B[48],3100823752),new x(B[49],1363258195),new x(B[50],3750685593),new x(B[51],3785050280),new x(B[52],3318307427),new x(B[53],3812723403),new x(B[54],2003034995),new x(B[55],3602036899),new x(B[56],1575990012),new x(B[57],1125592928),new x(B[58],2716904306),new x(B[59],442776044),new x(B[60],593698344),new x(B[61],3733110249),new x(B[62],2999351573),new x(B[63],3815920427),new x(3391569614,3928383900),new x(3515267271,566280711),new x(3940187606,3454069534),new x(4118630271,4000239992),new x(116418474,1914138554),new x(174292421,2731055270),new x(289380356,3203993006),new x(460393269,320620315),new x(685471733,587496836),new x(852142971,1086792851),new x(1017036298,365543100),new x(1126000580,2618297676),new x(1288033470,3409855158),new x(1501505948,4234509866),new x(1607167915,987167468),new x(1816402316,1246189591)];function Ys(r){return r==="SHA-384"?[new x(3418070365,lt[0]),new x(1654270250,lt[1]),new x(2438529370,lt[2]),new x(355462360,lt[3]),new x(1731405415,lt[4]),new x(41048885895,lt[5]),new x(3675008525,lt[6]),new x(1203062813,lt[7])]:[new x(ft[0],4089235720),new x(ft[1],2227873595),new x(ft[2],4271175723),new x(ft[3],1595750129),new x(ft[4],2917565137),new x(ft[5],725511199),new x(ft[6],4215389547),new x(ft[7],327033209)]}function Xs(r,e){let t,n,i,s,o,a,c,l,u,d,p,y;const v=[];for(t=e[0],n=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],p=0;p<80;p+=1)p<16?(y=2*p,v[p]=new x(r[y],r[y+1])):v[p]=Pc(Lc(v[p-2]),v[p-7],Uc(v[p-15]),v[p-16]),u=$c(l,qc(o),(w=a,b=c,new x((E=o).N&w.N^~E.N&b.N,E.I&w.I^~E.I&b.I)),jc[p],v[p]),d=Ke(Bc(t),Fc(t,n,i)),l=c,c=a,a=o,o=Ke(s,u),s=i,i=n,n=t,t=Ke(u,d);var E,w,b;return e[0]=Ke(t,e[0]),e[1]=Ke(n,e[1]),e[2]=Ke(i,e[2]),e[3]=Ke(s,e[3]),e[4]=Ke(o,e[4]),e[5]=Ke(a,e[5]),e[6]=Ke(c,e[6]),e[7]=Ke(l,e[7]),e}let Vc=class extends hn{constructor(e,t,n){if(e!=="SHA-384"&&e!=="SHA-512")throw new Error(Sr);super(e,t,n);const i=n||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=Gt(this.t,this.i,this.T),this.v=Xs,this.L=function(s){return s.slice()},this.B=Ys,this.F=function(s,o,a,c){return function(l,u,d,p,y){let v,E;const w=31+(u+129>>>10<<5),b=u+d;for(;l.length<=w;)l.push(0);for(l[u>>>5]|=128<<24-u%32,l[w]=4294967295&b,l[w-1]=b/_r|0,v=0;v<l.length;v+=32)p=Xs(l.slice(v,v+32),p);return E=y==="SHA-384"?[p[0].N,p[0].I,p[1].N,p[1].I,p[2].N,p[2].I,p[3].N,p[3].I,p[4].N,p[4].I,p[5].N,p[5].I]:[p[0].N,p[0].I,p[1].N,p[1].I,p[2].N,p[2].I,p[3].N,p[3].I,p[4].N,p[4].I,p[5].N,p[5].I,p[6].N,p[6].I,p[7].N,p[7].I],E}(s,o,a,c,e)},this.U=Ys(e),this.m=1024,this.R=e==="SHA-384"?384:512,this.K=!1,i.hmacKey&&this.k(wt("hmacKey",i.hmacKey,this.T))}};const Qc=[new x(0,1),new x(0,32898),new x(2147483648,32906),new x(2147483648,2147516416),new x(0,32907),new x(0,2147483649),new x(2147483648,2147516545),new x(2147483648,32777),new x(0,138),new x(0,136),new x(0,2147516425),new x(0,2147483658),new x(0,2147516555),new x(2147483648,139),new x(2147483648,32905),new x(2147483648,32771),new x(2147483648,32770),new x(2147483648,128),new x(0,32778),new x(2147483648,2147483658),new x(2147483648,2147516545),new x(2147483648,32896),new x(0,2147483649),new x(2147483648,2147516424)],Hc=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function si(r){let e;const t=[];for(e=0;e<5;e+=1)t[e]=[new x(0,0),new x(0,0),new x(0,0),new x(0,0),new x(0,0)];return t}function Wc(r){let e;const t=[];for(e=0;e<5;e+=1)t[e]=r[e].slice();return t}function pn(r,e){let t,n,i,s;const o=[],a=[];if(r!==null)for(n=0;n<r.length;n+=2)e[(n>>>1)%5][(n>>>1)/5|0]=Tr(e[(n>>>1)%5][(n>>>1)/5|0],new x(r[n+1],r[n]));for(t=0;t<24;t+=1){for(s=si(),n=0;n<5;n+=1)o[n]=(c=e[n][0],l=e[n][1],u=e[n][2],d=e[n][3],p=e[n][4],new x(c.N^l.N^u.N^d.N^p.N,c.I^l.I^u.I^d.I^p.I));for(n=0;n<5;n+=1)a[n]=Tr(o[(n+4)%5],Gs(o[(n+1)%5],1));for(n=0;n<5;n+=1)for(i=0;i<5;i+=1)e[n][i]=Tr(e[n][i],a[n]);for(n=0;n<5;n+=1)for(i=0;i<5;i+=1)s[i][(2*n+3*i)%5]=Gs(e[n][i],Hc[n][i]);for(n=0;n<5;n+=1)for(i=0;i<5;i+=1)e[n][i]=Tr(s[n][i],new x(~s[(n+1)%5][i].N&s[(n+2)%5][i].N,~s[(n+1)%5][i].I&s[(n+2)%5][i].I));e[0][0]=Tr(e[0][0],Qc[t])}var c,l,u,d,p;return e}function Zs(r){let e,t,n=0;const i=[0,0],s=[4294967295&r,r/_r&2097151];for(e=6;e>=0;e--)t=s[e>>2]>>>8*e&255,t===0&&n===0||(i[n+1>>2]|=t<<8*(n+1),n+=1);return n=n!==0?n:1,i[0]|=n,{value:n+1>4?i:[i[0]],binLen:8+8*n}}function oi(r){return fn(Zs(r.binLen),r)}function eo(r,e){let t,n=Zs(e);n=fn(n,r);const i=e>>>2,s=(i-n.value.length%i)%i;for(t=0;t<s;t++)n.value.push(0);return n.value}let zc=class extends hn{constructor(r,e,t){let n=6,i=0;super(r,e,t);const s=t||{};if(this.numRounds!==1){if(s.kmacKey||s.hmacKey)throw new Error(Us);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=Gt(this.t,this.i,this.T),this.v=pn,this.L=Wc,this.B=si,this.U=si(),this.K=!1,r){case"SHA3-224":this.m=i=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=i=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=i=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=i=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":n=31,this.m=i=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":n=31,this.m=i=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":n=4,this.m=i=1344,this.X(t),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":n=4,this.m=i=1088,this.X(t),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=i=1344,n=this.O(t),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=i=1088,n=this.O(t),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(Sr)}this.F=function(o,a,c,l,u){return function(d,p,y,v,E,w,b){let k,S,I=0;const O=[],C=E>>>5,M=p>>>5;for(k=0;k<M&&p>=E;k+=C)v=pn(d.slice(k,k+C),v),p-=E;for(d=d.slice(k),p%=E;d.length<C;)d.push(0);for(k=p>>>3,d[k>>2]^=w<<k%4*8,d[C-1]^=2147483648,v=pn(d,v);32*O.length<b&&(S=v[I%5][I/5|0],O.push(S.I),!(32*O.length>=b));)O.push(S.N),I+=1,64*I%E==0&&(pn(null,v),I=0);return O}(o,a,0,l,i,n,u)},s.hmacKey&&this.k(wt("hmacKey",s.hmacKey,this.T))}O(r,e){const t=function(i){const s=i;return{funcName:wt("funcName",s.funcName,1,{value:[],binLen:0}),customization:wt("Customization",s.customization,1,{value:[],binLen:0})}}(r||{});e&&(t.funcName=e);const n=fn(oi(t.funcName),oi(t.customization));if(t.customization.binLen!==0||t.funcName.binLen!==0){const i=eo(n,this.m>>>3);for(let s=0;s<i.length;s+=this.m>>>5)this.U=this.v(i.slice(s,s+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(r){const e=function(n){const i=n;return{kmacKey:wt("kmacKey",i.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:wt("Customization",i.customization,1,{value:[],binLen:0})}}(r||{});this.O(r,e.funcName);const t=eo(oi(e.kmacKey),this.m>>>3);for(let n=0;n<t.length;n+=this.m>>>5)this.U=this.v(t.slice(n,n+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(r){const e=fn({value:this.h.slice(),binLen:this.u},function(t){let n,i,s=0;const o=[0,0],a=[4294967295&t,t/_r&2097151];for(n=6;n>=0;n--)i=a[n>>2]>>>8*n&255,i===0&&s===0||(o[s>>2]|=i<<8*s,s+=1);return s=s!==0?s:1,o[s>>2]|=s<<8*s,{value:s+1>4?o:[o[0]],binLen:8+8*s}}(r.outputLen));return this.F(e.value,e.binLen,this.A,this.L(this.U),r.outputLen)}};class je{constructor(e,t,n){if(e=="SHA-1")this.P=new Mc(e,t,n);else if(e=="SHA-224"||e=="SHA-256")this.P=new Dc(e,t,n);else if(e=="SHA-384"||e=="SHA-512")this.P=new Vc(e,t,n);else{if(e!="SHA3-224"&&e!="SHA3-256"&&e!="SHA3-384"&&e!="SHA3-512"&&e!="SHAKE128"&&e!="SHAKE256"&&e!="CSHAKE128"&&e!="CSHAKE256"&&e!="KMAC128"&&e!="KMAC256")throw new Error(Sr);this.P=new zc(e,t,n)}}update(e){return this.P.update(e),this}getHash(e,t){return this.P.getHash(e,t)}setHMACKey(e,t,n){this.P.setHMACKey(e,t,n)}getHMAC(e,t){return this.P.getHMAC(e,t)}}var to={},dn={};dn.byteLength=Jc,dn.toByteArray=Xc,dn.fromByteArray=tl;for(var rt=[],Ve=[],Kc=typeof Uint8Array<"u"?Uint8Array:Array,ai="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Yt=0,Gc=ai.length;Yt<Gc;++Yt)rt[Yt]=ai[Yt],Ve[ai.charCodeAt(Yt)]=Yt;Ve[45]=62,Ve[95]=63;function ro(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function Jc(r){var e=ro(r),t=e[0],n=e[1];return(t+n)*3/4-n}function Yc(r,e,t){return(e+t)*3/4-t}function Xc(r){var e,t=ro(r),n=t[0],i=t[1],s=new Kc(Yc(r,n,i)),o=0,a=i>0?n-4:n,c;for(c=0;c<a;c+=4)e=Ve[r.charCodeAt(c)]<<18|Ve[r.charCodeAt(c+1)]<<12|Ve[r.charCodeAt(c+2)]<<6|Ve[r.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Ve[r.charCodeAt(c)]<<2|Ve[r.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=Ve[r.charCodeAt(c)]<<10|Ve[r.charCodeAt(c+1)]<<4|Ve[r.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function Zc(r){return rt[r>>18&63]+rt[r>>12&63]+rt[r>>6&63]+rt[r&63]}function el(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),i.push(Zc(n));return i.join("")}function tl(r){for(var e,t=r.length,n=t%3,i=[],s=16383,o=0,a=t-n;o<a;o+=s)i.push(el(r,o,o+s>a?a:o+s));return n===1?(e=r[t-1],i.push(rt[e>>2]+rt[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(rt[e>>10]+rt[e>>4&63]+rt[e<<2&63]+"=")),i.join("")}var ui={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ui.read=function(r,e,t,n,i){var s,o,a=i*8-n-1,c=(1<<a)-1,l=c>>1,u=-7,d=t?i-1:0,p=t?-1:1,y=r[e+d];for(d+=p,s=y&(1<<-u)-1,y>>=-u,u+=a;u>0;s=s*256+r[e+d],d+=p,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=o*256+r[e+d],d+=p,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:(y?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-l}return(y?-1:1)*o*Math.pow(2,s-n)},ui.write=function(r,e,t,n,i,s){var o,a,c,l=s*8-i-1,u=(1<<l)-1,d=u>>1,p=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:s-1,v=n?1:-1,E=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=p/c:e+=p*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*c-1)*Math.pow(2,i),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;r[t+y]=a&255,y+=v,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;r[t+y]=o&255,y+=v,o/=256,l-=8);r[t+y-v]|=E*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const e=dn,t=ui,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=u,r.SlowBuffer=O,r.INSPECT_MAX_BYTES=50;const i=2147483647;r.kMaxLength=i;const{Uint8Array:s,ArrayBuffer:o,SharedArrayBuffer:a}=globalThis;u.TYPED_ARRAY_SUPPORT=c(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{const m=new s(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,s.prototype),Object.setPrototypeOf(m,f),m.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(m){if(m>i)throw new RangeError('The value "'+m+'" is invalid for option "size"');const f=new s(m);return Object.setPrototypeOf(f,u.prototype),f}function u(m,f,h){if(typeof m=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(m)}return d(m,f,h)}u.poolSize=8192;function d(m,f,h){if(typeof m=="string")return E(m,f);if(o.isView(m))return b(m);if(m==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof m);if(ct(m,o)||m&&ct(m.buffer,o)||typeof a<"u"&&(ct(m,a)||m&&ct(m.buffer,a)))return k(m,f,h);if(typeof m=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const g=m.valueOf&&m.valueOf();if(g!=null&&g!==m)return u.from(g,f,h);const _=S(m);if(_)return _;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof m[Symbol.toPrimitive]=="function")return u.from(m[Symbol.toPrimitive]("string"),f,h);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof m)}u.from=function(m,f,h){return d(m,f,h)},Object.setPrototypeOf(u.prototype,s.prototype),Object.setPrototypeOf(u,s);function p(m){if(typeof m!="number")throw new TypeError('"size" argument must be of type number');if(m<0)throw new RangeError('The value "'+m+'" is invalid for option "size"')}function y(m,f,h){return p(m),m<=0?l(m):f!==void 0?typeof h=="string"?l(m).fill(f,h):l(m).fill(f):l(m)}u.alloc=function(m,f,h){return y(m,f,h)};function v(m){return p(m),l(m<0?0:I(m)|0)}u.allocUnsafe=function(m){return v(m)},u.allocUnsafeSlow=function(m){return v(m)};function E(m,f){if((typeof f!="string"||f==="")&&(f="utf8"),!u.isEncoding(f))throw new TypeError("Unknown encoding: "+f);const h=C(m,f)|0;let g=l(h);const _=g.write(m,f);return _!==h&&(g=g.slice(0,_)),g}function w(m){const f=m.length<0?0:I(m.length)|0,h=l(f);for(let g=0;g<f;g+=1)h[g]=m[g]&255;return h}function b(m){if(ct(m,s)){const f=new s(m);return k(f.buffer,f.byteOffset,f.byteLength)}return w(m)}function k(m,f,h){if(f<0||m.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(m.byteLength<f+(h||0))throw new RangeError('"length" is outside of buffer bounds');let g;return f===void 0&&h===void 0?g=new s(m):h===void 0?g=new s(m,f):g=new s(m,f,h),Object.setPrototypeOf(g,u.prototype),g}function S(m){if(u.isBuffer(m)){const f=I(m.length)|0,h=l(f);return h.length===0||m.copy(h,0,0,f),h}if(m.length!==void 0)return typeof m.length!="number"||Ds(m.length)?l(0):w(m);if(m.type==="Buffer"&&Array.isArray(m.data))return w(m.data)}function I(m){if(m>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return m|0}function O(m){return+m!=m&&(m=0),u.alloc(+m)}u.isBuffer=function(f){return f!=null&&f._isBuffer===!0&&f!==u.prototype},u.compare=function(f,h){if(ct(f,s)&&(f=u.from(f,f.offset,f.byteLength)),ct(h,s)&&(h=u.from(h,h.offset,h.byteLength)),!u.isBuffer(f)||!u.isBuffer(h))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===h)return 0;let g=f.length,_=h.length;for(let A=0,R=Math.min(g,_);A<R;++A)if(f[A]!==h[A]){g=f[A],_=h[A];break}return g<_?-1:_<g?1:0},u.isEncoding=function(f){switch(String(f).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(f,h){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(f.length===0)return u.alloc(0);let g;if(h===void 0)for(h=0,g=0;g<f.length;++g)h+=f[g].length;const _=u.allocUnsafe(h);let A=0;for(g=0;g<f.length;++g){let R=f[g];if(ct(R,s))A+R.length>_.length?(u.isBuffer(R)||(R=u.from(R)),R.copy(_,A)):s.prototype.set.call(_,R,A);else if(u.isBuffer(R))R.copy(_,A);else throw new TypeError('"list" argument must be an Array of Buffers');A+=R.length}return _};function C(m,f){if(u.isBuffer(m))return m.length;if(o.isView(m)||ct(m,o))return m.byteLength;if(typeof m!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof m);const h=m.length,g=arguments.length>2&&arguments[2]===!0;if(!g&&h===0)return 0;let _=!1;for(;;)switch(f){case"ascii":case"latin1":case"binary":return h;case"utf8":case"utf-8":return Ms(m).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h*2;case"hex":return h>>>1;case"base64":return xc(m).length;default:if(_)return g?-1:Ms(m).length;f=(""+f).toLowerCase(),_=!0}}u.byteLength=C;function M(m,f,h){let g=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((h===void 0||h>this.length)&&(h=this.length),h<=0)||(h>>>=0,f>>>=0,h<=f))return"";for(m||(m="utf8");;)switch(m){case"hex":return Ae(this,f,h);case"utf8":case"utf-8":return q(this,f,h);case"ascii":return Te(this,f,h);case"latin1":case"binary":return J(this,f,h);case"base64":return ee(this,f,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ze(this,f,h);default:if(g)throw new TypeError("Unknown encoding: "+m);m=(m+"").toLowerCase(),g=!0}}u.prototype._isBuffer=!0;function F(m,f,h){const g=m[f];m[f]=m[h],m[h]=g}u.prototype.swap16=function(){const f=this.length;if(f%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let h=0;h<f;h+=2)F(this,h,h+1);return this},u.prototype.swap32=function(){const f=this.length;if(f%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let h=0;h<f;h+=4)F(this,h,h+3),F(this,h+1,h+2);return this},u.prototype.swap64=function(){const f=this.length;if(f%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let h=0;h<f;h+=8)F(this,h,h+7),F(this,h+1,h+6),F(this,h+2,h+5),F(this,h+3,h+4);return this},u.prototype.toString=function(){const f=this.length;return f===0?"":arguments.length===0?q(this,0,f):M.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(f){if(!u.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f?!0:u.compare(this,f)===0},u.prototype.inspect=function(){let f="";const h=r.INSPECT_MAX_BYTES;return f=this.toString("hex",0,h).replace(/(.{2})/g,"$1 ").trim(),this.length>h&&(f+=" ... "),"<Buffer "+f+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(f,h,g,_,A){if(ct(f,s)&&(f=u.from(f,f.offset,f.byteLength)),!u.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof f);if(h===void 0&&(h=0),g===void 0&&(g=f?f.length:0),_===void 0&&(_=0),A===void 0&&(A=this.length),h<0||g>f.length||_<0||A>this.length)throw new RangeError("out of range index");if(_>=A&&h>=g)return 0;if(_>=A)return-1;if(h>=g)return 1;if(h>>>=0,g>>>=0,_>>>=0,A>>>=0,this===f)return 0;let R=A-_,z=g-h;const he=Math.min(R,z),ce=this.slice(_,A),pe=f.slice(h,g);for(let ne=0;ne<he;++ne)if(ce[ne]!==pe[ne]){R=ce[ne],z=pe[ne];break}return R<z?-1:z<R?1:0};function L(m,f,h,g,_){if(m.length===0)return-1;if(typeof h=="string"?(g=h,h=0):h>2147483647?h=2147483647:h<-2147483648&&(h=-2147483648),h=+h,Ds(h)&&(h=_?0:m.length-1),h<0&&(h=m.length+h),h>=m.length){if(_)return-1;h=m.length-1}else if(h<0)if(_)h=0;else return-1;if(typeof f=="string"&&(f=u.from(f,g)),u.isBuffer(f))return f.length===0?-1:V(m,f,h,g,_);if(typeof f=="number")return f=f&255,typeof s.prototype.indexOf=="function"?_?s.prototype.indexOf.call(m,f,h):s.prototype.lastIndexOf.call(m,f,h):V(m,[f],h,g,_);throw new TypeError("val must be string, number or Buffer")}function V(m,f,h,g,_){let A=1,R=m.length,z=f.length;if(g!==void 0&&(g=String(g).toLowerCase(),g==="ucs2"||g==="ucs-2"||g==="utf16le"||g==="utf-16le")){if(m.length<2||f.length<2)return-1;A=2,R/=2,z/=2,h/=2}function he(pe,ne){return A===1?pe[ne]:pe.readUInt16BE(ne*A)}let ce;if(_){let pe=-1;for(ce=h;ce<R;ce++)if(he(m,ce)===he(f,pe===-1?0:ce-pe)){if(pe===-1&&(pe=ce),ce-pe+1===z)return pe*A}else pe!==-1&&(ce-=ce-pe),pe=-1}else for(h+z>R&&(h=R-z),ce=h;ce>=0;ce--){let pe=!0;for(let ne=0;ne<z;ne++)if(he(m,ce+ne)!==he(f,ne)){pe=!1;break}if(pe)return ce}return-1}u.prototype.includes=function(f,h,g){return this.indexOf(f,h,g)!==-1},u.prototype.indexOf=function(f,h,g){return L(this,f,h,g,!0)},u.prototype.lastIndexOf=function(f,h,g){return L(this,f,h,g,!1)};function G(m,f,h,g){h=Number(h)||0;const _=m.length-h;g?(g=Number(g),g>_&&(g=_)):g=_;const A=f.length;g>A/2&&(g=A/2);let R;for(R=0;R<g;++R){const z=parseInt(f.substr(R*2,2),16);if(Ds(z))return R;m[h+R]=z}return R}function Se(m,f,h,g){return ii(Ms(f,m.length-h),m,h,g)}function se(m,f,h,g){return ii(fm(f),m,h,g)}function ke(m,f,h,g){return ii(xc(f),m,h,g)}function j(m,f,h,g){return ii(hm(f,m.length-h),m,h,g)}u.prototype.write=function(f,h,g,_){if(h===void 0)_="utf8",g=this.length,h=0;else if(g===void 0&&typeof h=="string")_=h,g=this.length,h=0;else if(isFinite(h))h=h>>>0,isFinite(g)?(g=g>>>0,_===void 0&&(_="utf8")):(_=g,g=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const A=this.length-h;if((g===void 0||g>A)&&(g=A),f.length>0&&(g<0||h<0)||h>this.length)throw new RangeError("Attempt to write outside buffer bounds");_||(_="utf8");let R=!1;for(;;)switch(_){case"hex":return G(this,f,h,g);case"utf8":case"utf-8":return Se(this,f,h,g);case"ascii":case"latin1":case"binary":return se(this,f,h,g);case"base64":return ke(this,f,h,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,f,h,g);default:if(R)throw new TypeError("Unknown encoding: "+_);_=(""+_).toLowerCase(),R=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ee(m,f,h){return f===0&&h===m.length?e.fromByteArray(m):e.fromByteArray(m.slice(f,h))}function q(m,f,h){h=Math.min(m.length,h);const g=[];let _=f;for(;_<h;){const A=m[_];let R=null,z=A>239?4:A>223?3:A>191?2:1;if(_+z<=h){let he,ce,pe,ne;switch(z){case 1:A<128&&(R=A);break;case 2:he=m[_+1],(he&192)===128&&(ne=(A&31)<<6|he&63,ne>127&&(R=ne));break;case 3:he=m[_+1],ce=m[_+2],(he&192)===128&&(ce&192)===128&&(ne=(A&15)<<12|(he&63)<<6|ce&63,ne>2047&&(ne<55296||ne>57343)&&(R=ne));break;case 4:he=m[_+1],ce=m[_+2],pe=m[_+3],(he&192)===128&&(ce&192)===128&&(pe&192)===128&&(ne=(A&15)<<18|(he&63)<<12|(ce&63)<<6|pe&63,ne>65535&&ne<1114112&&(R=ne))}}R===null?(R=65533,z=1):R>65535&&(R-=65536,g.push(R>>>10&1023|55296),R=56320|R&1023),g.push(R),_+=z}return H(g)}const W=4096;function H(m){const f=m.length;if(f<=W)return String.fromCharCode.apply(String,m);let h="",g=0;for(;g<f;)h+=String.fromCharCode.apply(String,m.slice(g,g+=W));return h}function Te(m,f,h){let g="";h=Math.min(m.length,h);for(let _=f;_<h;++_)g+=String.fromCharCode(m[_]&127);return g}function J(m,f,h){let g="";h=Math.min(m.length,h);for(let _=f;_<h;++_)g+=String.fromCharCode(m[_]);return g}function Ae(m,f,h){const g=m.length;(!f||f<0)&&(f=0),(!h||h<0||h>g)&&(h=g);let _="";for(let A=f;A<h;++A)_+=pm[m[A]];return _}function Ze(m,f,h){const g=m.slice(f,h);let _="";for(let A=0;A<g.length-1;A+=2)_+=String.fromCharCode(g[A]+g[A+1]*256);return _}u.prototype.slice=function(f,h){const g=this.length;f=~~f,h=h===void 0?g:~~h,f<0?(f+=g,f<0&&(f=0)):f>g&&(f=g),h<0?(h+=g,h<0&&(h=0)):h>g&&(h=g),h<f&&(h=f);const _=this.subarray(f,h);return Object.setPrototypeOf(_,u.prototype),_};function oe(m,f,h){if(m%1!==0||m<0)throw new RangeError("offset is not uint");if(m+f>h)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(f,h,g){f=f>>>0,h=h>>>0,g||oe(f,h,this.length);let _=this[f],A=1,R=0;for(;++R<h&&(A*=256);)_+=this[f+R]*A;return _},u.prototype.readUintBE=u.prototype.readUIntBE=function(f,h,g){f=f>>>0,h=h>>>0,g||oe(f,h,this.length);let _=this[f+--h],A=1;for(;h>0&&(A*=256);)_+=this[f+--h]*A;return _},u.prototype.readUint8=u.prototype.readUInt8=function(f,h){return f=f>>>0,h||oe(f,1,this.length),this[f]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(f,h){return f=f>>>0,h||oe(f,2,this.length),this[f]|this[f+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(f,h){return f=f>>>0,h||oe(f,2,this.length),this[f]<<8|this[f+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(f,h){return f=f>>>0,h||oe(f,4,this.length),(this[f]|this[f+1]<<8|this[f+2]<<16)+this[f+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(f,h){return f=f>>>0,h||oe(f,4,this.length),this[f]*16777216+(this[f+1]<<16|this[f+2]<<8|this[f+3])},u.prototype.readBigUInt64LE=Dt(function(f){f=f>>>0,Er(f,"offset");const h=this[f],g=this[f+7];(h===void 0||g===void 0)&&ln(f,this.length-8);const _=h+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24,A=this[++f]+this[++f]*2**8+this[++f]*2**16+g*2**24;return BigInt(_)+(BigInt(A)<<BigInt(32))}),u.prototype.readBigUInt64BE=Dt(function(f){f=f>>>0,Er(f,"offset");const h=this[f],g=this[f+7];(h===void 0||g===void 0)&&ln(f,this.length-8);const _=h*2**24+this[++f]*2**16+this[++f]*2**8+this[++f],A=this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+g;return(BigInt(_)<<BigInt(32))+BigInt(A)}),u.prototype.readIntLE=function(f,h,g){f=f>>>0,h=h>>>0,g||oe(f,h,this.length);let _=this[f],A=1,R=0;for(;++R<h&&(A*=256);)_+=this[f+R]*A;return A*=128,_>=A&&(_-=Math.pow(2,8*h)),_},u.prototype.readIntBE=function(f,h,g){f=f>>>0,h=h>>>0,g||oe(f,h,this.length);let _=h,A=1,R=this[f+--_];for(;_>0&&(A*=256);)R+=this[f+--_]*A;return A*=128,R>=A&&(R-=Math.pow(2,8*h)),R},u.prototype.readInt8=function(f,h){return f=f>>>0,h||oe(f,1,this.length),this[f]&128?(255-this[f]+1)*-1:this[f]},u.prototype.readInt16LE=function(f,h){f=f>>>0,h||oe(f,2,this.length);const g=this[f]|this[f+1]<<8;return g&32768?g|4294901760:g},u.prototype.readInt16BE=function(f,h){f=f>>>0,h||oe(f,2,this.length);const g=this[f+1]|this[f]<<8;return g&32768?g|4294901760:g},u.prototype.readInt32LE=function(f,h){return f=f>>>0,h||oe(f,4,this.length),this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24},u.prototype.readInt32BE=function(f,h){return f=f>>>0,h||oe(f,4,this.length),this[f]<<24|this[f+1]<<16|this[f+2]<<8|this[f+3]},u.prototype.readBigInt64LE=Dt(function(f){f=f>>>0,Er(f,"offset");const h=this[f],g=this[f+7];(h===void 0||g===void 0)&&ln(f,this.length-8);const _=this[f+4]+this[f+5]*2**8+this[f+6]*2**16+(g<<24);return(BigInt(_)<<BigInt(32))+BigInt(h+this[++f]*256+this[++f]*65536+this[++f]*16777216)}),u.prototype.readBigInt64BE=Dt(function(f){f=f>>>0,Er(f,"offset");const h=this[f],g=this[f+7];(h===void 0||g===void 0)&&ln(f,this.length-8);const _=(h<<24)+this[++f]*2**16+this[++f]*2**8+this[++f];return(BigInt(_)<<BigInt(32))+BigInt(this[++f]*16777216+this[++f]*65536+this[++f]*256+g)}),u.prototype.readFloatLE=function(f,h){return f=f>>>0,h||oe(f,4,this.length),t.read(this,f,!0,23,4)},u.prototype.readFloatBE=function(f,h){return f=f>>>0,h||oe(f,4,this.length),t.read(this,f,!1,23,4)},u.prototype.readDoubleLE=function(f,h){return f=f>>>0,h||oe(f,8,this.length),t.read(this,f,!0,52,8)},u.prototype.readDoubleBE=function(f,h){return f=f>>>0,h||oe(f,8,this.length),t.read(this,f,!1,52,8)};function ye(m,f,h,g,_,A){if(!u.isBuffer(m))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>_||f<A)throw new RangeError('"value" argument is out of bounds');if(h+g>m.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(f,h,g,_){if(f=+f,h=h>>>0,g=g>>>0,!_){const z=Math.pow(2,8*g)-1;ye(this,f,h,g,z,0)}let A=1,R=0;for(this[h]=f&255;++R<g&&(A*=256);)this[h+R]=f/A&255;return h+g},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(f,h,g,_){if(f=+f,h=h>>>0,g=g>>>0,!_){const z=Math.pow(2,8*g)-1;ye(this,f,h,g,z,0)}let A=g-1,R=1;for(this[h+A]=f&255;--A>=0&&(R*=256);)this[h+A]=f/R&255;return h+g},u.prototype.writeUint8=u.prototype.writeUInt8=function(f,h,g){return f=+f,h=h>>>0,g||ye(this,f,h,1,255,0),this[h]=f&255,h+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(f,h,g){return f=+f,h=h>>>0,g||ye(this,f,h,2,65535,0),this[h]=f&255,this[h+1]=f>>>8,h+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(f,h,g){return f=+f,h=h>>>0,g||ye(this,f,h,2,65535,0),this[h]=f>>>8,this[h+1]=f&255,h+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(f,h,g){return f=+f,h=h>>>0,g||ye(this,f,h,4,4294967295,0),this[h+3]=f>>>24,this[h+2]=f>>>16,this[h+1]=f>>>8,this[h]=f&255,h+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(f,h,g){return f=+f,h=h>>>0,g||ye(this,f,h,4,4294967295,0),this[h]=f>>>24,this[h+1]=f>>>16,this[h+2]=f>>>8,this[h+3]=f&255,h+4};function we(m,f,h,g,_){Tc(f,g,_,m,h,7);let A=Number(f&BigInt(4294967295));m[h++]=A,A=A>>8,m[h++]=A,A=A>>8,m[h++]=A,A=A>>8,m[h++]=A;let R=Number(f>>BigInt(32)&BigInt(4294967295));return m[h++]=R,R=R>>8,m[h++]=R,R=R>>8,m[h++]=R,R=R>>8,m[h++]=R,h}function ge(m,f,h,g,_){Tc(f,g,_,m,h,7);let A=Number(f&BigInt(4294967295));m[h+7]=A,A=A>>8,m[h+6]=A,A=A>>8,m[h+5]=A,A=A>>8,m[h+4]=A;let R=Number(f>>BigInt(32)&BigInt(4294967295));return m[h+3]=R,R=R>>8,m[h+2]=R,R=R>>8,m[h+1]=R,R=R>>8,m[h]=R,h+8}u.prototype.writeBigUInt64LE=Dt(function(f,h=0){return we(this,f,h,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Dt(function(f,h=0){return ge(this,f,h,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(f,h,g,_){if(f=+f,h=h>>>0,!_){const he=Math.pow(2,8*g-1);ye(this,f,h,g,he-1,-he)}let A=0,R=1,z=0;for(this[h]=f&255;++A<g&&(R*=256);)f<0&&z===0&&this[h+A-1]!==0&&(z=1),this[h+A]=(f/R>>0)-z&255;return h+g},u.prototype.writeIntBE=function(f,h,g,_){if(f=+f,h=h>>>0,!_){const he=Math.pow(2,8*g-1);ye(this,f,h,g,he-1,-he)}let A=g-1,R=1,z=0;for(this[h+A]=f&255;--A>=0&&(R*=256);)f<0&&z===0&&this[h+A+1]!==0&&(z=1),this[h+A]=(f/R>>0)-z&255;return h+g},u.prototype.writeInt8=function(f,h,g){return f=+f,h=h>>>0,g||ye(this,f,h,1,127,-128),f<0&&(f=255+f+1),this[h]=f&255,h+1},u.prototype.writeInt16LE=function(f,h,g){return f=+f,h=h>>>0,g||ye(this,f,h,2,32767,-32768),this[h]=f&255,this[h+1]=f>>>8,h+2},u.prototype.writeInt16BE=function(f,h,g){return f=+f,h=h>>>0,g||ye(this,f,h,2,32767,-32768),this[h]=f>>>8,this[h+1]=f&255,h+2},u.prototype.writeInt32LE=function(f,h,g){return f=+f,h=h>>>0,g||ye(this,f,h,4,2147483647,-2147483648),this[h]=f&255,this[h+1]=f>>>8,this[h+2]=f>>>16,this[h+3]=f>>>24,h+4},u.prototype.writeInt32BE=function(f,h,g){return f=+f,h=h>>>0,g||ye(this,f,h,4,2147483647,-2147483648),f<0&&(f=4294967295+f+1),this[h]=f>>>24,this[h+1]=f>>>16,this[h+2]=f>>>8,this[h+3]=f&255,h+4},u.prototype.writeBigInt64LE=Dt(function(f,h=0){return we(this,f,h,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Dt(function(f,h=0){return ge(this,f,h,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Rs(m,f,h,g,_,A){if(h+g>m.length)throw new RangeError("Index out of range");if(h<0)throw new RangeError("Index out of range")}function ni(m,f,h,g,_){return f=+f,h=h>>>0,_||Rs(m,f,h,4),t.write(m,f,h,g,23,4),h+4}u.prototype.writeFloatLE=function(f,h,g){return ni(this,f,h,!0,g)},u.prototype.writeFloatBE=function(f,h,g){return ni(this,f,h,!1,g)};function Sc(m,f,h,g,_){return f=+f,h=h>>>0,_||Rs(m,f,h,8),t.write(m,f,h,g,52,8),h+8}u.prototype.writeDoubleLE=function(f,h,g){return Sc(this,f,h,!0,g)},u.prototype.writeDoubleBE=function(f,h,g){return Sc(this,f,h,!1,g)},u.prototype.copy=function(f,h,g,_){if(!u.isBuffer(f))throw new TypeError("argument should be a Buffer");if(g||(g=0),!_&&_!==0&&(_=this.length),h>=f.length&&(h=f.length),h||(h=0),_>0&&_<g&&(_=g),_===g||f.length===0||this.length===0)return 0;if(h<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("Index out of range");if(_<0)throw new RangeError("sourceEnd out of bounds");_>this.length&&(_=this.length),f.length-h<_-g&&(_=f.length-h+g);const A=_-g;return this===f&&typeof s.prototype.copyWithin=="function"?this.copyWithin(h,g,_):s.prototype.set.call(f,this.subarray(g,_),h),A},u.prototype.fill=function(f,h,g,_){if(typeof f=="string"){if(typeof h=="string"?(_=h,h=0,g=this.length):typeof g=="string"&&(_=g,g=this.length),_!==void 0&&typeof _!="string")throw new TypeError("encoding must be a string");if(typeof _=="string"&&!u.isEncoding(_))throw new TypeError("Unknown encoding: "+_);if(f.length===1){const R=f.charCodeAt(0);(_==="utf8"&&R<128||_==="latin1")&&(f=R)}}else typeof f=="number"?f=f&255:typeof f=="boolean"&&(f=Number(f));if(h<0||this.length<h||this.length<g)throw new RangeError("Out of range index");if(g<=h)return this;h=h>>>0,g=g===void 0?this.length:g>>>0,f||(f=0);let A;if(typeof f=="number")for(A=h;A<g;++A)this[A]=f;else{const R=u.isBuffer(f)?f:u.from(f,_),z=R.length;if(z===0)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(A=0;A<g-h;++A)this[A+h]=R[A%z]}return this};const wr={};function Ns(m,f,h){wr[m]=class extends h{constructor(){super(),Object.defineProperty(this,"message",{value:f.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${m}]`,this.stack,delete this.name}get code(){return m}set code(_){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:_,writable:!0})}toString(){return`${this.name} [${m}]: ${this.message}`}}}Ns("ERR_BUFFER_OUT_OF_BOUNDS",function(m){return m?`${m} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ns("ERR_INVALID_ARG_TYPE",function(m,f){return`The "${m}" argument must be of type number. Received type ${typeof f}`},TypeError),Ns("ERR_OUT_OF_RANGE",function(m,f,h){let g=`The value of "${m}" is out of range.`,_=h;return Number.isInteger(h)&&Math.abs(h)>4294967296?_=kc(String(h)):typeof h=="bigint"&&(_=String(h),(h>BigInt(2)**BigInt(32)||h<-(BigInt(2)**BigInt(32)))&&(_=kc(_)),_+="n"),g+=` It must be ${f}. Received ${_}`,g},RangeError);function kc(m){let f="",h=m.length;const g=m[0]==="-"?1:0;for(;h>=g+4;h-=3)f=`_${m.slice(h-3,h)}${f}`;return`${m.slice(0,h)}${f}`}function um(m,f,h){Er(f,"offset"),(m[f]===void 0||m[f+h]===void 0)&&ln(f,m.length-(h+1))}function Tc(m,f,h,g,_,A){if(m>h||m<f){const R=typeof f=="bigint"?"n":"";let z;throw f===0||f===BigInt(0)?z=`>= 0${R} and < 2${R} ** ${(A+1)*8}${R}`:z=`>= -(2${R} ** ${(A+1)*8-1}${R}) and < 2 ** ${(A+1)*8-1}${R}`,new wr.ERR_OUT_OF_RANGE("value",z,m)}um(g,_,A)}function Er(m,f){if(typeof m!="number")throw new wr.ERR_INVALID_ARG_TYPE(f,"number",m)}function ln(m,f,h){throw Math.floor(m)!==m?(Er(m,h),new wr.ERR_OUT_OF_RANGE("offset","an integer",m)):f<0?new wr.ERR_BUFFER_OUT_OF_BOUNDS:new wr.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${f}`,m)}const cm=/[^+/0-9A-Za-z-_]/g;function lm(m){if(m=m.split("=")[0],m=m.trim().replace(cm,""),m.length<2)return"";for(;m.length%4!==0;)m=m+"=";return m}function Ms(m,f){f=f||1/0;let h;const g=m.length;let _=null;const A=[];for(let R=0;R<g;++R){if(h=m.charCodeAt(R),h>55295&&h<57344){if(!_){if(h>56319){(f-=3)>-1&&A.push(239,191,189);continue}else if(R+1===g){(f-=3)>-1&&A.push(239,191,189);continue}_=h;continue}if(h<56320){(f-=3)>-1&&A.push(239,191,189),_=h;continue}h=(_-55296<<10|h-56320)+65536}else _&&(f-=3)>-1&&A.push(239,191,189);if(_=null,h<128){if((f-=1)<0)break;A.push(h)}else if(h<2048){if((f-=2)<0)break;A.push(h>>6|192,h&63|128)}else if(h<65536){if((f-=3)<0)break;A.push(h>>12|224,h>>6&63|128,h&63|128)}else if(h<1114112){if((f-=4)<0)break;A.push(h>>18|240,h>>12&63|128,h>>6&63|128,h&63|128)}else throw new Error("Invalid code point")}return A}function fm(m){const f=[];for(let h=0;h<m.length;++h)f.push(m.charCodeAt(h)&255);return f}function hm(m,f){let h,g,_;const A=[];for(let R=0;R<m.length&&!((f-=2)<0);++R)h=m.charCodeAt(R),g=h>>8,_=h%256,A.push(_),A.push(g);return A}function xc(m){return e.toByteArray(lm(m))}function ii(m,f,h,g){let _;for(_=0;_<g&&!(_+h>=f.length||_>=m.length);++_)f[_+h]=m[_];return _}function ct(m,f){return m instanceof f||m!=null&&m.constructor!=null&&m.constructor.name!=null&&m.constructor.name===f.name}function Ds(m){return m!==m}const pm=function(){const m="0123456789abcdef",f=new Array(256);for(let h=0;h<16;++h){const g=h*16;for(let _=0;_<16;++_)f[g+_]=m[h]+m[_]}return f}();function Dt(m){return typeof BigInt>"u"?dm:m}function dm(){throw new Error("BigInt not supported")}})(to);const no=to.Buffer,nt=globalThis||void 0||self;typeof self>"u"&&(nt.self=nt);class io{static toHex(e,t){const n=(c,l)=>{const u=l?["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"]:["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return u[Math.floor(c/16)]+u[c%16]},i=Object.assign({grouping:0,rowlength:0,uppercase:!1},t||{});let s="",o=0,a=0;for(let c=0;c<e.length&&(s+=n(e[c],i.uppercase),c!==e.length-1);++c)i.grouping>0&&++o===i.grouping&&(o=0,i.rowlength>0&&++a===i.rowlength?(a=0,s+=`
`):s+=" ");return s}static toUint8Array(e){let t=e.toLowerCase().replace(/\s/g,"");t.length%2===1&&(t=`0${t}`);const n=new Uint8Array(Math.floor(t.length/2));let i=-1;for(let s=0;s<t.length;++s){const o=t[s],a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"].indexOf(o);if(a===-1)throw Error("unexpected character");i===-1?i=16*a:(n[Math.floor(s/2)]=i+a,i=-1)}return n}}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),String.prototype.toCamelCase||(String.prototype.toCamelCase=function(){return this.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(r,e)=>e.toUpperCase())}),String.prototype.toSnakeCase||(String.prototype.toSnakeCase=function(){return this.replace(/[A-Z]/g,r=>`_${r.toLowerCase()}`)});function xr(r,e){const t=Math.ceil(r.length/e),n=[];for(let i=0,s=0;i<t;++i,s+=e)n[i]=r.substr(s,e);return n}function yn(r=256,e="abcdef0123456789"){let t=new Uint8Array(r);return t=crypto.getRandomValues(t),t=t.map(n=>e.charCodeAt(n%e.length)),String.fromCharCode.apply(null,t)}function so(r,e,t,n,i){if(n=n||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~`!@#$%^&*()-_=+[{]}\\|;:'\",<.>/?¿¡",i=i||n,e>n.length||t>i.length)return console.warn("Strings::charsetBaseConvert() - Can't convert",r,"to base",t,"greater than symbol table length. src-table:",n.length,"dest-table:",i.length),!1;let o=BigInt(0);for(let c=0;c<r.length;c++)o=o*BigInt(e)+BigInt(n.indexOf(r.charAt(c)));let a="";for(;o>0;){const c=o%BigInt(t);a=i.charAt(Number(c))+a,o/=BigInt(t)}return a||"0"}function rl(r){return io.toHex(r,{})}function nl(r){return io.toUint8Array(r)}function oo(r){return no.from(r,"hex").toString("base64")}function ao(r){return no.from(r,"base64").toString("hex")}function uo(r){return/^[A-F0-9]+$/i.test(r)}function il(r){return(typeof r=="number"||typeof r=="string"&&r.trim()!=="")&&!isNaN(r)}let Ir=class{static normalizeMeta(e){const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&e[n]!==null&&t.push({key:n,value:e[n].toString()});return t}static aggregateMeta(e){let t={};if(Array.isArray(e))for(const n of e)t[n.key]=n.value;else t=e;return t}};function co(r,e){let t,n,i;const s=[Array,Date,Number,String,Boolean],o=Object.prototype.toString;for(e=e||[],t=0;t<e.length;t+=2)r===e[t]&&(n=e[t+1]);if(!n&&r&&typeof r=="object"){for(n={},t=0;t<s.length;t++)o.call(r)===o.call(i=new s[t](r))&&(n=t?i:[]);e.push(r,n);for(t in r)e.hasOwnProperty.call(r,t)&&(n[t]=co(r[t],e))}return n||r}function sl(...r){return[].concat(...r.map((e,t)=>{const n=r.slice(0);n.splice(t,1);const i=[...new Set([].concat(...n))];return e.filter(s=>!i.includes(s))}))}function Ar(...r){return r.reduce((e,t)=>e.filter(n=>t.includes(n)))}class ci{constructor(e={},t={}){this.policy=ci.normalizePolicy(e),this.fillDefault(t)}static normalizePolicy(e={}){const t={};for(const[n,i]of Object.entries(e))if(i!==null&&["read","write"].includes(n)){t[n]={};for(const[s,o]of Object.entries(i))t[n][s]=o}return t}fillDefault(e={}){const t=Array.from(this.policy).filter(i=>i.action==="read"),n=Array.from(this.policy).filter(i=>i.action==="write");for(const[i,s]of Object.entries({read:t,write:n})){const o=s.map(a=>a.key);this.policy[i]||(this.policy[i]={});for(const a of sl(e,o))this.policy[i][a]||(this.policy[i][a]=i==="write"&&!["characters","pubkey"].includes(a)?["self"]:["all"])}}get(){return this.policy}toJson(){return JSON.stringify(this.get())}}class Ue{constructor(e={}){this.meta=e}merge(e){return this.meta=Object.assign(this.meta,e),this}addContext(e=null){return this}setAtomWallet(e){const t={pubkey:e.pubkey,characters:e.characters};return e.tokenUnits&&e.tokenUnits.length&&(t.tokenUnits=JSON.stringify(e.getTokenUnitsData())),e.tradeRates&&e.tradeRates.length&&(t.tradeRates=JSON.stringify(e.tradeRates)),this.merge(t),this}setMetaWallet(e){return this.merge({walletTokenSlug:e.token,walletBundleHash:e.bundle,walletAddress:e.address,walletPosition:e.position,walletBatchId:e.batchId,walletPubkey:e.pubkey,walletCharacters:e.characters}),this}setShadowWalletClaim(e){return this.merge({shadowWalletClaim:e*1}),this}setSigningWallet(e){return this.merge({signingWallet:JSON.stringify({tokenSlug:e.token,bundleHash:e.bundle,address:e.address,position:e.position,pubkey:e.pubkey,characters:e.characters})}),this}addPolicy(e){const t=new ci(e,Object.keys(this.meta));return this.merge({policy:t.toJson()}),this}get(){return this.meta}}class re extends TypeError{constructor(e=null,t=null,n=null){if(super(e,t,n),e===null)throw new this(`Unknown ${this.constructor.name}`);this.name="BaseException"}toString(){return`${this.name}: ${this.message}.
Stack:
${this.stack}`}}class Ft extends re{constructor(e="The molecule does not contain atoms",t=null,n=null){super(e,t,n),this.name="AtomsMissingException"}}class Bt{static create(e){const t={};for(const n of Object.keys(e))Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return new this(t)}static structure(e){switch(Object.prototype.toString.call(e)){case"[object Array]":{const t=[];for(const n in e)t.push(Bt.isStructure(e[n])?Bt.structure(e[n]):e[n]);return t}case"[object Object]":{const t=[],n=Object.keys(e).sort((i,s)=>i===s?0:i<s?-1:1);for(const i of n)if(Object.prototype.hasOwnProperty.call(e,i)){const s={};s[i]=Bt.isStructure(e[i])?Bt.structure(e[i]):e[i],t.push(s)}if(t.length>0)return t;break}}return e}static isStructure(e){return["[object Object]","[object Array]"].includes(Object.prototype.toString.call(e))}view(){return Bt.structure(this)}}class ol extends Bt{constructor({position:e=null,walletAddress:t=null,isotope:n=null,token:i=null,value:s=null,batchId:o=null,metaType:a=null,metaId:c=null,meta:l=null,index:u=null,createdAt:d=null,version:p=null}){super(),this.position=e,this.walletAddress=t,this.isotope=n,this.token=i,this.value=s,this.batchId=o,this.metaType=a,this.metaId=c,this.meta=l,this.index=u,this.createdAt=d,this.version=p}}const mn={4:ol};class Q{constructor({position:e=null,walletAddress:t=null,isotope:n=null,token:i=null,value:s=null,batchId:o=null,metaType:a=null,metaId:c=null,meta:l=null,otsFragment:u=null,index:d=null,version:p=null}){this.position=e,this.walletAddress=t,this.isotope=n,this.token=i,this.value=s!==null?String(s):null,this.batchId=o,this.metaType=a,this.metaId=c,this.meta=l?Ir.normalizeMeta(l):[],this.index=d,this.otsFragment=u,this.createdAt=String(+new Date),p!==null&&Object.prototype.hasOwnProperty.call(mn,p)&&(this.version=String(p))}static getHashableProps(){return["position","walletAddress","isotope","token","value","batchId","metaType","metaId","meta","createdAt"]}static getUnclaimedProps(){return["otsFragment"]}static create({isotope:e,wallet:t=null,value:n=null,metaType:i=null,metaId:s=null,meta:o=null,batchId:a=null}){return o||(o=new Ue),o instanceof Ue||(o=new Ue(o)),t&&(o.setAtomWallet(t),a||(a=t.batchId)),new Q({position:t?t.position:null,walletAddress:t?t.address:null,isotope:e,token:t?t.token:null,value:n,batchId:a,metaType:i,metaId:s,meta:o.get()})}static jsonToObject(e){const t=Object.assign(new Q({}),JSON.parse(e)),n=Object.keys(new Q({}));for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&!n.includes(i)&&delete t[i];return t}static hashAtoms({atoms:e,output:t="base17"}){const n=new je("SHAKE256","TEXT"),i=Q.sortAtoms(e);if(i.length===0)throw new Ft;if(i.map(s=>{if(!(s instanceof Q))throw new Ft;return s}),i.every(s=>s.version&&Object.prototype.hasOwnProperty.call(mn,s.version)))n.update(JSON.stringify(i.map(s=>mn[s.version].create(s).view())));else{const s=String(e.length);let o=[];for(const a of i)o.push(s),o=o.concat(a.getHashableValues());for(const a of o)n.update(a)}switch(t){case"hex":return n.getHash("HEX",{outputLen:256});case"array":return n.getHash("ARRAYBUFFER",{outputLen:256});default:return so(n.getHash("HEX",{outputLen:256}),16,17,"0123456789abcdef","0123456789abcdefg").padStart(64,"0")}}static jsonSerialization(e,t){if(!Q.getUnclaimedProps().includes(e))return t}static sortAtoms(e){const t=[...e];return t.sort((n,i)=>n.index<i.index?-1:1),t}aggregatedMeta(){return Ir.aggregateMeta(this.meta)}getHashableValues(){const e=[];for(const t of Q.getHashableProps()){const n=this[t];if(!(n===null&&!["position","walletAddress"].includes(t)))if(t==="meta")for(const i of n)typeof i.value<"u"&&i.value!==null&&(e.push(String(i.key)),e.push(String(i.value)));else e.push(n===null?"":String(n))}return e}}function gn(r=null,e=2048){if(r){const t=new je("SHAKE256","TEXT");return t.update(r),t.getHash("HEX",{outputLen:e*2})}else return yn(e)}function Pt(r,e=null){const t=new je("SHAKE256","TEXT");return t.update(r),t.getHash("HEX",{outputLen:256})}function vn({molecularHash:r=null,index:e=null}){return r!==null&&e!==null?Pt(String(r)+String(e),"generateBatchId"):yn(64)}class Or{constructor(e,t,n){this.id=e,this.name=t,this.metas=n||{}}static createFromGraphQL(e){let t=e.metas||{};return t.length&&(t=JSON.parse(t),t||(t={})),new Or(e.id,e.name,t)}static createFromDB(e){return new Or(e[0],e[1],e.length>2?e[2]:{})}getFragmentZone(){return this.metas.fragmentZone||null}getFusedTokenUnits(){return this.metas.fusedTokenUnits||null}toData(){return[this.id,this.name,this.metas]}toGraphQLResponse(){return{id:this.id,name:this.name,metas:JSON.stringify(this.metas)}}}class al extends re{constructor(e="Attempting to create a wallet with no credentials (secret or bundle hash)",t=null,n=null){super(e,t,n),this.name="WalletCredentialException"}}function lo(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function ul(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function bn(r,...e){if(!ul(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function fo(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function cl(r,e){bn(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const wn=BigInt(2**32-1),ho=BigInt(32);function ll(r,e=!1){return e?{h:Number(r&wn),l:Number(r>>ho&wn)}:{h:Number(r>>ho&wn)|0,l:Number(r&wn)|0}}function fl(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let i=0;i<r.length;i++){const{h:s,l:o}=ll(r[i],e);[t[i],n[i]]=[s,o]}return[t,n]}const hl=(r,e,t)=>r<<t|e>>>32-t,pl=(r,e,t)=>e<<t|r>>>32-t,dl=(r,e,t)=>e<<t-32|r>>>64-t,yl=(r,e,t)=>r<<t-32|e>>>64-t,Xt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const po=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),yo=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,ml=r=>r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255;function mo(r){for(let e=0;e<r.length;e++)r[e]=ml(r[e])}function gl(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function li(r){return typeof r=="string"&&(r=gl(r)),bn(r),r}class vl{clone(){return this._cloneInto()}}function bl(r){const e=n=>r().update(li(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function wl(r){const e=(n,i)=>r(i).update(li(n)).digest(),t=r({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}function El(r=32){if(Xt&&typeof Xt.getRandomValues=="function")return Xt.getRandomValues(new Uint8Array(r));if(Xt&&typeof Xt.randomBytes=="function")return Xt.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}const go=[],vo=[],bo=[],_l=BigInt(0),Cr=BigInt(1),Sl=BigInt(2),kl=BigInt(7),Tl=BigInt(256),xl=BigInt(113);for(let r=0,e=Cr,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],go.push(2*(5*n+t)),vo.push((r+1)*(r+2)/2%64);let i=_l;for(let s=0;s<7;s++)e=(e<<Cr^(e>>kl)*xl)%Tl,e&Sl&&(i^=Cr<<(Cr<<BigInt(s))-Cr);bo.push(i)}const[Il,Al]=fl(bo,!0),wo=(r,e,t)=>t>32?dl(r,e,t):hl(r,e,t),Eo=(r,e,t)=>t>32?yl(r,e,t):pl(r,e,t);function Ol(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],d=wo(l,u,1)^t[a],p=Eo(l,u,1)^t[a+1];for(let y=0;y<50;y+=10)r[o+y]^=d,r[o+y+1]^=p}let i=r[2],s=r[3];for(let o=0;o<24;o++){const a=vo[o],c=wo(i,s,a),l=Eo(i,s,a),u=go[o];i=r[u],s=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=Il[n],r[1]^=Al[n]}t.fill(0)}class En extends vl{constructor(e,t,n,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,lo(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=po(this.state)}keccak(){yo||mo(this.state32),Ol(this.state32,this.rounds),yo||mo(this.state32),this.posOut=0,this.pos=0}update(e){fo(this);const{blockLen:t,state:n}=this;e=li(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(t-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:i}=this;e[n]^=t,t&128&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){fo(this,!1),bn(e),this.finish();const t=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return lo(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(cl(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new En(t,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const _o=(r,e,t)=>bl(()=>new En(e,r,t)),Cl=_o(6,136,256/8),Rl=_o(6,72,512/8),So=(r,e,t)=>wl((n={})=>new En(e,r,n.dkLen===void 0?t:n.dkLen,!0)),Nl=So(31,168,128/8),ko=So(31,136,256/8);/*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) */const Et=bn,To=El;function xo(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}function _n(...r){const e=n=>typeof n=="number"?n:n.bytesLen,t=r.reduce((n,i)=>n+e(i),0);return{bytesLen:t,encode:n=>{const i=new Uint8Array(t);for(let s=0,o=0;s<r.length;s++){const a=r[s],c=e(a),l=typeof a=="number"?n[s]:a.encode(n[s]);Et(l,c),i.set(l,o),typeof a!="number"&&l.fill(0),o+=c}return i},decode:n=>{Et(n,t);const i=[];for(const s of r){const o=e(s),a=n.subarray(0,o);i.push(typeof s=="number"?a:s.decode(a)),n=n.subarray(o)}return i}}}function fi(r,e){const t=e*r.bytesLen;return{bytesLen:t,encode:n=>{if(n.length!==e)throw new Error(`vecCoder.encode: wrong length=${n.length}. Expected: ${e}`);const i=new Uint8Array(t);for(let s=0,o=0;s<n.length;s++){const a=r.encode(n[s]);i.set(a,o),a.fill(0),o+=a.length}return i},decode:n=>{Et(n,t);const i=[];for(let s=0;s<n.length;s+=r.bytesLen)i.push(r.decode(n.subarray(s,s+r.bytesLen)));return i}}}function $t(...r){for(const e of r)if(Array.isArray(e))for(const t of e)t.fill(0);else e.fill(0)}function Io(r){return(1<<r)-1}/*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) */function Ml(r,e=8){const i=r.toString(2).padStart(8,"0").slice(-e).padStart(7,"0").split("").reverse().join("");return Number.parseInt(i,2)}const Dl=r=>{const{newPoly:e,N:t,Q:n,F:i,ROOT_OF_UNITY:s,brvBits:o,isKyber:a}=r,c=(w,b=n)=>{const k=w%b|0;return(k>=0?k|0:b+k|0)|0},l=(w,b=n)=>{const k=c(w,b)|0;return(k>b>>1?k-b|0:k)|0};function u(){const w=e(t);for(let b=0;b<t;b++){const k=Ml(b,o),S=BigInt(s)**BigInt(k)%BigInt(n);w[b]=Number(S)|0}return w}const d=u(),p=a?128:t,y=a?1:0;return{mod:c,smod:l,nttZetas:d,NTT:{encode:w=>{for(let b=1,k=128;k>y;k>>=1)for(let S=0;S<t;S+=2*k){const I=d[b++];for(let O=S;O<S+k;O++){const C=c(I*w[O+k]);w[O+k]=c(w[O]-C)|0,w[O]=c(w[O]+C)|0}}return w},decode:w=>{for(let b=p-1,k=1+y;k<p+y;k<<=1)for(let S=0;S<t;S+=2*k){const I=d[b--];for(let O=S;O<S+k;O++){const C=w[O];w[O]=c(C+w[O+k]),w[O+k]=c(I*(w[O+k]-C))}}for(let b=0;b<w.length;b++)w[b]=c(i*w[b]);return w}},bitsCoder:(w,b)=>{const k=Io(w),S=w*(t/8);return{bytesLen:S,encode:I=>{const O=new Uint8Array(S);for(let C=0,M=0,F=0,L=0;C<I.length;C++)for(M|=(b.encode(I[C])&k)<<F,F+=w;F>=8;F-=8,M>>=8)O[L++]=M&Io(F);return O},decode:I=>{const O=e(t);for(let C=0,M=0,F=0,L=0;C<I.length;C++)for(M|=I[C]<<F,F+=8;F>=w;F-=w,M>>=w)O[L++]=b.decode(M&k);return O}}}}},Fl=(r=>(e,t)=>{t||(t=r.blockLen);const n=new Uint8Array(e.length+2);n.set(e);const i=e.length,s=new Uint8Array(t);let o=r.create({}),a=0,c=0;return{stats:()=>({calls:a,xofs:c}),get:(l,u)=>(n[i+0]=l,n[i+1]=u,o.destroy(),o=r.create({}).update(n),a++,()=>(c++,o.xofInto(s))),clean:()=>{o.destroy(),s.fill(0),n.fill(0)}}})(Nl);/*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) */const Ce=256,ht=3329,Bl=3303,Pl=17,{mod:Rr,nttZetas:$l,NTT:Lt,bitsCoder:Ll}=Dl({N:Ce,Q:ht,F:Bl,ROOT_OF_UNITY:Pl,newPoly:r=>new Uint16Array(r),brvBits:7,isKyber:!0}),Ul={512:{N:Ce,Q:ht,K:2,ETA1:3,ETA2:2,du:10,dv:4,RBGstrength:128},768:{N:Ce,Q:ht,K:3,ETA1:2,ETA2:2,du:10,dv:4,RBGstrength:192},1024:{N:Ce,Q:ht,K:4,ETA1:2,ETA2:2,du:11,dv:5,RBGstrength:256}},ql=r=>{if(r>=12)return{encode:t=>t,decode:t=>t};const e=2**(r-1);return{encode:t=>((t<<r)+ht/2)/ht,decode:t=>t*ht+e>>>r}},Nr=r=>Ll(r,ql(r));function Ut(r,e){for(let t=0;t<Ce;t++)r[t]=Rr(r[t]+e[t])}function jl(r,e){for(let t=0;t<Ce;t++)r[t]=Rr(r[t]-e[t])}function Vl(r,e,t,n,i){const s=Rr(e*n*i+r*t),o=Rr(r*n+e*t);return{c0:s,c1:o}}function Sn(r,e){for(let t=0;t<Ce/2;t++){let n=$l[64+(t>>1)];t&1&&(n=-n);const{c0:i,c1:s}=Vl(r[2*t+0],r[2*t+1],e[2*t+0],e[2*t+1],n);r[2*t+0]=i,r[2*t+1]=s}return r}function Ao(r){const e=new Uint16Array(Ce);for(let t=0;t<Ce;){const n=r();if(n.length%3)throw new Error("SampleNTT: unaligned block");for(let i=0;t<Ce&&i+3<=n.length;i+=3){const s=(n[i+0]>>0|n[i+1]<<8)&4095,o=(n[i+1]>>4|n[i+2]<<4)&4095;s<ht&&(e[t++]=s),t<Ce&&o<ht&&(e[t++]=o)}}return e}function Mr(r,e,t,n){const i=r(n*Ce/4,e,t),s=new Uint16Array(Ce),o=po(i);let a=0;for(let c=0,l=0,u=0,d=0;c<o.length;c++){let p=o[c];for(let y=0;y<32;y++)u+=p&1,p>>=1,a+=1,a===n?(d=u,u=0):a===2*n&&(s[l++]=Rr(d-u),u=0,a=0)}if(a)throw new Error(`sampleCBD: leftover bits: ${a}`);return s}const Ql=r=>{const{K:e,PRF:t,XOF:n,HASH512:i,ETA1:s,ETA2:o,du:a,dv:c}=r,l=Nr(1),u=Nr(c),d=Nr(a),p=_n(fi(Nr(12),e),32),y=fi(Nr(12),e),v=_n(fi(d,e),u),E=_n(32,32);return{secretCoder:y,secretKeyLen:y.bytesLen,publicKeyLen:p.bytesLen,cipherTextLen:v.bytesLen,keygen:w=>{const b=new Uint8Array(33);b.set(w),b[32]=e;const k=i(b),[S,I]=E.decode(k),O=[],C=[];for(let L=0;L<e;L++)O.push(Lt.encode(Mr(t,I,L,s)));const M=n(S);for(let L=0;L<e;L++){const V=Lt.encode(Mr(t,I,e+L,s));for(let G=0;G<e;G++){const Se=Ao(M.get(G,L));Ut(V,Sn(Se,O[G]))}C.push(V)}M.clean();const F={publicKey:p.encode([C,S]),secretKey:y.encode(O)};return $t(S,I,O,C,b,k),F},encrypt:(w,b,k)=>{const[S,I]=p.decode(w),O=[];for(let G=0;G<e;G++)O.push(Lt.encode(Mr(t,k,G,s)));const C=n(I),M=new Uint16Array(Ce),F=[];for(let G=0;G<e;G++){const Se=Mr(t,k,e+G,o),se=new Uint16Array(Ce);for(let ke=0;ke<e;ke++){const j=Ao(C.get(G,ke));Ut(se,Sn(j,O[ke]))}Ut(Se,Lt.decode(se)),F.push(Se),Ut(M,Sn(S[G],O[G])),se.fill(0)}C.clean();const L=Mr(t,k,2*e,o);Ut(L,Lt.decode(M));const V=l.decode(b);return Ut(V,L),$t(S,O,M,L),v.encode([F,V])},decrypt:(w,b)=>{const[k,S]=v.decode(w),I=y.decode(b),O=new Uint16Array(Ce);for(let C=0;C<e;C++)Ut(O,Sn(I[C],Lt.encode(k[C])));return jl(S,Lt.decode(O)),$t(O,I,k),l.encode(S)}}};function Hl(r){const e=Ql(r),{HASH256:t,HASH512:n,KDF:i}=r,{secretCoder:s,cipherTextLen:o}=e,a=e.publicKeyLen,c=_n(e.secretKeyLen,e.publicKeyLen,32,32),l=c.bytesLen,u=32;return{publicKeyLen:a,msgLen:u,keygen:(d=To(64))=>{Et(d,64);const{publicKey:p,secretKey:y}=e.keygen(d.subarray(0,32)),v=t(p),E=c.encode([y,p,v,d.subarray(32)]);return $t(y,v),{publicKey:p,secretKey:E}},encapsulate:(d,p=To(32))=>{Et(d,a),Et(p,u);const y=d.subarray(0,384*r.K),v=s.encode(s.decode(y.slice()));if(!xo(v,y))throw $t(v),new Error("ML-KEM.encapsulate: wrong publicKey modulus");$t(v);const E=n.create().update(p).update(t(d)).digest(),w=e.encrypt(d,p,E.subarray(32,64));return E.subarray(32).fill(0),{cipherText:w,sharedSecret:E.subarray(0,32)}},decapsulate:(d,p)=>{Et(p,l),Et(d,o);const[y,v,E,w]=c.decode(p),b=e.decrypt(d,y),k=n.create().update(b).update(E).digest(),S=k.subarray(0,32),I=e.encrypt(v,b,k.subarray(32,64)),O=xo(d,I),C=i.create({dkLen:32}).update(w).update(d).digest();return $t(b,I,O?C:S),O?S:C}}}function Wl(r,e,t){return ko.create({dkLen:r}).update(e).update(new Uint8Array([t])).digest()}const hi=Hl({...{HASH256:Cl,HASH512:Rl,KDF:ko,XOF:Fl,PRF:Wl},...Ul[768]});class Y{constructor({secret:e=null,bundle:t=null,token:n="USER",address:i=null,position:s=null,batchId:o=null,characters:a=null}){this.token=n,this.balance=0,this.molecules={},this.key=null,this.privkey=null,this.pubkey=null,this.tokenUnits=[],this.tradeRates={},this.address=i,this.position=s,this.bundle=t,this.batchId=o,this.characters=a,e&&(this.bundle=this.bundle||Pt(e,"Wallet::constructor"),this.position=this.position||Y.generatePosition(),this.key=Y.generateKey({secret:e,token:this.token,position:this.position}),this.address=this.address||Y.generateAddress(this.key),this.characters=this.characters||"BASE64",this.initializeMLKEM())}static create({secret:e=null,bundle:t=null,token:n,batchId:i=null,characters:s=null}){let o=null;if(!e&&!t)throw new al;return e&&!t&&(o=Y.generatePosition(),t=Pt(e,"Wallet::create")),new Y({secret:e,bundle:t,token:n,position:o,batchId:i,characters:s})}static isBundleHash(e){return typeof e!="string"?!1:e.length===64&&uo(e)}static getTokenUnits(e){const t=[];return e.forEach(n=>{t.push(Or.createFromDB(n))}),t}static generateKey({secret:e,token:t,position:n}){const s=BigInt(`0x${e}`)+BigInt(`0x${n}`),o=new je("SHAKE256","TEXT");o.update(s.toString(16)),t&&o.update(t);const a=new je("SHAKE256","TEXT");return a.update(o.getHash("HEX",{outputLen:8192})),a.getHash("HEX",{outputLen:8192})}static generateAddress(e){const t=xr(e,128),n=new je("SHAKE256","TEXT");for(const s in t){let o=t[s];for(let a=1;a<=16;a++){const c=new je("SHAKE256","TEXT");c.update(o),o=c.getHash("HEX",{outputLen:512})}n.update(o)}const i=new je("SHAKE256","TEXT");return i.update(n.getHash("HEX",{outputLen:8192})),i.getHash("HEX",{outputLen:256})}static generatePosition(e=64){return yn(e,"abcdef0123456789")}initializeMLKEM(){const e=gn(this.key,64),t=new Uint8Array(64);for(let s=0;s<64;s++)t[s]=parseInt(e.substr(s*2,2),16);const{publicKey:n,secretKey:i}=hi.keygen(t);this.pubkey=this.serializeKey(n),this.privkey=i}serializeKey(e){return btoa(String.fromCharCode.apply(null,e))}deserializeKey(e){const t=atob(e);return new Uint8Array(t.length).map((n,i)=>t.charCodeAt(i))}getTokenUnitsData(){const e=[];return this.tokenUnits.forEach(t=>{e.push(t.toData())}),e}splitUnits(e,t,n=null){if(e.length===0)return;const i=[],s=[];this.tokenUnits.forEach(o=>{e.includes(o.id)?i.push(o):s.push(o)}),this.tokenUnits=i,n!==null&&(n.tokenUnits=i),t.tokenUnits=s}createRemainder(e){const t=Y.create({secret:e,token:this.token,characters:this.characters});return t.initBatchId({sourceWallet:this,isRemainder:!0}),t}isShadow(){return(typeof this.position>"u"||this.position===null)&&(typeof this.address>"u"||this.address===null)}initBatchId({sourceWallet:e,isRemainder:t=!1}){e.batchId&&(this.batchId=t?e.batchId:vn({}))}async encryptMessage(e,t){const n=JSON.stringify(e),i=new TextEncoder().encode(n),s=this.deserializeKey(t),{cipherText:o,sharedSecret:a}=hi.encapsulate(s),c=await this.encryptWithSharedSecret(i,a);return{cipherText:this.serializeKey(o),encryptedMessage:this.serializeKey(c)}}async decryptMessage(e){const{cipherText:t,encryptedMessage:n}=e,i=hi.decapsulate(this.deserializeKey(t),this.privkey),s=await this.decryptWithSharedSecret(this.deserializeKey(n),i),o=new TextDecoder().decode(s);return JSON.parse(o)}async encryptWithSharedSecret(e,t){const n=crypto.getRandomValues(new Uint8Array(12)),i={name:"AES-GCM",iv:n},s=await crypto.subtle.importKey("raw",t,{name:"AES-GCM"},!1,["encrypt"]),o=await crypto.subtle.encrypt(i,s,e),a=new Uint8Array(n.length+o.byteLength);return a.set(n),a.set(new Uint8Array(o),n.length),a}async decryptWithSharedSecret(e,t){const i={name:"AES-GCM",iv:e.slice(0,12)},s=await crypto.subtle.importKey("raw",t,{name:"AES-GCM"},!1,["decrypt"]),o=await crypto.subtle.decrypt(i,s,e.slice(12));return new Uint8Array(o)}}class Dr extends re{constructor(e="There is an atom without an index",t=null,n=null){super(e,t,n),this.name="AtomIndexException"}}class zl extends re{constructor(e="The molecular hash does not match",t=null,n=null){super(e,t,n),this.name="MolecularHashMismatchException"}}class Kl extends re{constructor(e="The molecular hash is missing",t=null,n=null){super(e,t,n),this.name="MolecularHashMissingException"}}class Oo extends re{constructor(e="",t=null,n=null){super(e,t,n),this.name="PolicyInvalidException"}}class Co extends re{constructor(e="OTS malformed",t=null,n=null){super(e,t,n),this.name="SignatureMalformedException"}}class Gl extends re{constructor(e="One-time signature (OTS) does not match!",t=null,n=null){super(e,t,n),this.name="SignatureMismatchException"}}class pt extends re{constructor(e="Insufficient balance to make transfer",t=null,n=null){super(e,t,n),this.name="TransferBalanceException"}}class Ro extends re{constructor(e="Token transfer atoms are malformed",t=null,n=null){super(e,t,n),this.name="TransferMalformedException"}}class No extends re{constructor(e="Token slugs for wallets in transfer do not match!",t=null,n=null){super(e,t,n),this.name="TransferMismatchedException"}}class Mo extends re{constructor(e="Invalid remainder provided",t=null,n=null){super(e,t,n),this.name="TransferRemainderException"}}class Jl extends re{constructor(e="Sender and recipient(s) cannot be the same",t=null,n=null){super(e,t,n),this.name="TransferToSelfException"}}class Yl extends re{constructor(e="Token transfer atoms are unbalanced",t=null,n=null){super(e,t,n),this.name="TransferUnbalancedException"}}class _t extends re{constructor(e="Empty meta data.",t=null,n=null){super(e,t,n),this.name="MetaMissingException"}}class Fr extends re{constructor(e="Wrong type of token for this isotope",t=null,n=null){super(e,t,n),this.name="WrongTokenTypeException"}}class kn extends re{constructor(e="Incorrect BatchId",t=null,n=null){super(e,t,n),this.name="BatchIdException"}}class Do{constructor({}){const e=arguments[0];for(const t in e)this[`__${t}`]=e[t]}static toObject(e){return new this(e)}toJSON(){const e={};for(const t of Object.keys(this))t.substring(0,2)==="__"&&(e[t.substring(2,t.length)]=this[t]);return e}}class Tn extends re{constructor(e="An incorrect argument!",t=null,n=null){super(e,t,n),this.name="RuleArgumentException"}}class Qe extends re{constructor(e="Code exception",t=null,n=null){super(e,t,n),this.name="CodeException"}}class Br{constructor({action:e,metaType:t=null,metaId:n=null,meta:i=null,address:s=null,token:o=null,amount:a=null,comparison:c=null}){if(i&&(this.meta=i),!e)throw new Tn('Callback structure violated, missing mandatory "action" parameter.');this.__metaId=n,this.__metaType=t,this.__action=e,this.__address=s,this.__token=o,this.__amount=a,this.__comparison=c}set comparison(e){this.__comparison=e}set amount(e){if(!il(e))throw new Qe("Parameter amount should be a string containing numbers");this.__amount=e}set token(e){this.__token=e}set address(e){this.__address=e}set meta(e){this.__meta=e instanceof Do?e:Do.toObject(e)}set metaType(e){this.__metaType=e}set metaId(e){this.__metaId=e}static toObject(e){const t=new Br({action:e.action});return e.metaType&&(t.metaType=e.metaType),e.metaId&&(t.metaId=e.metaId),e.meta&&(t.meta=e.meta),e.address&&(t.address=e.address),e.token&&(t.token=e.token),e.amount&&(t.amount=e.amount),e.comparison&&(t.comparison=e.comparison),t}toJSON(){const e={action:this.__action};return this.__metaType&&(e.metaType=this.__metaType),this.__metaId&&(e.metaId=this.__metaId),this.__meta&&(e.meta=this.__meta),this.__address&&(e.address=this.__address),this.__token&&(e.token=this.__token),this.__amount&&(e.amount=this.__amount),this.__comparison&&(e.comparison=this.__comparison),e}isReject(){return this._is("reject")}isMeta(){return Ar(Object.keys(this.toJSON()),["action","metaId","metaType","meta"]).length===4&&this._is("meta")}isCollect(){return Ar(Object.keys(this.toJSON()),["action","address","token","amount","comparison"]).length===5&&this._is("collect")}isBuffer(){return Ar(Object.keys(this.toJSON()),["action","address","token","amount","comparison"]).length===5&&this._is("buffer")}isRemit(){return Ar(Object.keys(this.toJSON()),["action","token","amount"]).length===3&&this._is("remit")}isBurn(){return Ar(Object.keys(this.toJSON()),["action","token","amount","comparison"]).length===4&&this._is("burn")}_is(e){return this.__action.toLowerCase()===e.toLowerCase()}}class pi{constructor({key:e,value:t,comparison:n}){if([e,t,n].some(i=>!i))throw new Tn("Condition::constructor( { key, value, comparison } ) - not all class parameters are initialised!");this.__key=e,this.__value=t,this.__comparison=n}static toObject(e){return new this({key:e.key,value:e.value,comparison:e.comparison})}toJSON(){return{key:this.__key,value:this.__value,comparison:this.__comparison}}}class Pr{constructor({condition:e=[],callback:t=[]}){for(const n of e)if(!(n instanceof pi))throw new Tn;for(const n of t)if(!(n instanceof Br))throw new Tn;this.__condition=e,this.__callback=t}set comparison(e){this.__condition.push(e instanceof pi?e:pi.toObject(e))}set callback(e){this.__callback.push(e instanceof Br?e:Br.toObject(e))}static toObject(e){if(!e.condition)throw new _t("Rule::toObject() - Incorrect rule format! There is no condition field.");if(!e.callback)throw new _t("Rule::toObject() - Incorrect rule format! There is no callback field.");const t=new Pr({});for(const n of e.condition)t.comparison=n;for(const n of e.callback)t.callback=n;return t}toJSON(){return{condition:this.__condition,callback:this.__callback}}}class le{static __init(e,t){this.arr=String(t).split("."),this.key=this.arr.shift();const n=Number(this.key);Number.isInteger(n)&&(this.key=n),this.__nextKey=this.arr.length,this.__next=this.__tic(e)}static __tic(e){return!Array.isArray(e)&&!(e instanceof Object)?!1:typeof e[this.key]<"u"}static has(e,t){return this.__init(e,t),this.__next?this.__nextKey===0?!0:this.has(e[this.key],this.arr.join(".")):!1}static get(e,t,n=null){return this.__init(e,t),this.__next?this.__nextKey===0?e[this.key]:this.get(e[this.key],this.arr.join("."),n):n}static set(e,t,n){const i=t.split(".");let s=e;const o=i.length-1;for(let l=0;l<o;l++){const u=i[l],d=Number(u),p=Number.isInteger(d);(p?d:u in s)||(s[p?d:u]=i[l+1].match(/^\d+$/)?[]:{}),s=s[p?d:u]}const a=i[o],c=Number(a);return s[Number.isInteger(c)?c:a]=n,e}}class Xl{constructor(e){if(e.molecularHash===null)throw new Kl;if(!e.atoms.length)throw new Ft;for(const t of e.atoms)if(t.index===null)throw new Dr;this.molecule=e}verify(e){return this.molecularHash()&&this.ots()&&this.batchId()&&this.continuId()&&this.isotopeM()&&this.isotopeT()&&this.isotopeC()&&this.isotopeU()&&this.isotopeI()&&this.isotopeR()&&this.isotopeV(e)}continuId(){if(this.molecule.atoms[0].token==="USER"&&this.molecule.getIsotopes("I").length<1)throw new Ft("Check::continuId() - Molecule is missing required ContinuID Atom!");return!0}batchId(){if(this.molecule.atoms.length>0){const e=this.molecule.atoms[0];if(e.isotope==="V"&&e.batchId!==null){const t=this.molecule.getIsotopes("V"),n=t[t.length-1];if(e.batchId!==n.batchId)throw new kn;for(const i of t)if(i.batchId===null)throw new kn}return!0}throw new kn}isotopeI(){for(const e of this.molecule.getIsotopes("I")){if(e.token!=="USER")throw new Fr(`Check::isotopeI() - "${e.token}" is not a valid Token slug for "${e.isotope}" isotope Atoms!`);if(e.index===0)throw new Dr(`Check::isotopeI() - Isotope "${e.isotope}" Atoms must have a non-zero index!`)}return!0}isotopeU(){for(const e of this.molecule.getIsotopes("U")){if(e.token!=="AUTH")throw new Fr(`Check::isotopeU() - "${e.token}" is not a valid Token slug for "${e.isotope}" isotope Atoms!`);if(e.index!==0)throw new Dr(`Check::isotopeU() - Isotope "${e.isotope}" Atoms must have an index equal to 0!`)}return!0}isotopeM(){const e=["readPolicy","writePolicy"];for(const t of this.molecule.getIsotopes("M")){if(t.meta.length<1)throw new _t;if(t.token!=="USER")throw new Fr(`Check::isotopeM() - "${t.token}" is not a valid Token slug for "${t.isotope}" isotope Atoms!`);const n=Ir.aggregateMeta(t.meta);for(const i of e){let s=n[i];if(s){s=JSON.parse(s);for(const[o,a]of Object.entries(s))if(!e.includes(o)){if(!Object.keys(n).includes(o))throw new Oo(`${o} is missing from the meta.`);for(const c of a)if(!Y.isBundleHash(c)&&!["all","self"].includes(c))throw new Oo(`${c} does not correspond to the format of the policy.`)}}}}return!0}isotopeC(){for(const e of this.molecule.getIsotopes("C")){if(e.token!=="USER")throw new Fr(`Check::isotopeC() - "${e.token}" is not a valid Token slug for "${e.isotope}" isotope Atoms!`);if(e.index!==0)throw new Dr(`Check::isotopeC() - Isotope "${e.isotope}" Atoms must have an index equal to 0!`)}return!0}isotopeT(){for(const e of this.molecule.getIsotopes("T")){const t=e.aggregatedMeta();if(String(e.metaType).toLowerCase()==="wallet"){for(const i of["position","bundle"])if(!Object.prototype.hasOwnProperty.call(t,i)||!t[i])throw new _t(`Check::isotopeT() - Required meta field "${i}" is missing!`)}for(const i of["token"])if(!Object.prototype.hasOwnProperty.call(t,i)||!t[i])throw new _t(`Check::isotopeT() - Required meta field "${i}" is missing!`);if(e.token!=="USER")throw new Fr(`Check::isotopeT() - "${e.token}" is not a valid Token slug for "${e.isotope}" isotope Atoms!`);if(e.index!==0)throw new Dr(`Check::isotopeT() - Isotope "${e.isotope}" Atoms must have an index equal to 0!`)}return!0}isotopeR(){for(const e of this.molecule.getIsotopes("R")){const t=e.aggregatedMeta();if(t.policy){const n=JSON.parse(t.policy);if(!Object.keys(n).every(i=>["read","write"].includes(i)))throw new _t("Check::isotopeR() - Mixing rules with politics!")}if(t.rule){const n=JSON.parse(t.rule);if(!Array.isArray(n))throw new _t("Check::isotopeR() - Incorrect rule format!");for(const i of n)Pr.toObject(i);if(n.length<1)throw new _t("Check::isotopeR() - No rules!")}}return!0}isotopeV(e=null){const t=this.molecule.getIsotopes("V");if(t.length===0)return!0;const n=this.molecule.atoms[0];if(n.isotope==="V"&&t.length===2){const o=t[t.length-1];if(n.token!==o.token)throw new No;if(o.value<0)throw new Ro;return!0}let i=0,s=0;for(const o in this.molecule.atoms)if(Object.prototype.hasOwnProperty.call(this.molecule.atoms,o)){const a=this.molecule.atoms[o];if(a.isotope!=="V")continue;if(s=a.value*1,Number.isNaN(s))throw new TypeError('Invalid isotope "V" values');if(a.token!==n.token)throw new No;if(o>0){if(s<0)throw new Ro;if(a.walletAddress===n.walletAddress)throw new Jl}i+=s}if(i!==s)throw new Yl;if(e){if(s=n.value*1,Number.isNaN(s))throw new TypeError('Invalid isotope "V" values');const o=e.balance+s;if(o<0)throw new pt;if(o!==i)throw new Mo}else if(s!==0)throw new Mo;return!0}molecularHash(){if(this.molecule.molecularHash!==Q.hashAtoms({atoms:this.molecule.atoms}))throw new zl;return!0}ots(){const e=this.molecule.normalizedHash();let t=this.molecule.atoms.map(p=>p.otsFragment).reduce((p,y)=>p+y);if(t.length!==2048&&(t=ao(t),t.length!==2048))throw new Co;const n=xr(t,128);let i="";for(const p in n){let y=n[p];for(let v=0,E=8+e[p];v<E;v++)y=new je("SHAKE256","TEXT").update(y).getHash("HEX",{outputLen:512});i+=y}const s=new je("SHAKE256","TEXT");s.update(i);const o=s.getHash("HEX",{outputLen:8192}),a=new je("SHAKE256","TEXT");a.update(o);const c=a.getHash("HEX",{outputLen:256}),l=this.molecule.atoms[0];let u=l.walletAddress;const d=le.get(l.aggregatedMeta(),"signingWallet");if(d&&(u=le.get(JSON.parse(d),"address")),c!==u)throw new Gl;return!0}}class $r extends re{constructor(e="Insufficient balance for requested transfer",t=null,n=null){super(e,t,n),this.name="BalanceInsufficientException"}}class Fo extends re{constructor(e="Amount cannot be negative!",t=null,n=null){super(e,t,n),this.name="NegativeAmountException"}}class it{constructor({secret:e=null,bundle:t=null,sourceWallet:n=null,remainderWallet:i=null,cellSlug:s=null,version:o=null}){this.status=null,this.molecularHash=null,this.createdAt=String(+new Date),this.cellSlugOrigin=this.cellSlug=s,this.secret=e,this.bundle=t,this.sourceWallet=n,this.atoms=[],o!==null&&Object.prototype.hasOwnProperty.call(mn,o)&&(this.version=String(o)),(i||n)&&(this.remainderWallet=i||Y.create({secret:e,bundle:t,token:n.token,batchId:n.batchId,characters:n.characters}))}get cellSlugDelimiter(){return"."}static isotopeFilter(e,t){return Array.isArray(e)||(e=[e]),t.filter(n=>e.includes(n.isotope))}static generateNextAtomIndex(e){return e.length}static jsonToObject(e){const t=Object.assign(new it({}),JSON.parse(e)),n=Object.keys(new it({}));if(!Array.isArray(t.atoms))throw new Ft;for(const i in Object.keys(t.atoms)){t.atoms[i]=Q.jsonToObject(JSON.stringify(t.atoms[i]));for(const s of["position","walletAddress","isotope"])if(t.atoms[i].isotope.toLowerCase()!=="r"&&(typeof t.atoms[i][s]>"u"||t.atoms[i][s]===null))throw new Ft("MolecularStructure::jsonToObject() - Required Atom properties are missing!")}for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&!n.includes(i)&&delete t[i];return t.atoms=Q.sortAtoms(t.atoms),t}static enumerate(e){const t={0:-8,1:-7,2:-6,3:-5,4:-4,5:-3,6:-2,7:-1,8:0,9:1,a:2,b:3,c:4,d:5,e:6,f:7,g:8},n=[],i=e.toLowerCase().split("");for(let s=0,o=i.length;s<o;++s){const a=i[s];typeof t[a]<"u"&&(n[s]=t[a])}return n}static normalize(e){let t=e.reduce((i,s)=>i+s);const n=t<0;for(;t<0||t>0;)for(const i of Object.keys(e))if((n?e[i]<8:e[i]>-8)&&(n?(++e[i],++t):(--e[i],--t),t===0))break;return e}getIsotopes(e){return it.isotopeFilter(e,this.atoms)}generateIndex(){return it.generateNextAtomIndex(this.atoms)}fill(e){for(const t in Object.keys(e))this[t]=e[t]}addAtom(e){return this.molecularHash=null,e.index=this.generateIndex(),e.version=this.version,this.atoms.push(e),this.atoms=Q.sortAtoms(this.atoms),this}addContinuIdAtom(){return this.addAtom(Q.create({isotope:"I",wallet:this.remainderWallet,metaType:"walletBundle",metaId:this.remainderWallet.bundle})),this}addPolicyAtom({metaType:e,metaId:t,meta:n={},policy:i={}}){const s=new Ue(n);s.addPolicy(i);const o=Y.create({secret:this.secret,bundle:this.sourceWallet.bundle,token:"USER"});return this.addAtom(Q.create({wallet:o,isotope:"R",metaType:e,metaId:t,meta:s})),this}fuseToken(e,t){const n=e.length;if(this.sourceWallet.balance-n<0)throw new $r;return this.addAtom(Q.create({isotope:"V",wallet:this.sourceWallet,value:-n})),this.addAtom(Q.create({isotope:"F",wallet:t,value:1,metaType:"walletBundle",metaId:t.bundle})),this.addAtom(Q.create({isotope:"V",wallet:this.remainderWallet,value:this.sourceWallet.balance-n,metaType:"walletBundle",metaId:this.remainderWallet.bundle})),this}burnToken({amount:e,walletBundle:t=null}){if(e<0)throw new Fo("Molecule::burnToken() - Amount to burn must be positive!");if(this.sourceWallet.balance-e<0)throw new $r;return this.addAtom(Q.create({isotope:"V",wallet:this.sourceWallet,value:-e})),this.addAtom(Q.create({isotope:"V",wallet:this.remainderWallet,value:this.sourceWallet.balance-e,metaType:"walletBundle",metaId:this.remainderWallet.bundle})),this}replenishToken({amount:e,units:t=[]}){if(e<0)throw new Fo("Molecule::replenishToken() - Amount to replenish must be positive!");if(t.length){t=Y.getTokenUnits(t),this.remainderWallet.tokenUnits=this.sourceWallet.tokenUnits;for(const n of t)this.remainderWallet.tokenUnits.push(n);this.remainderWallet.balance=this.remainderWallet.tokenUnits.length,this.sourceWallet.tokenUnits=t,this.sourceWallet.balance=this.sourceWallet.tokenUnits.length}else this.remainderWallet.balance=this.sourceWallet.balance+e,this.sourceWallet.balance=e;return this.addAtom(Q.create({isotope:"V",wallet:this.sourceWallet,value:this.sourceWallet.balance})),this.addAtom(Q.create({isotope:"V",wallet:this.remainderWallet,value:this.remainderWallet.balance,metaType:"walletBundle",metaId:this.remainderWallet.bundle})),this}initValue({recipientWallet:e,amount:t}){if(this.sourceWallet.balance-t<0)throw new $r;return this.addAtom(Q.create({isotope:"V",wallet:this.sourceWallet,value:-t})),this.addAtom(Q.create({isotope:"V",wallet:e,value:t,metaType:"walletBundle",metaId:e.bundle})),this.addAtom(Q.create({isotope:"V",wallet:this.remainderWallet,value:this.sourceWallet.balance-t,metaType:"walletBundle",metaId:this.remainderWallet.bundle})),this}initDepositBuffer({amount:e,tradeRates:t}){if(this.sourceWallet.balance-e<0)throw new $r;const n=Y.create({secret:this.secret,bundle:this.bundle,token:this.sourceWallet.token,batchId:this.sourceWallet.batchId});return n.tradeRates=t,this.addAtom(Q.create({isotope:"V",wallet:this.sourceWallet,value:-e})),this.addAtom(Q.create({isotope:"B",wallet:n,value:e,metaType:"walletBundle",metaId:this.sourceWallet.bundle})),this.addAtom(Q.create({isotope:"V",wallet:this.remainderWallet,value:this.sourceWallet.balance-e,metaType:"walletBundle",metaId:this.sourceWallet.bundle})),this}initWithdrawBuffer({recipients:e,signingWallet:t=null}){let n=0;for(const[s,o]of Object.entries(e||{}))n+=o;if(this.sourceWallet.balance-n<0)throw new $r;const i=new Ue;t&&i.setSigningWallet(t),this.addAtom(Q.create({isotope:"B",wallet:this.sourceWallet,value:-n,meta:i,metaType:"walletBundle",metaId:this.sourceWallet.bundle}));for(const[s,o]of Object.entries(e||{}))this.addAtom(new Q({isotope:"V",token:this.sourceWallet.token,value:o,batchId:this.sourceWallet.batchId?vn({}):null,metaType:"walletBundle",metaId:s}));return this.addAtom(Q.create({isotope:"B",wallet:this.remainderWallet,value:this.sourceWallet.balance-n,metaType:"walletBundle",metaId:this.remainderWallet.bundle})),this}initTokenCreation({recipientWallet:e,amount:t,meta:n}){const i=new Ue(n);return i.setMetaWallet(e),this.addAtom(Q.create({isotope:"C",wallet:this.sourceWallet,value:t,metaType:"token",metaId:e.token,meta:i,batchId:e.batchId})),this.addContinuIdAtom(),this}createRule({metaType:e,metaId:t,rule:n,policy:i={}}){const s=[];for(const a of n)s.push(a instanceof Pr?a:Pr.toObject(a));const o=new Ue({rule:JSON.stringify(s)});return o.addPolicy(i),this.addAtom(Q.create({isotope:"R",wallet:this.sourceWallet,metaType:e,metaId:t,meta:o})),this.addContinuIdAtom(),this}initWalletCreation(e,t=null){t||(t=new Ue),t.setMetaWallet(e);const n=Q.create({isotope:"C",wallet:this.sourceWallet,metaType:"wallet",metaId:e.address,meta:t,batchId:e.batchId});return this.addAtom(n),this.addContinuIdAtom(),this}initShadowWalletClaim(e){const t=new Ue().setShadowWalletClaim(!0);return this.initWalletCreation(e,t)}initIdentifierCreation({type:e,contact:t,code:n}){const i={code:n,hash:Pt(t.trim(),"Molecule::initIdentifierCreation")};return this.addAtom(Q.create({isotope:"C",wallet:this.sourceWallet,metaType:"identifier",metaId:e,meta:new Ue(i)})),this.addContinuIdAtom(),this}initMeta({meta:e,metaType:t,metaId:n,policy:i}){return this.addAtom(Q.create({isotope:"M",wallet:this.sourceWallet,metaType:t,metaId:n,meta:new Ue(e)})),this.addPolicyAtom({metaType:t,metaId:n,meta:e,policy:i}),this.addContinuIdAtom(),this}initTokenRequest({token:e,amount:t,metaType:n,metaId:i,meta:s={},batchId:o=null}){return s.token=e,this.local=1,this.addAtom(Q.create({isotope:"T",wallet:this.sourceWallet,value:t,metaType:n,metaId:i,meta:new Ue(s),batchId:o})),this.addContinuIdAtom(),this}initAuthorization({meta:e}){return this.addAtom(Q.create({isotope:"U",wallet:this.sourceWallet,meta:new Ue(e)})),this.addContinuIdAtom(),this}sign({bundle:e=null,anonymous:t=!1,compressed:n=!0}){if(this.atoms.length===0||this.atoms.filter(y=>!(y instanceof Q)).length!==0)throw new Ft;!t&&!this.bundle&&(this.bundle=e||Pt(this.secret,"Molecule::sign")),this.molecularHash=Q.hashAtoms({atoms:this.atoms});const i=this.atoms[0];let s=i.position;const o=le.get(i.aggregatedMeta(),"signingWallet");if(o&&(s=le.get(JSON.parse(o),"position")),!s)throw new Co("Signing wallet must have a position!");const a=Y.generateKey({secret:this.secret,token:i.token,position:i.position}),c=xr(a,128),l=this.normalizedHash();let u="";for(const y in c){let v=c[y];for(let E=0,w=8-l[y];E<w;E++)v=new je("SHAKE256","TEXT").update(v).getHash("HEX",{outputLen:512});u+=v}n&&(u=oo(u));const d=xr(u,Math.ceil(u.length/this.atoms.length));let p=null;for(let y=0,v=d.length;y<v;y++)this.atoms[y].otsFragment=d[y],p=this.atoms[y].position;return p}cellSlugBase(){return(this.cellSlug||"").split(this.cellSlugDelimiter)[0]}toJSON(){const e=co(this);for(const t of["remainderWallet","secret","sourceWallet","cellSlugOrigin","version"])Object.prototype.hasOwnProperty.call(e,t)&&delete e[t];return e}check(e=null){new Xl(this).verify(e)}normalizedHash(){return it.normalize(it.enumerate(this.molecularHash))}}const di=10**18;class Zt{static val(e){return Math.abs(e*di)<1?0:e}static cmp(e,t,n=!1){const i=Zt.val(e)*di,s=Zt.val(t)*di;return Math.abs(i-s)<1?0:i>s?1:-1}static equal(e,t){return Zt.cmp(e,t)===0}}class Lr{constructor({token:e,expiresAt:t,encrypt:n,pubkey:i}){this.$__token=e,this.$__expiresAt=t,this.$__pubkey=i,this.$__encrypt=n}static create(e,t){const n=new Lr(e);return n.setWallet(t),n}static restore(e,t){const n=new Y({secret:t,token:"AUTH",position:e.wallet.position,characters:e.wallet.characters});return Lr.create({token:e.token,expiresAt:e.expiresAt,pubkey:e.pubkey,encrypt:e.encrypt},n)}setWallet(e){this.$__wallet=e}getWallet(){return this.$__wallet}getSnapshot(){return{token:this.$__token,expiresAt:this.$__expiresAt,pubkey:this.$__pubkey,encrypt:this.$__encrypt,wallet:{position:this.$__wallet.position,characters:this.$__wallet.characters}}}getToken(){return this.$__token}getPubkey(){return this.$__pubkey}getExpireInterval(){return this.$__expiresAt*1e3-Date.now()}isExpired(){return!this.$__expiresAt||this.getExpireInterval()<0}getAuthData(){return{token:this.getToken(),pubkey:this.getPubkey(),wallet:this.getWallet()}}}class Ur extends re{constructor(e="GraphQL did not provide a valid response.",t=null,n=null){super(e,t,n),this.name="InvalidResponseException"}}class yi extends re{constructor(e="Authorization token missing or invalid.",t=null,n=null){super(e,t,n),this.name="UnauthenticatedException"}}let ve=class{constructor({query:e,json:t,dataKey:n=null}){if(this.dataKey=n,this.errorKey="exception",this.$__payload=null,this.$__query=e,this.$__originResponse=t,this.$__response=t,typeof this.$__response>"u"||this.$__response===null)throw new Ur;if(le.has(this.$__response,this.errorKey)){const i=le.get(this.$__response,this.errorKey);throw String(i).includes("Unauthenticated")?new yi:new Ur}this.init()}init(){}data(){if(!this.dataKey)return this.response();if(!le.has(this.response(),this.dataKey))throw new Ur;return le.get(this.response(),this.dataKey)}response(){return this.$__response}payload(){return null}query(){return this.$__query}status(){return null}};class Pe{constructor(e,t){this.client=e,this.knishIOClient=t,this.$__variables=null,this.$__query=null,this.$__response=null,this.$__request=null}response(){return this.$__response}async createResponseRaw(e){return this.createResponse(e)}createResponse(e){return new ve({query:this,json:e})}createQuery({variables:e=null}){if(this.$__variables=this.compiledVariables(e),!this.uri())throw new Qe("Query::createQuery() - Node URI was not initialized for this client instance!");if(this.$__query===null)throw new Qe("Query::createQuery() - GraphQL subscription was not initialized!");return{query:this.$__query,variables:this.variables()}}async execute({variables:e=null,context:t={}}){this.$__request=this.createQuery({variables:e});const n={...t,...this.createQueryContext()};try{const i=await this.client.query({...this.$__request,context:n});return this.$__response=await this.createResponseRaw(i),this.$__response}catch(i){if(i.name==="AbortError")return this.knishIOClient.log("warn","Query was cancelled"),new ve({query:this,json:{data:null,errors:[{message:"Query was cancelled"}]}});throw i}}compiledVariables(e=null){return e||{}}uri(){return this.client.getUri()}variables(){return this.$__variables}createQueryContext(){return{}}}class Zl extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.ContinuId"})}payload(){let e=null;const t=this.data();return t&&(e=new Y({secret:null,token:t.tokenSlug}),e.address=t.address,e.position=t.position,e.bundle=t.bundleHash,e.batchId=t.batchId,e.characters=t.characters,e.pubkey=t.pubkey,e.balance=t.amount*1),e}}var mi=function(r,e){return mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},mi(r,e)};function He(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");mi(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var T=function(){return T=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},T.apply(this,arguments)};function st(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function St(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}function kt(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(t=0)),t;)try{if(n=1,i&&(s=l[0]&2?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){t.label=l[1];break}if(l[0]===6&&t.label<s[1]){t.label=s[1],s=l;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(l);break}s[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],i=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Re(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError;var gi="Invariant Violation",Bo=Object.setPrototypeOf,ef=Bo===void 0?function(r,e){return r.__proto__=e,r}:Bo,Po=function(r){He(e,r);function e(t){t===void 0&&(t=gi);var n=r.call(this,typeof t=="number"?gi+": "+t+" (see https://github.com/apollographql/invariant-packages)":t)||this;return n.framesToPop=1,n.name=gi,ef(n,e.prototype),n}return e}(Error);function er(r,e){if(!r)throw new Po(e)}var $o=["debug","log","warn","error","silent"],tf=$o.indexOf("log");function xn(r){return function(){if($o.indexOf(r)>=tf){var e=console[r]||console.log;return e.apply(console,arguments)}}}(function(r){r.debug=xn("debug"),r.log=xn("log"),r.warn=xn("warn"),r.error=xn("error")})(er);var vi="3.12.5";function Ge(r){try{return r()}catch{}}const bi=Ge(function(){return globalThis})||Ge(function(){return window})||Ge(function(){return self})||Ge(function(){return nt})||Ge(function(){return Ge.constructor("return this")()});var Lo=new Map;function wi(r){var e=Lo.get(r)||1;return Lo.set(r,e+1),"".concat(r,":").concat(e,":").concat(Math.random().toString(36).slice(2))}function Uo(r,e){e===void 0&&(e=0);var t=wi("stringifyForDisplay");return JSON.stringify(r,function(n,i){return i===void 0?t:i},e).split(JSON.stringify(t)).join("<undefined>")}function In(r){return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(typeof e=="number"){var i=e;e=Ei(i),e||(e=_i(i,t),t=[])}r.apply(void 0,[e].concat(t))}}var $=Object.assign(function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];e||er(e,Ei(t,n)||_i(t,n))},{debug:In(er.debug),log:In(er.log),warn:In(er.warn),error:In(er.error)});function Fe(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return new Po(Ei(r,e)||_i(r,e))}var qo=Symbol.for("ApolloErrorMessageHandler_"+vi);function jo(r){if(typeof r=="string")return r;try{return Uo(r,2).slice(0,1e3)}catch{return"<non-serializable>"}}function Ei(r,e){if(e===void 0&&(e=[]),!!r)return bi[qo]&&bi[qo](r,e.map(jo))}function _i(r,e){if(e===void 0&&(e=[]),!!r)return"An error occurred! For more details, see the full error text at https://go.apollo.dev/c/err#".concat(encodeURIComponent(JSON.stringify({version:vi,message:r,args:e.map(jo)})))}function An(r,e){if(!!!r)throw new Error(e)}function rf(r){return typeof r=="object"&&r!==null}function nf(r,e){if(!!!r)throw new Error("Unexpected invariant triggered.")}const sf=/\r\n|[\n\r]/g;function Si(r,e){let t=0,n=1;for(const i of r.body.matchAll(sf)){if(typeof i.index=="number"||nf(!1),i.index>=e)break;t=i.index+i[0].length,n+=1}return{line:n,column:e+1-t}}function of(r){return Vo(r.source,Si(r.source,r.start))}function Vo(r,e){const t=r.locationOffset.column-1,n="".padStart(t)+r.body,i=e.line-1,s=r.locationOffset.line-1,o=e.line+s,a=e.line===1?t:0,c=e.column+a,l=`${r.name}:${o}:${c}
`,u=n.split(/\r\n|[\n\r]/g),d=u[i];if(d.length>120){const p=Math.floor(c/80),y=c%80,v=[];for(let E=0;E<d.length;E+=80)v.push(d.slice(E,E+80));return l+Qo([[`${o} |`,v[0]],...v.slice(1,p+1).map(E=>["|",E]),["|","^".padStart(y)],["|",v[p+1]]])}return l+Qo([[`${o-1} |`,u[i-1]],[`${o} |`,d],["|","^".padStart(c)],[`${o+1} |`,u[i+1]]])}function Qo(r){const e=r.filter(([n,i])=>i!==void 0),t=Math.max(...e.map(([n])=>n.length));return e.map(([n,i])=>n.padStart(t)+(i?" "+i:"")).join(`
`)}function af(r){const e=r[0];return e==null||"kind"in e||"length"in e?{nodes:e,source:r[1],positions:r[2],path:r[3],originalError:r[4],extensions:r[5]}:e}class ki extends Error{constructor(e,...t){var n,i,s;const{nodes:o,source:a,positions:c,path:l,originalError:u,extensions:d}=af(t);super(e),this.name="GraphQLError",this.path=l??void 0,this.originalError=u??void 0,this.nodes=Ho(Array.isArray(o)?o:o?[o]:void 0);const p=Ho((n=this.nodes)===null||n===void 0?void 0:n.map(v=>v.loc).filter(v=>v!=null));this.source=a??(p==null||(i=p[0])===null||i===void 0?void 0:i.source),this.positions=c??p?.map(v=>v.start),this.locations=c&&a?c.map(v=>Si(a,v)):p?.map(v=>Si(v.source,v.start));const y=rf(u?.extensions)?u?.extensions:void 0;this.extensions=(s=d??y)!==null&&s!==void 0?s:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),u!=null&&u.stack?Object.defineProperty(this,"stack",{value:u.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,ki):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const t of this.nodes)t.loc&&(e+=`

`+of(t.loc));else if(this.source&&this.locations)for(const t of this.locations)e+=`

`+Vo(this.source,t);return e}toJSON(){const e={message:this.message};return this.locations!=null&&(e.locations=this.locations),this.path!=null&&(e.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function Ho(r){return r===void 0||r.length===0?void 0:r}function Ee(r,e,t){return new ki(`Syntax Error: ${t}`,{source:r,positions:[e]})}class uf{constructor(e,t,n){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class Wo{constructor(e,t,n,i,s,o){this.kind=e,this.start=t,this.end=n,this.line=i,this.column=s,this.value=o,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const zo={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},cf=new Set(Object.keys(zo));function Ko(r){const e=r?.kind;return typeof e=="string"&&cf.has(e)}var tr;(function(r){r.QUERY="query",r.MUTATION="mutation",r.SUBSCRIPTION="subscription"})(tr||(tr={}));var Ti;(function(r){r.QUERY="QUERY",r.MUTATION="MUTATION",r.SUBSCRIPTION="SUBSCRIPTION",r.FIELD="FIELD",r.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",r.FRAGMENT_SPREAD="FRAGMENT_SPREAD",r.INLINE_FRAGMENT="INLINE_FRAGMENT",r.VARIABLE_DEFINITION="VARIABLE_DEFINITION",r.SCHEMA="SCHEMA",r.SCALAR="SCALAR",r.OBJECT="OBJECT",r.FIELD_DEFINITION="FIELD_DEFINITION",r.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",r.INTERFACE="INTERFACE",r.UNION="UNION",r.ENUM="ENUM",r.ENUM_VALUE="ENUM_VALUE",r.INPUT_OBJECT="INPUT_OBJECT",r.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(Ti||(Ti={}));var D;(function(r){r.NAME="Name",r.DOCUMENT="Document",r.OPERATION_DEFINITION="OperationDefinition",r.VARIABLE_DEFINITION="VariableDefinition",r.SELECTION_SET="SelectionSet",r.FIELD="Field",r.ARGUMENT="Argument",r.FRAGMENT_SPREAD="FragmentSpread",r.INLINE_FRAGMENT="InlineFragment",r.FRAGMENT_DEFINITION="FragmentDefinition",r.VARIABLE="Variable",r.INT="IntValue",r.FLOAT="FloatValue",r.STRING="StringValue",r.BOOLEAN="BooleanValue",r.NULL="NullValue",r.ENUM="EnumValue",r.LIST="ListValue",r.OBJECT="ObjectValue",r.OBJECT_FIELD="ObjectField",r.DIRECTIVE="Directive",r.NAMED_TYPE="NamedType",r.LIST_TYPE="ListType",r.NON_NULL_TYPE="NonNullType",r.SCHEMA_DEFINITION="SchemaDefinition",r.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",r.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",r.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",r.FIELD_DEFINITION="FieldDefinition",r.INPUT_VALUE_DEFINITION="InputValueDefinition",r.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",r.UNION_TYPE_DEFINITION="UnionTypeDefinition",r.ENUM_TYPE_DEFINITION="EnumTypeDefinition",r.ENUM_VALUE_DEFINITION="EnumValueDefinition",r.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",r.DIRECTIVE_DEFINITION="DirectiveDefinition",r.SCHEMA_EXTENSION="SchemaExtension",r.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",r.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",r.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",r.UNION_TYPE_EXTENSION="UnionTypeExtension",r.ENUM_TYPE_EXTENSION="EnumTypeExtension",r.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(D||(D={}));function xi(r){return r===9||r===32}function qr(r){return r>=48&&r<=57}function Go(r){return r>=97&&r<=122||r>=65&&r<=90}function Jo(r){return Go(r)||r===95}function lf(r){return Go(r)||qr(r)||r===95}function ff(r){var e;let t=Number.MAX_SAFE_INTEGER,n=null,i=-1;for(let o=0;o<r.length;++o){var s;const a=r[o],c=hf(a);c!==a.length&&(n=(s=n)!==null&&s!==void 0?s:o,i=o,o!==0&&c<t&&(t=c))}return r.map((o,a)=>a===0?o:o.slice(t)).slice((e=n)!==null&&e!==void 0?e:0,i+1)}function hf(r){let e=0;for(;e<r.length&&xi(r.charCodeAt(e));)++e;return e}function pf(r,e){const t=r.replace(/"""/g,'\\"""'),n=t.split(/\r\n|[\n\r]/g),i=n.length===1,s=n.length>1&&n.slice(1).every(y=>y.length===0||xi(y.charCodeAt(0))),o=t.endsWith('\\"""'),a=r.endsWith('"')&&!o,c=r.endsWith("\\"),l=a||c,u=!i||r.length>70||l||s||o;let d="";const p=i&&xi(r.charCodeAt(0));return(u&&!p||s)&&(d+=`
`),d+=t,(u||l)&&(d+=`
`),'"""'+d+'"""'}var N;(function(r){r.SOF="<SOF>",r.EOF="<EOF>",r.BANG="!",r.DOLLAR="$",r.AMP="&",r.PAREN_L="(",r.PAREN_R=")",r.SPREAD="...",r.COLON=":",r.EQUALS="=",r.AT="@",r.BRACKET_L="[",r.BRACKET_R="]",r.BRACE_L="{",r.PIPE="|",r.BRACE_R="}",r.NAME="Name",r.INT="Int",r.FLOAT="Float",r.STRING="String",r.BLOCK_STRING="BlockString",r.COMMENT="Comment"})(N||(N={}));class df{constructor(e){const t=new Wo(N.SOF,0,0,0,0);this.source=e,this.lastToken=t,this.token=t,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==N.EOF)do if(e.next)e=e.next;else{const t=mf(this,e.end);e.next=t,t.prev=e,e=t}while(e.kind===N.COMMENT);return e}}function yf(r){return r===N.BANG||r===N.DOLLAR||r===N.AMP||r===N.PAREN_L||r===N.PAREN_R||r===N.SPREAD||r===N.COLON||r===N.EQUALS||r===N.AT||r===N.BRACKET_L||r===N.BRACKET_R||r===N.BRACE_L||r===N.PIPE||r===N.BRACE_R}function rr(r){return r>=0&&r<=55295||r>=57344&&r<=1114111}function On(r,e){return Yo(r.charCodeAt(e))&&Xo(r.charCodeAt(e+1))}function Yo(r){return r>=55296&&r<=56319}function Xo(r){return r>=56320&&r<=57343}function qt(r,e){const t=r.source.body.codePointAt(e);if(t===void 0)return N.EOF;if(t>=32&&t<=126){const n=String.fromCodePoint(t);return n==='"'?`'"'`:`"${n}"`}return"U+"+t.toString(16).toUpperCase().padStart(4,"0")}function me(r,e,t,n,i){const s=r.line,o=1+t-r.lineStart;return new Wo(e,t,n,s,o,i)}function mf(r,e){const t=r.source.body,n=t.length;let i=e;for(;i<n;){const s=t.charCodeAt(i);switch(s){case 65279:case 9:case 32:case 44:++i;continue;case 10:++i,++r.line,r.lineStart=i;continue;case 13:t.charCodeAt(i+1)===10?i+=2:++i,++r.line,r.lineStart=i;continue;case 35:return gf(r,i);case 33:return me(r,N.BANG,i,i+1);case 36:return me(r,N.DOLLAR,i,i+1);case 38:return me(r,N.AMP,i,i+1);case 40:return me(r,N.PAREN_L,i,i+1);case 41:return me(r,N.PAREN_R,i,i+1);case 46:if(t.charCodeAt(i+1)===46&&t.charCodeAt(i+2)===46)return me(r,N.SPREAD,i,i+3);break;case 58:return me(r,N.COLON,i,i+1);case 61:return me(r,N.EQUALS,i,i+1);case 64:return me(r,N.AT,i,i+1);case 91:return me(r,N.BRACKET_L,i,i+1);case 93:return me(r,N.BRACKET_R,i,i+1);case 123:return me(r,N.BRACE_L,i,i+1);case 124:return me(r,N.PIPE,i,i+1);case 125:return me(r,N.BRACE_R,i,i+1);case 34:return t.charCodeAt(i+1)===34&&t.charCodeAt(i+2)===34?Sf(r,i):bf(r,i)}if(qr(s)||s===45)return vf(r,i,s);if(Jo(s))return kf(r,i);throw Ee(r.source,i,s===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:rr(s)||On(t,i)?`Unexpected character: ${qt(r,i)}.`:`Invalid character: ${qt(r,i)}.`)}return me(r,N.EOF,n,n)}function gf(r,e){const t=r.source.body,n=t.length;let i=e+1;for(;i<n;){const s=t.charCodeAt(i);if(s===10||s===13)break;if(rr(s))++i;else if(On(t,i))i+=2;else break}return me(r,N.COMMENT,e,i,t.slice(e+1,i))}function vf(r,e,t){const n=r.source.body;let i=e,s=t,o=!1;if(s===45&&(s=n.charCodeAt(++i)),s===48){if(s=n.charCodeAt(++i),qr(s))throw Ee(r.source,i,`Invalid number, unexpected digit after 0: ${qt(r,i)}.`)}else i=Ii(r,i,s),s=n.charCodeAt(i);if(s===46&&(o=!0,s=n.charCodeAt(++i),i=Ii(r,i,s),s=n.charCodeAt(i)),(s===69||s===101)&&(o=!0,s=n.charCodeAt(++i),(s===43||s===45)&&(s=n.charCodeAt(++i)),i=Ii(r,i,s),s=n.charCodeAt(i)),s===46||Jo(s))throw Ee(r.source,i,`Invalid number, expected digit but got: ${qt(r,i)}.`);return me(r,o?N.FLOAT:N.INT,e,i,n.slice(e,i))}function Ii(r,e,t){if(!qr(t))throw Ee(r.source,e,`Invalid number, expected digit but got: ${qt(r,e)}.`);const n=r.source.body;let i=e+1;for(;qr(n.charCodeAt(i));)++i;return i}function bf(r,e){const t=r.source.body,n=t.length;let i=e+1,s=i,o="";for(;i<n;){const a=t.charCodeAt(i);if(a===34)return o+=t.slice(s,i),me(r,N.STRING,e,i+1,o);if(a===92){o+=t.slice(s,i);const c=t.charCodeAt(i+1)===117?t.charCodeAt(i+2)===123?wf(r,i):Ef(r,i):_f(r,i);o+=c.value,i+=c.size,s=i;continue}if(a===10||a===13)break;if(rr(a))++i;else if(On(t,i))i+=2;else throw Ee(r.source,i,`Invalid character within String: ${qt(r,i)}.`)}throw Ee(r.source,i,"Unterminated string.")}function wf(r,e){const t=r.source.body;let n=0,i=3;for(;i<12;){const s=t.charCodeAt(e+i++);if(s===125){if(i<5||!rr(n))break;return{value:String.fromCodePoint(n),size:i}}if(n=n<<4|jr(s),n<0)break}throw Ee(r.source,e,`Invalid Unicode escape sequence: "${t.slice(e,e+i)}".`)}function Ef(r,e){const t=r.source.body,n=Zo(t,e+2);if(rr(n))return{value:String.fromCodePoint(n),size:6};if(Yo(n)&&t.charCodeAt(e+6)===92&&t.charCodeAt(e+7)===117){const i=Zo(t,e+8);if(Xo(i))return{value:String.fromCodePoint(n,i),size:12}}throw Ee(r.source,e,`Invalid Unicode escape sequence: "${t.slice(e,e+6)}".`)}function Zo(r,e){return jr(r.charCodeAt(e))<<12|jr(r.charCodeAt(e+1))<<8|jr(r.charCodeAt(e+2))<<4|jr(r.charCodeAt(e+3))}function jr(r){return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:-1}function _f(r,e){const t=r.source.body;switch(t.charCodeAt(e+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw Ee(r.source,e,`Invalid character escape sequence: "${t.slice(e,e+2)}".`)}function Sf(r,e){const t=r.source.body,n=t.length;let i=r.lineStart,s=e+3,o=s,a="";const c=[];for(;s<n;){const l=t.charCodeAt(s);if(l===34&&t.charCodeAt(s+1)===34&&t.charCodeAt(s+2)===34){a+=t.slice(o,s),c.push(a);const u=me(r,N.BLOCK_STRING,e,s+3,ff(c).join(`
`));return r.line+=c.length-1,r.lineStart=i,u}if(l===92&&t.charCodeAt(s+1)===34&&t.charCodeAt(s+2)===34&&t.charCodeAt(s+3)===34){a+=t.slice(o,s),o=s+1,s+=4;continue}if(l===10||l===13){a+=t.slice(o,s),c.push(a),l===13&&t.charCodeAt(s+1)===10?s+=2:++s,a="",o=s,i=s;continue}if(rr(l))++s;else if(On(t,s))s+=2;else throw Ee(r.source,s,`Invalid character within String: ${qt(r,s)}.`)}throw Ee(r.source,s,"Unterminated string.")}function kf(r,e){const t=r.source.body,n=t.length;let i=e+1;for(;i<n;){const s=t.charCodeAt(i);if(lf(s))++i;else break}return me(r,N.NAME,e,i,t.slice(e,i))}const Tf=10,ea=2;function Ai(r){return Cn(r,[])}function Cn(r,e){switch(typeof r){case"string":return JSON.stringify(r);case"function":return r.name?`[function ${r.name}]`:"[function]";case"object":return xf(r,e);default:return String(r)}}function xf(r,e){if(r===null)return"null";if(e.includes(r))return"[Circular]";const t=[...e,r];if(If(r)){const n=r.toJSON();if(n!==r)return typeof n=="string"?n:Cn(n,t)}else if(Array.isArray(r))return Of(r,t);return Af(r,t)}function If(r){return typeof r.toJSON=="function"}function Af(r,e){const t=Object.entries(r);return t.length===0?"{}":e.length>ea?"["+Cf(r)+"]":"{ "+t.map(([i,s])=>i+": "+Cn(s,e)).join(", ")+" }"}function Of(r,e){if(r.length===0)return"[]";if(e.length>ea)return"[Array]";const t=Math.min(Tf,r.length),n=r.length-t,i=[];for(let s=0;s<t;++s)i.push(Cn(r[s],e));return n===1?i.push("... 1 more item"):n>1&&i.push(`... ${n} more items`),"["+i.join(", ")+"]"}function Cf(r){const e=Object.prototype.toString.call(r).replace(/^\[object /,"").replace(/]$/,"");if(e==="Object"&&typeof r.constructor=="function"){const t=r.constructor.name;if(typeof t=="string"&&t!=="")return t}return e}const Rf=function(e,t){if(e instanceof t)return!0;if(typeof e=="object"&&e!==null){var n;const i=t.prototype[Symbol.toStringTag],s=Symbol.toStringTag in e?e[Symbol.toStringTag]:(n=e.constructor)===null||n===void 0?void 0:n.name;if(i===s){const o=Ai(e);throw new Error(`Cannot use ${i} "${o}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class ta{constructor(e,t="GraphQL request",n={line:1,column:1}){typeof e=="string"||An(!1,`Body must be a string. Received: ${Ai(e)}.`),this.body=e,this.name=t,this.locationOffset=n,this.locationOffset.line>0||An(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||An(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function Nf(r){return Rf(r,ta)}function Mf(r,e){const t=new Df(r,e),n=t.parseDocument();return Object.defineProperty(n,"tokenCount",{enumerable:!1,value:t.tokenCount}),n}class Df{constructor(e,t={}){const n=Nf(e)?e:new ta(e);this._lexer=new df(n),this._options=t,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){const e=this.expectToken(N.NAME);return this.node(e,{kind:D.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:D.DOCUMENT,definitions:this.many(N.SOF,this.parseDefinition,N.EOF)})}parseDefinition(){if(this.peek(N.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),t=e?this._lexer.lookahead():this._lexer.token;if(t.kind===N.NAME){switch(t.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw Ee(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(t.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(t)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(N.BRACE_L))return this.node(e,{kind:D.OPERATION_DEFINITION,operation:tr.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const t=this.parseOperationType();let n;return this.peek(N.NAME)&&(n=this.parseName()),this.node(e,{kind:D.OPERATION_DEFINITION,operation:t,name:n,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(N.NAME);switch(e.value){case"query":return tr.QUERY;case"mutation":return tr.MUTATION;case"subscription":return tr.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(N.PAREN_L,this.parseVariableDefinition,N.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:D.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(N.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(N.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(N.DOLLAR),this.node(e,{kind:D.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:D.SELECTION_SET,selections:this.many(N.BRACE_L,this.parseSelection,N.BRACE_R)})}parseSelection(){return this.peek(N.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,t=this.parseName();let n,i;return this.expectOptionalToken(N.COLON)?(n=t,i=this.parseName()):i=t,this.node(e,{kind:D.FIELD,alias:n,name:i,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(N.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const t=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(N.PAREN_L,t,N.PAREN_R)}parseArgument(e=!1){const t=this._lexer.token,n=this.parseName();return this.expectToken(N.COLON),this.node(t,{kind:D.ARGUMENT,name:n,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(N.SPREAD);const t=this.expectOptionalKeyword("on");return!t&&this.peek(N.NAME)?this.node(e,{kind:D.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:D.INLINE_FRAGMENT,typeCondition:t?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(e,{kind:D.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:D.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(e){const t=this._lexer.token;switch(t.kind){case N.BRACKET_L:return this.parseList(e);case N.BRACE_L:return this.parseObject(e);case N.INT:return this.advanceLexer(),this.node(t,{kind:D.INT,value:t.value});case N.FLOAT:return this.advanceLexer(),this.node(t,{kind:D.FLOAT,value:t.value});case N.STRING:case N.BLOCK_STRING:return this.parseStringLiteral();case N.NAME:switch(this.advanceLexer(),t.value){case"true":return this.node(t,{kind:D.BOOLEAN,value:!0});case"false":return this.node(t,{kind:D.BOOLEAN,value:!1});case"null":return this.node(t,{kind:D.NULL});default:return this.node(t,{kind:D.ENUM,value:t.value})}case N.DOLLAR:if(e)if(this.expectToken(N.DOLLAR),this._lexer.token.kind===N.NAME){const n=this._lexer.token.value;throw Ee(this._lexer.source,t.start,`Unexpected variable "$${n}" in constant value.`)}else throw this.unexpected(t);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:D.STRING,value:e.value,block:e.kind===N.BLOCK_STRING})}parseList(e){const t=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:D.LIST,values:this.any(N.BRACKET_L,t,N.BRACKET_R)})}parseObject(e){const t=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:D.OBJECT,fields:this.any(N.BRACE_L,t,N.BRACE_R)})}parseObjectField(e){const t=this._lexer.token,n=this.parseName();return this.expectToken(N.COLON),this.node(t,{kind:D.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e)})}parseDirectives(e){const t=[];for(;this.peek(N.AT);)t.push(this.parseDirective(e));return t}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const t=this._lexer.token;return this.expectToken(N.AT),this.node(t,{kind:D.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let t;if(this.expectOptionalToken(N.BRACKET_L)){const n=this.parseTypeReference();this.expectToken(N.BRACKET_R),t=this.node(e,{kind:D.LIST_TYPE,type:n})}else t=this.parseNamedType();return this.expectOptionalToken(N.BANG)?this.node(e,{kind:D.NON_NULL_TYPE,type:t}):t}parseNamedType(){return this.node(this._lexer.token,{kind:D.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(N.STRING)||this.peek(N.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("schema");const n=this.parseConstDirectives(),i=this.many(N.BRACE_L,this.parseOperationTypeDefinition,N.BRACE_R);return this.node(e,{kind:D.SCHEMA_DEFINITION,description:t,directives:n,operationTypes:i})}parseOperationTypeDefinition(){const e=this._lexer.token,t=this.parseOperationType();this.expectToken(N.COLON);const n=this.parseNamedType();return this.node(e,{kind:D.OPERATION_TYPE_DEFINITION,operation:t,type:n})}parseScalarTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("scalar");const n=this.parseName(),i=this.parseConstDirectives();return this.node(e,{kind:D.SCALAR_TYPE_DEFINITION,description:t,name:n,directives:i})}parseObjectTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("type");const n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:D.OBJECT_TYPE_DEFINITION,description:t,name:n,interfaces:i,directives:s,fields:o})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(N.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(N.BRACE_L,this.parseFieldDefinition,N.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),i=this.parseArgumentDefs();this.expectToken(N.COLON);const s=this.parseTypeReference(),o=this.parseConstDirectives();return this.node(e,{kind:D.FIELD_DEFINITION,description:t,name:n,arguments:i,type:s,directives:o})}parseArgumentDefs(){return this.optionalMany(N.PAREN_L,this.parseInputValueDef,N.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,t=this.parseDescription(),n=this.parseName();this.expectToken(N.COLON);const i=this.parseTypeReference();let s;this.expectOptionalToken(N.EQUALS)&&(s=this.parseConstValueLiteral());const o=this.parseConstDirectives();return this.node(e,{kind:D.INPUT_VALUE_DEFINITION,description:t,name:n,type:i,defaultValue:s,directives:o})}parseInterfaceTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("interface");const n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:D.INTERFACE_TYPE_DEFINITION,description:t,name:n,interfaces:i,directives:s,fields:o})}parseUnionTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("union");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseUnionMemberTypes();return this.node(e,{kind:D.UNION_TYPE_DEFINITION,description:t,name:n,directives:i,types:s})}parseUnionMemberTypes(){return this.expectOptionalToken(N.EQUALS)?this.delimitedMany(N.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("enum");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseEnumValuesDefinition();return this.node(e,{kind:D.ENUM_TYPE_DEFINITION,description:t,name:n,directives:i,values:s})}parseEnumValuesDefinition(){return this.optionalMany(N.BRACE_L,this.parseEnumValueDefinition,N.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,t=this.parseDescription(),n=this.parseEnumValueName(),i=this.parseConstDirectives();return this.node(e,{kind:D.ENUM_VALUE_DEFINITION,description:t,name:n,directives:i})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw Ee(this._lexer.source,this._lexer.token.start,`${Rn(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("input");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseInputFieldsDefinition();return this.node(e,{kind:D.INPUT_OBJECT_TYPE_DEFINITION,description:t,name:n,directives:i,fields:s})}parseInputFieldsDefinition(){return this.optionalMany(N.BRACE_L,this.parseInputValueDef,N.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===N.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const t=this.parseConstDirectives(),n=this.optionalMany(N.BRACE_L,this.parseOperationTypeDefinition,N.BRACE_R);if(t.length===0&&n.length===0)throw this.unexpected();return this.node(e,{kind:D.SCHEMA_EXTENSION,directives:t,operationTypes:n})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const t=this.parseName(),n=this.parseConstDirectives();if(n.length===0)throw this.unexpected();return this.node(e,{kind:D.SCALAR_TYPE_EXTENSION,name:t,directives:n})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const t=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(n.length===0&&i.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:D.OBJECT_TYPE_EXTENSION,name:t,interfaces:n,directives:i,fields:s})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const t=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(n.length===0&&i.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:D.INTERFACE_TYPE_EXTENSION,name:t,interfaces:n,directives:i,fields:s})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const t=this.parseName(),n=this.parseConstDirectives(),i=this.parseUnionMemberTypes();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:D.UNION_TYPE_EXTENSION,name:t,directives:n,types:i})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const t=this.parseName(),n=this.parseConstDirectives(),i=this.parseEnumValuesDefinition();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:D.ENUM_TYPE_EXTENSION,name:t,directives:n,values:i})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const t=this.parseName(),n=this.parseConstDirectives(),i=this.parseInputFieldsDefinition();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:D.INPUT_OBJECT_TYPE_EXTENSION,name:t,directives:n,fields:i})}parseDirectiveDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("directive"),this.expectToken(N.AT);const n=this.parseName(),i=this.parseArgumentDefs(),s=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const o=this.parseDirectiveLocations();return this.node(e,{kind:D.DIRECTIVE_DEFINITION,description:t,name:n,arguments:i,repeatable:s,locations:o})}parseDirectiveLocations(){return this.delimitedMany(N.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,t=this.parseName();if(Object.prototype.hasOwnProperty.call(Ti,t.value))return t;throw this.unexpected(e)}node(e,t){return this._options.noLocation!==!0&&(t.loc=new uf(e,this._lexer.lastToken,this._lexer.source)),t}peek(e){return this._lexer.token.kind===e}expectToken(e){const t=this._lexer.token;if(t.kind===e)return this.advanceLexer(),t;throw Ee(this._lexer.source,t.start,`Expected ${ra(e)}, found ${Rn(t)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e?(this.advanceLexer(),!0):!1}expectKeyword(e){const t=this._lexer.token;if(t.kind===N.NAME&&t.value===e)this.advanceLexer();else throw Ee(this._lexer.source,t.start,`Expected "${e}", found ${Rn(t)}.`)}expectOptionalKeyword(e){const t=this._lexer.token;return t.kind===N.NAME&&t.value===e?(this.advanceLexer(),!0):!1}unexpected(e){const t=e??this._lexer.token;return Ee(this._lexer.source,t.start,`Unexpected ${Rn(t)}.`)}any(e,t,n){this.expectToken(e);const i=[];for(;!this.expectOptionalToken(n);)i.push(t.call(this));return i}optionalMany(e,t,n){if(this.expectOptionalToken(e)){const i=[];do i.push(t.call(this));while(!this.expectOptionalToken(n));return i}return[]}many(e,t,n){this.expectToken(e);const i=[];do i.push(t.call(this));while(!this.expectOptionalToken(n));return i}delimitedMany(e,t){this.expectOptionalToken(e);const n=[];do n.push(t.call(this));while(this.expectOptionalToken(e));return n}advanceLexer(){const{maxTokens:e}=this._options,t=this._lexer.advance();if(t.kind!==N.EOF&&(++this._tokenCounter,e!==void 0&&this._tokenCounter>e))throw Ee(this._lexer.source,t.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function Rn(r){const e=r.value;return ra(r.kind)+(e!=null?` "${e}"`:"")}function ra(r){return yf(r)?`"${r}"`:r}function Ff(r){return`"${r.replace(Bf,Pf)}"`}const Bf=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function Pf(r){return $f[r.charCodeAt(0)]}const $f=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],Nn=Object.freeze({});function Je(r,e,t=zo){const n=new Map;for(const b of Object.values(D))n.set(b,Lf(e,b));let i,s=Array.isArray(r),o=[r],a=-1,c=[],l=r,u,d;const p=[],y=[];do{a++;const b=a===o.length,k=b&&c.length!==0;if(b){if(u=y.length===0?void 0:p[p.length-1],l=d,d=y.pop(),k)if(s){l=l.slice();let I=0;for(const[O,C]of c){const M=O-I;C===null?(l.splice(M,1),I++):l[M]=C}}else{l=Object.defineProperties({},Object.getOwnPropertyDescriptors(l));for(const[I,O]of c)l[I]=O}a=i.index,o=i.keys,c=i.edits,s=i.inArray,i=i.prev}else if(d){if(u=s?a:o[a],l=d[u],l==null)continue;p.push(u)}let S;if(!Array.isArray(l)){var v,E;Ko(l)||An(!1,`Invalid AST Node: ${Ai(l)}.`);const I=b?(v=n.get(l.kind))===null||v===void 0?void 0:v.leave:(E=n.get(l.kind))===null||E===void 0?void 0:E.enter;if(S=I?.call(e,l,u,d,p,y),S===Nn)break;if(S===!1){if(!b){p.pop();continue}}else if(S!==void 0&&(c.push([u,S]),!b))if(Ko(S))l=S;else{p.pop();continue}}if(S===void 0&&k&&c.push([u,l]),b)p.pop();else{var w;i={inArray:s,index:a,keys:o,edits:c,prev:i},s=Array.isArray(l),o=s?l:(w=t[l.kind])!==null&&w!==void 0?w:[],a=-1,c=[],d&&y.push(d),d=l}}while(i!==void 0);return c.length!==0?c[c.length-1][1]:r}function Lf(r,e){const t=r[e];return typeof t=="object"?t:typeof t=="function"?{enter:t,leave:void 0}:{enter:r.enter,leave:r.leave}}function na(r){return Je(r,qf)}const Uf=80,qf={Name:{leave:r=>r.value},Variable:{leave:r=>"$"+r.name},Document:{leave:r=>P(r.definitions,`

`)},OperationDefinition:{leave(r){const e=K("(",P(r.variableDefinitions,", "),")"),t=P([r.operation,P([r.name,e]),P(r.directives," ")]," ");return(t==="query"?"":t+" ")+r.selectionSet}},VariableDefinition:{leave:({variable:r,type:e,defaultValue:t,directives:n})=>r+": "+e+K(" = ",t)+K(" ",P(n," "))},SelectionSet:{leave:({selections:r})=>Ye(r)},Field:{leave({alias:r,name:e,arguments:t,directives:n,selectionSet:i}){const s=K("",r,": ")+e;let o=s+K("(",P(t,", "),")");return o.length>Uf&&(o=s+K(`(
`,Mn(P(t,`
`)),`
)`)),P([o,P(n," "),i]," ")}},Argument:{leave:({name:r,value:e})=>r+": "+e},FragmentSpread:{leave:({name:r,directives:e})=>"..."+r+K(" ",P(e," "))},InlineFragment:{leave:({typeCondition:r,directives:e,selectionSet:t})=>P(["...",K("on ",r),P(e," "),t]," ")},FragmentDefinition:{leave:({name:r,typeCondition:e,variableDefinitions:t,directives:n,selectionSet:i})=>`fragment ${r}${K("(",P(t,", "),")")} on ${e} ${K("",P(n," ")," ")}`+i},IntValue:{leave:({value:r})=>r},FloatValue:{leave:({value:r})=>r},StringValue:{leave:({value:r,block:e})=>e?pf(r):Ff(r)},BooleanValue:{leave:({value:r})=>r?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:r})=>r},ListValue:{leave:({values:r})=>"["+P(r,", ")+"]"},ObjectValue:{leave:({fields:r})=>"{"+P(r,", ")+"}"},ObjectField:{leave:({name:r,value:e})=>r+": "+e},Directive:{leave:({name:r,arguments:e})=>"@"+r+K("(",P(e,", "),")")},NamedType:{leave:({name:r})=>r},ListType:{leave:({type:r})=>"["+r+"]"},NonNullType:{leave:({type:r})=>r+"!"},SchemaDefinition:{leave:({description:r,directives:e,operationTypes:t})=>K("",r,`
`)+P(["schema",P(e," "),Ye(t)]," ")},OperationTypeDefinition:{leave:({operation:r,type:e})=>r+": "+e},ScalarTypeDefinition:{leave:({description:r,name:e,directives:t})=>K("",r,`
`)+P(["scalar",e,P(t," ")]," ")},ObjectTypeDefinition:{leave:({description:r,name:e,interfaces:t,directives:n,fields:i})=>K("",r,`
`)+P(["type",e,K("implements ",P(t," & ")),P(n," "),Ye(i)]," ")},FieldDefinition:{leave:({description:r,name:e,arguments:t,type:n,directives:i})=>K("",r,`
`)+e+(ia(t)?K(`(
`,Mn(P(t,`
`)),`
)`):K("(",P(t,", "),")"))+": "+n+K(" ",P(i," "))},InputValueDefinition:{leave:({description:r,name:e,type:t,defaultValue:n,directives:i})=>K("",r,`
`)+P([e+": "+t,K("= ",n),P(i," ")]," ")},InterfaceTypeDefinition:{leave:({description:r,name:e,interfaces:t,directives:n,fields:i})=>K("",r,`
`)+P(["interface",e,K("implements ",P(t," & ")),P(n," "),Ye(i)]," ")},UnionTypeDefinition:{leave:({description:r,name:e,directives:t,types:n})=>K("",r,`
`)+P(["union",e,P(t," "),K("= ",P(n," | "))]," ")},EnumTypeDefinition:{leave:({description:r,name:e,directives:t,values:n})=>K("",r,`
`)+P(["enum",e,P(t," "),Ye(n)]," ")},EnumValueDefinition:{leave:({description:r,name:e,directives:t})=>K("",r,`
`)+P([e,P(t," ")]," ")},InputObjectTypeDefinition:{leave:({description:r,name:e,directives:t,fields:n})=>K("",r,`
`)+P(["input",e,P(t," "),Ye(n)]," ")},DirectiveDefinition:{leave:({description:r,name:e,arguments:t,repeatable:n,locations:i})=>K("",r,`
`)+"directive @"+e+(ia(t)?K(`(
`,Mn(P(t,`
`)),`
)`):K("(",P(t,", "),")"))+(n?" repeatable":"")+" on "+P(i," | ")},SchemaExtension:{leave:({directives:r,operationTypes:e})=>P(["extend schema",P(r," "),Ye(e)]," ")},ScalarTypeExtension:{leave:({name:r,directives:e})=>P(["extend scalar",r,P(e," ")]," ")},ObjectTypeExtension:{leave:({name:r,interfaces:e,directives:t,fields:n})=>P(["extend type",r,K("implements ",P(e," & ")),P(t," "),Ye(n)]," ")},InterfaceTypeExtension:{leave:({name:r,interfaces:e,directives:t,fields:n})=>P(["extend interface",r,K("implements ",P(e," & ")),P(t," "),Ye(n)]," ")},UnionTypeExtension:{leave:({name:r,directives:e,types:t})=>P(["extend union",r,P(e," "),K("= ",P(t," | "))]," ")},EnumTypeExtension:{leave:({name:r,directives:e,values:t})=>P(["extend enum",r,P(e," "),Ye(t)]," ")},InputObjectTypeExtension:{leave:({name:r,directives:e,fields:t})=>P(["extend input",r,P(e," "),Ye(t)]," ")}};function P(r,e=""){var t;return(t=r?.filter(n=>n).join(e))!==null&&t!==void 0?t:""}function Ye(r){return K(`{
`,Mn(P(r,`
`)),`
}`)}function K(r,e,t=""){return e!=null&&e!==""?r+e+t:""}function Mn(r){return K("  ",r.replace(/\n/g,`
  `))}function ia(r){var e;return(e=r?.some(t=>t.includes(`
`)))!==null&&e!==void 0?e:!1}function sa(r){return r.kind===D.FIELD||r.kind===D.FRAGMENT_SPREAD||r.kind===D.INLINE_FRAGMENT}function Vr(r,e){var t=r.directives;return!t||!t.length?!0:Qf(t).every(function(n){var i=n.directive,s=n.ifArgument,o=!1;return s.value.kind==="Variable"?(o=e&&e[s.value.name.value],$(o!==void 0,78,i.name.value)):o=s.value.value,i.name.value==="skip"?!o:o})}function Qr(r,e,t){var n=new Set(r),i=n.size;return Je(e,{Directive:function(s){if(n.delete(s.name.value)&&(!t||!n.size))return Nn}}),t?!n.size:n.size<i}function jf(r){return r&&Qr(["client","export"],r,!0)}function Vf(r){var e=r.name.value;return e==="skip"||e==="include"}function Qf(r){var e=[];return r&&r.length&&r.forEach(function(t){if(Vf(t)){var n=t.arguments,i=t.name.value;$(n&&n.length===1,79,i);var s=n[0];$(s.name&&s.name.value==="if",80,i);var o=s.value;$(o&&(o.kind==="Variable"||o.kind==="BooleanValue"),81,i),e.push({directive:t,ifArgument:s})}}),e}function Hf(r){var e,t,n=(e=r.directives)===null||e===void 0?void 0:e.find(function(s){var o=s.name;return o.value==="unmask"});if(!n)return"mask";var i=(t=n.arguments)===null||t===void 0?void 0:t.find(function(s){var o=s.name;return o.value==="mode"});return globalThis.__DEV__!==!1&&i&&(i.value.kind===D.VARIABLE?globalThis.__DEV__!==!1&&$.warn(82):i.value.kind!==D.STRING?globalThis.__DEV__!==!1&&$.warn(83):i.value.value!=="migrate"&&globalThis.__DEV__!==!1&&$.warn(84,i.value.value)),i&&"value"in i.value&&i.value.value==="migrate"?"migrate":"unmask"}const Wf=()=>Object.create(null),{forEach:zf,slice:oa}=Array.prototype,{hasOwnProperty:Kf}=Object.prototype;class dt{constructor(e=!0,t=Wf){this.weakness=e,this.makeData=t}lookup(){return this.lookupArray(arguments)}lookupArray(e){let t=this;return zf.call(e,n=>t=t.getChildTrie(n)),Kf.call(t,"data")?t.data:t.data=this.makeData(oa.call(e))}peek(){return this.peekArray(arguments)}peekArray(e){let t=this;for(let n=0,i=e.length;t&&n<i;++n){const s=t.mapFor(e[n],!1);t=s&&s.get(e[n])}return t&&t.data}remove(){return this.removeArray(arguments)}removeArray(e){let t;if(e.length){const n=e[0],i=this.mapFor(n,!1),s=i&&i.get(n);s&&(t=s.removeArray(oa.call(e,1)),!s.data&&!s.weak&&!(s.strong&&s.strong.size)&&i.delete(n))}else t=this.data,delete this.data;return t}getChildTrie(e){const t=this.mapFor(e,!0);let n=t.get(e);return n||t.set(e,n=new dt(this.weakness,this.makeData)),n}mapFor(e,t){return this.weakness&&Gf(e)?this.weak||(t?this.weak=new WeakMap:void 0):this.strong||(t?this.strong=new Map:void 0)}}function Gf(r){switch(typeof r){case"object":if(r===null)break;case"function":return!0}return!1}var Jf=Ge(function(){return navigator.product})=="ReactNative",jt=typeof WeakMap=="function"&&!(Jf&&!nt.HermesInternal),Oi=typeof WeakSet=="function",aa=typeof Symbol=="function"&&typeof Symbol.for=="function",Dn=aa&&Symbol.asyncIterator;Ge(function(){return window.document.createElement}),Ge(function(){return navigator.userAgent.indexOf("jsdom")>=0});function ue(r){return r!==null&&typeof r=="object"}function Yf(r,e){var t=e,n=[];r.definitions.forEach(function(s){if(s.kind==="OperationDefinition")throw Fe(85,s.operation,s.name?" named '".concat(s.name.value,"'"):"");s.kind==="FragmentDefinition"&&n.push(s)}),typeof t>"u"&&($(n.length===1,86,n.length),t=n[0].name.value);var i=T(T({},r),{definitions:Re([{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:t}}]}}],r.definitions,!0)});return i}function nr(r){r===void 0&&(r=[]);var e={};return r.forEach(function(t){e[t.name.value]=t}),e}function Fn(r,e){switch(r.kind){case"InlineFragment":return r;case"FragmentSpread":{var t=r.name.value;if(typeof e=="function")return e(t);var n=e&&e[t];return $(n,87,t),n||null}default:return null}}function Xf(r){var e=!0;return Je(r,{FragmentSpread:function(t){if(e=!!t.directives&&t.directives.some(function(n){return n.name.value==="unmask"}),!e)return Nn}}),e}function Zf(){}class Ci{constructor(e=1/0,t=Zf){this.max=e,this.dispose=t,this.map=new Map,this.newest=null,this.oldest=null}has(e){return this.map.has(e)}get(e){const t=this.getNode(e);return t&&t.value}get size(){return this.map.size}getNode(e){const t=this.map.get(e);if(t&&t!==this.newest){const{older:n,newer:i}=t;i&&(i.older=n),n&&(n.newer=i),t.older=this.newest,t.older.newer=t,t.newer=null,this.newest=t,t===this.oldest&&(this.oldest=i)}return t}set(e,t){let n=this.getNode(e);return n?n.value=t:(n={key:e,value:t,newer:null,older:this.newest},this.newest&&(this.newest.newer=n),this.newest=n,this.oldest=this.oldest||n,this.map.set(e,n),n.value)}clean(){for(;this.oldest&&this.map.size>this.max;)this.delete(this.oldest.key)}delete(e){const t=this.map.get(e);return t?(t===this.newest&&(this.newest=t.older),t===this.oldest&&(this.oldest=t.newer),t.newer&&(t.newer.older=t.older),t.older&&(t.older.newer=t.newer),this.map.delete(e),this.dispose(t.value,e),!0):!1}}function Ri(){}const eh=Ri,th=typeof WeakRef<"u"?WeakRef:function(r){return{deref:()=>r}},rh=typeof WeakMap<"u"?WeakMap:Map,nh=typeof FinalizationRegistry<"u"?FinalizationRegistry:function(){return{register:Ri,unregister:Ri}},ih=10024;class Bn{constructor(e=1/0,t=eh){this.max=e,this.dispose=t,this.map=new rh,this.newest=null,this.oldest=null,this.unfinalizedNodes=new Set,this.finalizationScheduled=!1,this.size=0,this.finalize=()=>{const n=this.unfinalizedNodes.values();for(let i=0;i<ih;i++){const s=n.next().value;if(!s)break;this.unfinalizedNodes.delete(s);const o=s.key;delete s.key,s.keyRef=new th(o),this.registry.register(o,s,s)}this.unfinalizedNodes.size>0?queueMicrotask(this.finalize):this.finalizationScheduled=!1},this.registry=new nh(this.deleteNode.bind(this))}has(e){return this.map.has(e)}get(e){const t=this.getNode(e);return t&&t.value}getNode(e){const t=this.map.get(e);if(t&&t!==this.newest){const{older:n,newer:i}=t;i&&(i.older=n),n&&(n.newer=i),t.older=this.newest,t.older.newer=t,t.newer=null,this.newest=t,t===this.oldest&&(this.oldest=i)}return t}set(e,t){let n=this.getNode(e);return n?n.value=t:(n={key:e,value:t,newer:null,older:this.newest},this.newest&&(this.newest.newer=n),this.newest=n,this.oldest=this.oldest||n,this.scheduleFinalization(n),this.map.set(e,n),this.size++,n.value)}clean(){for(;this.oldest&&this.size>this.max;)this.deleteNode(this.oldest)}deleteNode(e){e===this.newest&&(this.newest=e.older),e===this.oldest&&(this.oldest=e.newer),e.newer&&(e.newer.older=e.older),e.older&&(e.older.newer=e.newer),this.size--;const t=e.key||e.keyRef&&e.keyRef.deref();this.dispose(e.value,t),e.keyRef?this.registry.unregister(e):this.unfinalizedNodes.delete(e),t&&this.map.delete(t)}delete(e){const t=this.map.get(e);return t?(this.deleteNode(t),!0):!1}scheduleFinalization(e){this.unfinalizedNodes.add(e),this.finalizationScheduled||(this.finalizationScheduled=!0,queueMicrotask(this.finalize))}}var Ni=new WeakSet;function ua(r){r.size<=(r.max||-1)||Ni.has(r)||(Ni.add(r),setTimeout(function(){r.clean(),Ni.delete(r)},100))}var ca=function(r,e){var t=new Bn(r,e);return t.set=function(n,i){var s=Bn.prototype.set.call(this,n,i);return ua(this),s},t},sh=function(r,e){var t=new Ci(r,e);return t.set=function(n,i){var s=Ci.prototype.set.call(this,n,i);return ua(this),s},t},oh=Symbol.for("apollo.cacheSize"),yt=T({},bi[oh]),Vt={};function la(r,e){Vt[r]=e}var ah=globalThis.__DEV__!==!1?fh:void 0,uh=globalThis.__DEV__!==!1?hh:void 0,ch=globalThis.__DEV__!==!1?fa:void 0;function lh(){var r={parser:1e3,canonicalStringify:1e3,print:2e3,"documentTransform.cache":2e3,"queryManager.getDocumentInfo":2e3,"PersistedQueryLink.persistedQueryHashes":2e3,"fragmentRegistry.transform":2e3,"fragmentRegistry.lookup":1e3,"fragmentRegistry.findFragmentSpreads":4e3,"cache.fragmentQueryDocuments":1e3,"removeTypenameFromVariables.getVariableDefinitions":2e3,"inMemoryCache.maybeBroadcastWatch":5e3,"inMemoryCache.executeSelectionSet":5e4,"inMemoryCache.executeSubSelectedArray":1e4};return Object.fromEntries(Object.entries(r).map(function(e){var t=e[0],n=e[1];return[t,yt[t]||n]}))}function fh(){var r,e,t,n,i;if(globalThis.__DEV__===!1)throw new Error("only supported in development mode");return{limits:lh(),sizes:T({print:(r=Vt.print)===null||r===void 0?void 0:r.call(Vt),parser:(e=Vt.parser)===null||e===void 0?void 0:e.call(Vt),canonicalStringify:(t=Vt.canonicalStringify)===null||t===void 0?void 0:t.call(Vt),links:Di(this.link),queryManager:{getDocumentInfo:this.queryManager.transformCache.size,documentTransforms:pa(this.queryManager.documentTransform)}},(i=(n=this.cache).getMemoryInternals)===null||i===void 0?void 0:i.call(n))}}function fa(){return{cache:{fragmentQueryDocuments:Tt(this.getFragmentDoc)}}}function hh(){var r=this.config.fragments;return T(T({},fa.apply(this)),{addTypenameDocumentTransform:pa(this.addTypenameTransform),inMemoryCache:{executeSelectionSet:Tt(this.storeReader.executeSelectionSet),executeSubSelectedArray:Tt(this.storeReader.executeSubSelectedArray),maybeBroadcastWatch:Tt(this.maybeBroadcastWatch)},fragmentRegistry:{findFragmentSpreads:Tt(r?.findFragmentSpreads),lookup:Tt(r?.lookup),transform:Tt(r?.transform)}})}function ph(r){return!!r&&"dirtyKey"in r}function Tt(r){return ph(r)?r.size:void 0}function ha(r){return r!=null}function pa(r){return Mi(r).map(function(e){return{cache:e}})}function Mi(r){return r?Re(Re([Tt(r?.performWork)],Mi(r?.left),!0),Mi(r?.right),!0).filter(ha):[]}function Di(r){var e;return r?Re(Re([(e=r?.getMemoryInternals)===null||e===void 0?void 0:e.call(r)],Di(r?.left),!0),Di(r?.right),!0).filter(ha):[]}var xt=Object.assign(function(e){return JSON.stringify(e,dh)},{reset:function(){ir=new sh(yt.canonicalStringify||1e3)}});globalThis.__DEV__!==!1&&la("canonicalStringify",function(){return ir.size});var ir;xt.reset();function dh(r,e){if(e&&typeof e=="object"){var t=Object.getPrototypeOf(e);if(t===Object.prototype||t===null){var n=Object.keys(e);if(n.every(yh))return e;var i=JSON.stringify(n),s=ir.get(i);if(!s){n.sort();var o=JSON.stringify(n);s=ir.get(o)||n,ir.set(i,s),ir.set(o,s)}var a=Object.create(t);return s.forEach(function(c){a[c]=e[c]}),a}}return e}function yh(r,e,t){return e===0||t[e-1]<=r}function sr(r){return{__ref:String(r)}}function X(r){return!!(r&&typeof r=="object"&&typeof r.__ref=="string")}function mh(r){return ue(r)&&r.kind==="Document"&&Array.isArray(r.definitions)}function gh(r){return r.kind==="StringValue"}function vh(r){return r.kind==="BooleanValue"}function bh(r){return r.kind==="IntValue"}function wh(r){return r.kind==="FloatValue"}function Eh(r){return r.kind==="Variable"}function _h(r){return r.kind==="ObjectValue"}function Sh(r){return r.kind==="ListValue"}function kh(r){return r.kind==="EnumValue"}function Th(r){return r.kind==="NullValue"}function or(r,e,t,n){if(bh(t)||wh(t))r[e.value]=Number(t.value);else if(vh(t)||gh(t))r[e.value]=t.value;else if(_h(t)){var i={};t.fields.map(function(o){return or(i,o.name,o.value,n)}),r[e.value]=i}else if(Eh(t)){var s=(n||{})[t.name.value];r[e.value]=s}else if(Sh(t))r[e.value]=t.values.map(function(o){var a={};return or(a,e,o,n),a[e.value]});else if(kh(t))r[e.value]=t.value;else if(Th(t))r[e.value]=null;else throw Fe(96,e.value,t.kind)}function xh(r,e){var t=null;r.directives&&(t={},r.directives.forEach(function(i){t[i.name.value]={},i.arguments&&i.arguments.forEach(function(s){var o=s.name,a=s.value;return or(t[i.name.value],o,a,e)})}));var n=null;return r.arguments&&r.arguments.length&&(n={},r.arguments.forEach(function(i){var s=i.name,o=i.value;return or(n,s,o,e)})),da(r.name.value,n,t)}var Ih=["connection","include","skip","client","rest","export","nonreactive"],Hr=xt,da=Object.assign(function(r,e,t){if(e&&t&&t.connection&&t.connection.key)if(t.connection.filter&&t.connection.filter.length>0){var n=t.connection.filter?t.connection.filter:[];n.sort();var i={};return n.forEach(function(a){i[a]=e[a]}),"".concat(t.connection.key,"(").concat(Hr(i),")")}else return t.connection.key;var s=r;if(e){var o=Hr(e);s+="(".concat(o,")")}return t&&Object.keys(t).forEach(function(a){Ih.indexOf(a)===-1&&(t[a]&&Object.keys(t[a]).length?s+="@".concat(a,"(").concat(Hr(t[a]),")"):s+="@".concat(a))}),s},{setStringify:function(r){var e=Hr;return Hr=r,e}});function Pn(r,e){if(r.arguments&&r.arguments.length){var t={};return r.arguments.forEach(function(n){var i=n.name,s=n.value;return or(t,i,s,e)}),t}return null}function mt(r){return r.alias?r.alias.value:r.name.value}function Fi(r,e,t){for(var n,i=0,s=e.selections;i<s.length;i++){var o=s[i];if(It(o)){if(o.name.value==="__typename")return r[mt(o)]}else n?n.push(o):n=[o]}if(typeof r.__typename=="string")return r.__typename;if(n)for(var a=0,c=n;a<c.length;a++){var o=c[a],l=Fi(r,Fn(o,t).selectionSet,t);if(typeof l=="string")return l}}function It(r){return r.kind==="Field"}function Ah(r){return r.kind==="InlineFragment"}function ar(r){$(r&&r.kind==="Document",88);var e=r.definitions.filter(function(t){return t.kind!=="FragmentDefinition"}).map(function(t){if(t.kind!=="OperationDefinition")throw Fe(89,t.kind);return t});return $(e.length<=1,90,e.length),r}function Qt(r){return ar(r),r.definitions.filter(function(e){return e.kind==="OperationDefinition"})[0]}function Wr(r){return r.definitions.filter(function(e){return e.kind==="OperationDefinition"&&!!e.name}).map(function(e){return e.name.value})[0]||null}function ur(r){return r.definitions.filter(function(e){return e.kind==="FragmentDefinition"})}function ya(r){var e=Qt(r);return $(e&&e.operation==="query",91),e}function ma(r){$(r.kind==="Document",92),$(r.definitions.length<=1,93);var e=r.definitions[0];return $(e.kind==="FragmentDefinition",94),e}function cr(r){ar(r);for(var e,t=0,n=r.definitions;t<n.length;t++){var i=n[t];if(i.kind==="OperationDefinition"){var s=i.operation;if(s==="query"||s==="mutation"||s==="subscription")return i}i.kind==="FragmentDefinition"&&!e&&(e=i)}if(e)return e;throw Fe(95)}function Bi(r){var e=Object.create(null),t=r&&r.variableDefinitions;return t&&t.length&&t.forEach(function(n){n.defaultValue&&or(e,n.variable.name,n.defaultValue)}),e}let Ie=null;const ga={};let Oh=1;const Ch=()=>class{constructor(){this.id=["slot",Oh++,Date.now(),Math.random().toString(36).slice(2)].join(":")}hasValue(){for(let e=Ie;e;e=e.parent)if(this.id in e.slots){const t=e.slots[this.id];if(t===ga)break;return e!==Ie&&(Ie.slots[this.id]=t),!0}return Ie&&(Ie.slots[this.id]=ga),!1}getValue(){if(this.hasValue())return Ie.slots[this.id]}withValue(e,t,n,i){const s={__proto__:null,[this.id]:e},o=Ie;Ie={parent:o,slots:s};try{return t.apply(i,n)}finally{Ie=o}}static bind(e){const t=Ie;return function(){const n=Ie;try{return Ie=t,e.apply(this,arguments)}finally{Ie=n}}}static noContext(e,t,n){if(Ie){const i=Ie;try{return Ie=null,e.apply(n,t)}finally{Ie=i}}else return e.apply(n,t)}};function va(r){try{return r()}catch{}}const Pi="@wry/context:Slot",ba=va(()=>globalThis)||va(()=>nt)||Object.create(null),$i=ba[Pi]||Array[Pi]||function(r){try{Object.defineProperty(ba,Pi,{value:r,enumerable:!1,writable:!1,configurable:!0})}finally{return r}}(Ch()),$n=new $i,{hasOwnProperty:Rh}=Object.prototype,Li=Array.from||function(r){const e=[];return r.forEach(t=>e.push(t)),e};function Ui(r){const{unsubscribe:e}=r;typeof e=="function"&&(r.unsubscribe=void 0,e())}const zr=[],Nh=100;function lr(r,e){if(!r)throw new Error(e||"assertion failure")}function wa(r,e){const t=r.length;return t>0&&t===e.length&&r[t-1]===e[t-1]}function Ea(r){switch(r.length){case 0:throw new Error("unknown value");case 1:return r[0];case 2:throw r[1]}}function _a(r){return r.slice(0)}class Ln{constructor(e){this.fn=e,this.parents=new Set,this.childValues=new Map,this.dirtyChildren=null,this.dirty=!0,this.recomputing=!1,this.value=[],this.deps=null,++Ln.count}peek(){if(this.value.length===1&&!At(this))return Sa(this),this.value[0]}recompute(e){return lr(!this.recomputing,"already recomputing"),Sa(this),At(this)?Mh(this,e):Ea(this.value)}setDirty(){this.dirty||(this.dirty=!0,ka(this),Ui(this))}dispose(){this.setDirty(),Oa(this),qi(this,(e,t)=>{e.setDirty(),Ca(e,this)})}forget(){this.dispose()}dependOn(e){e.add(this),this.deps||(this.deps=zr.pop()||new Set),this.deps.add(e)}forgetDeps(){this.deps&&(Li(this.deps).forEach(e=>e.delete(this)),this.deps.clear(),zr.push(this.deps),this.deps=null)}}Ln.count=0;function Sa(r){const e=$n.getValue();if(e)return r.parents.add(e),e.childValues.has(r)||e.childValues.set(r,[]),At(r)?xa(e,r):Ia(e,r),e}function Mh(r,e){return Oa(r),$n.withValue(r,Dh,[r,e]),Bh(r,e)&&Fh(r),Ea(r.value)}function Dh(r,e){r.recomputing=!0;const{normalizeResult:t}=r;let n;t&&r.value.length===1&&(n=_a(r.value)),r.value.length=0;try{if(r.value[0]=r.fn.apply(null,e),t&&n&&!wa(n,r.value))try{r.value[0]=t(r.value[0],n[0])}catch{}}catch(i){r.value[1]=i}r.recomputing=!1}function At(r){return r.dirty||!!(r.dirtyChildren&&r.dirtyChildren.size)}function Fh(r){r.dirty=!1,!At(r)&&Ta(r)}function ka(r){qi(r,xa)}function Ta(r){qi(r,Ia)}function qi(r,e){const t=r.parents.size;if(t){const n=Li(r.parents);for(let i=0;i<t;++i)e(n[i],r)}}function xa(r,e){lr(r.childValues.has(e)),lr(At(e));const t=!At(r);if(!r.dirtyChildren)r.dirtyChildren=zr.pop()||new Set;else if(r.dirtyChildren.has(e))return;r.dirtyChildren.add(e),t&&ka(r)}function Ia(r,e){lr(r.childValues.has(e)),lr(!At(e));const t=r.childValues.get(e);t.length===0?r.childValues.set(e,_a(e.value)):wa(t,e.value)||r.setDirty(),Aa(r,e),!At(r)&&Ta(r)}function Aa(r,e){const t=r.dirtyChildren;t&&(t.delete(e),t.size===0&&(zr.length<Nh&&zr.push(t),r.dirtyChildren=null))}function Oa(r){r.childValues.size>0&&r.childValues.forEach((e,t)=>{Ca(r,t)}),r.forgetDeps(),lr(r.dirtyChildren===null)}function Ca(r,e){e.parents.delete(r),r.childValues.delete(e),Aa(r,e)}function Bh(r,e){if(typeof r.subscribe=="function")try{Ui(r),r.unsubscribe=r.subscribe.apply(null,e)}catch{return r.setDirty(),!1}return!0}const Ph={setDirty:!0,dispose:!0,forget:!0};function Ra(r){const e=new Map;function t(n){const i=$n.getValue();if(i){let s=e.get(n);s||e.set(n,s=new Set),i.dependOn(s)}}return t.dirty=function(i,s){const o=e.get(i);if(o){const a=s&&Rh.call(Ph,s)?s:"setDirty";Li(o).forEach(c=>c[a]()),e.delete(i),Ui(o)}},t}let Na;function $h(...r){return(Na||(Na=new dt(typeof WeakMap=="function"))).lookupArray(r)}const ji=new Set;function Kr(r,{max:e=Math.pow(2,16),keyArgs:t,makeCacheKey:n=$h,normalizeResult:i,subscribe:s,cache:o=Ci}=Object.create(null)){const a=typeof o=="function"?new o(e,p=>p.dispose()):o,c=function(){const p=n.apply(null,t?t.apply(null,arguments):arguments);if(p===void 0)return r.apply(null,arguments);let y=a.get(p);y||(a.set(p,y=new Ln(r)),y.normalizeResult=i,y.subscribe=s,y.forget=()=>a.delete(p));const v=y.recompute(Array.prototype.slice.call(arguments));return a.set(p,y),ji.add(a),$n.hasValue()||(ji.forEach(E=>E.clean()),ji.clear()),v};Object.defineProperty(c,"size",{get:()=>a.size,configurable:!1,enumerable:!1}),Object.freeze(c.options={max:e,keyArgs:t,makeCacheKey:n,normalizeResult:i,subscribe:s,cache:a});function l(p){const y=p&&a.get(p);y&&y.setDirty()}c.dirtyKey=l,c.dirty=function(){l(n.apply(null,arguments))};function u(p){const y=p&&a.get(p);if(y)return y.peek()}c.peekKey=u,c.peek=function(){return u(n.apply(null,arguments))};function d(p){return p?a.delete(p):!1}return c.forgetKey=d,c.forget=function(){return d(n.apply(null,arguments))},c.makeCacheKey=n,c.getKey=t?function(){return n.apply(null,t.apply(null,arguments))}:n,Object.freeze(c)}function Lh(r){return r}var Ma=function(){function r(e,t){t===void 0&&(t=Object.create(null)),this.resultCache=Oi?new WeakSet:new Set,this.transform=e,t.getCacheKey&&(this.getCacheKey=t.getCacheKey),this.cached=t.cache!==!1,this.resetCache()}return r.prototype.getCacheKey=function(e){return[e]},r.identity=function(){return new r(Lh,{cache:!1})},r.split=function(e,t,n){return n===void 0&&(n=r.identity()),Object.assign(new r(function(i){var s=e(i)?t:n;return s.transformDocument(i)},{cache:!1}),{left:t,right:n})},r.prototype.resetCache=function(){var e=this;if(this.cached){var t=new dt(jt);this.performWork=Kr(r.prototype.performWork.bind(this),{makeCacheKey:function(n){var i=e.getCacheKey(n);if(i)return $(Array.isArray(i),77),t.lookupArray(i)},max:yt["documentTransform.cache"],cache:Bn})}},r.prototype.performWork=function(e){return ar(e),this.transform(e)},r.prototype.transformDocument=function(e){if(this.resultCache.has(e))return e;var t=this.performWork(e);return this.resultCache.add(t),t},r.prototype.concat=function(e){var t=this;return Object.assign(new r(function(n){return e.transformDocument(t.transformDocument(n))},{cache:!1}),{left:this,right:e})},r}(),Gr,Ot=Object.assign(function(r){var e=Gr.get(r);return e||(e=na(r),Gr.set(r,e)),e},{reset:function(){Gr=new ca(yt.print||2e3)}});Ot.reset(),globalThis.__DEV__!==!1&&la("print",function(){return Gr?Gr.size:0});var fe=Array.isArray;function ot(r){return Array.isArray(r)&&r.length>0}var Da={kind:D.FIELD,name:{kind:D.NAME,value:"__typename"}};function Fa(r,e){return!r||r.selectionSet.selections.every(function(t){return t.kind===D.FRAGMENT_SPREAD&&Fa(e[t.name.value],e)})}function Uh(r){return Fa(Qt(r)||ma(r),nr(ur(r)))?null:r}function qh(r){var e=new Map,t=new Map;return r.forEach(function(n){n&&(n.name?e.set(n.name,n):n.test&&t.set(n.test,n))}),function(n){var i=e.get(n.name.value);return!i&&t.size&&t.forEach(function(s,o){o(n)&&(i=s)}),i}}function Ba(r){var e=new Map;return function(n){n===void 0&&(n=r);var i=e.get(n);return i||e.set(n,i={variables:new Set,fragmentSpreads:new Set}),i}}function Pa(r,e){ar(e);for(var t=Ba(""),n=Ba(""),i=function(b){for(var k=0,S=void 0;k<b.length&&(S=b[k]);++k)if(!fe(S)){if(S.kind===D.OPERATION_DEFINITION)return t(S.name&&S.name.value);if(S.kind===D.FRAGMENT_DEFINITION)return n(S.name.value)}return globalThis.__DEV__!==!1&&$.error(97),null},s=0,o=e.definitions.length-1;o>=0;--o)e.definitions[o].kind===D.OPERATION_DEFINITION&&++s;var a=qh(r),c=function(b){return ot(b)&&b.map(a).some(function(k){return k&&k.remove})},l=new Map,u=!1,d={enter:function(b){if(c(b.directives))return u=!0,null}},p=Je(e,{Field:d,InlineFragment:d,VariableDefinition:{enter:function(){return!1}},Variable:{enter:function(b,k,S,I,O){var C=i(O);C&&C.variables.add(b.name.value)}},FragmentSpread:{enter:function(b,k,S,I,O){if(c(b.directives))return u=!0,null;var C=i(O);C&&C.fragmentSpreads.add(b.name.value)}},FragmentDefinition:{enter:function(b,k,S,I){l.set(JSON.stringify(I),b)},leave:function(b,k,S,I){var O=l.get(JSON.stringify(I));if(b===O)return b;if(s>0&&b.selectionSet.selections.every(function(C){return C.kind===D.FIELD&&C.name.value==="__typename"}))return n(b.name.value).removed=!0,u=!0,null}},Directive:{leave:function(b){if(a(b))return u=!0,null}}});if(!u)return e;var y=function(b){return b.transitiveVars||(b.transitiveVars=new Set(b.variables),b.removed||b.fragmentSpreads.forEach(function(k){y(n(k)).transitiveVars.forEach(function(S){b.transitiveVars.add(S)})})),b},v=new Set;p.definitions.forEach(function(b){b.kind===D.OPERATION_DEFINITION?y(t(b.name&&b.name.value)).fragmentSpreads.forEach(function(k){v.add(k)}):b.kind===D.FRAGMENT_DEFINITION&&s===0&&!n(b.name.value).removed&&v.add(b.name.value)}),v.forEach(function(b){y(n(b)).fragmentSpreads.forEach(function(k){v.add(k)})});var E=function(b){return!!(!v.has(b)||n(b).removed)},w={enter:function(b){if(E(b.name.value))return null}};return Uh(Je(p,{FragmentSpread:w,FragmentDefinition:w,OperationDefinition:{leave:function(b){if(b.variableDefinitions){var k=y(t(b.name&&b.name.value)).transitiveVars;if(k.size<b.variableDefinitions.length)return T(T({},b),{variableDefinitions:b.variableDefinitions.filter(function(S){return k.has(S.variable.name.value)})})}}}}))}var Vi=Object.assign(function(r){return Je(r,{SelectionSet:{enter:function(e,t,n){if(!(n&&n.kind===D.OPERATION_DEFINITION)){var i=e.selections;if(i){var s=i.some(function(a){return It(a)&&(a.name.value==="__typename"||a.name.value.lastIndexOf("__",0)===0)});if(!s){var o=n;if(!(It(o)&&o.directives&&o.directives.some(function(a){return a.name.value==="export"})))return T(T({},e),{selections:Re(Re([],i,!0),[Da],!1)})}}}}}})},{added:function(r){return r===Da}});function jh(r){var e=cr(r),t=e.operation;if(t==="query")return r;var n=Je(r,{OperationDefinition:{enter:function(i){return T(T({},i),{operation:"query"})}}});return n}function $a(r){ar(r);var e=Pa([{test:function(t){return t.name.value==="client"},remove:!0}],r);return e}function Vh(r){return ar(r),Je(r,{FragmentSpread:function(e){var t;if(!(!((t=e.directives)===null||t===void 0)&&t.some(function(n){return n.name.value==="unmask"})))return T(T({},e),{directives:Re(Re([],e.directives||[],!0),[{kind:D.DIRECTIVE,name:{kind:D.NAME,value:"nonreactive"}}],!1)})}})}var Qh=Object.prototype.hasOwnProperty;function La(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Un(r)}function Un(r){var e=r[0]||{},t=r.length;if(t>1)for(var n=new Ct,i=1;i<t;++i)e=n.merge(e,r[i]);return e}var Hh=function(r,e,t){return this.merge(r[t],e[t])},Ct=function(){function r(e){e===void 0&&(e=Hh),this.reconciler=e,this.isObject=ue,this.pastCopies=new Set}return r.prototype.merge=function(e,t){for(var n=this,i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];return ue(t)&&ue(e)?(Object.keys(t).forEach(function(o){if(Qh.call(e,o)){var a=e[o];if(t[o]!==a){var c=n.reconciler.apply(n,Re([e,t,o],i,!1));c!==a&&(e=n.shallowCopyForMerge(e),e[o]=c)}}else e=n.shallowCopyForMerge(e),e[o]=t[o]}),e):t},r.prototype.shallowCopyForMerge=function(e){return ue(e)&&(this.pastCopies.has(e)||(Array.isArray(e)?e=e.slice(0):e=T({__proto__:Object.getPrototypeOf(e)},e),this.pastCopies.add(e))),e},r}();function Wh(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=zh(r))||e){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zh(r,e){if(r){if(typeof r=="string")return Ua(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ua(r,e)}}function Ua(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function qa(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Qi(r,e,t){return e&&qa(r.prototype,e),t&&qa(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}var Hi=function(){return typeof Symbol=="function"},Wi=function(r){return Hi()&&!!Symbol[r]},zi=function(r){return Wi(r)?Symbol[r]:"@@"+r};Hi()&&!Wi("observable")&&(Symbol.observable=Symbol("observable"));var Kh=zi("iterator"),Ki=zi("observable"),ja=zi("species");function qn(r,e){var t=r[e];if(t!=null){if(typeof t!="function")throw new TypeError(t+" is not a function");return t}}function Jr(r){var e=r.constructor;return e!==void 0&&(e=e[ja],e===null&&(e=void 0)),e!==void 0?e:Z}function Gh(r){return r instanceof Z}function fr(r){fr.log?fr.log(r):setTimeout(function(){throw r})}function jn(r){Promise.resolve().then(function(){try{r()}catch(e){fr(e)}})}function Va(r){var e=r._cleanup;if(e!==void 0&&(r._cleanup=void 0,!!e))try{if(typeof e=="function")e();else{var t=qn(e,"unsubscribe");t&&t.call(e)}}catch(n){fr(n)}}function Gi(r){r._observer=void 0,r._queue=void 0,r._state="closed"}function Jh(r){var e=r._queue;if(e){r._queue=void 0,r._state="ready";for(var t=0;t<e.length&&(Qa(r,e[t].type,e[t].value),r._state!=="closed");++t);}}function Qa(r,e,t){r._state="running";var n=r._observer;try{var i=qn(n,e);switch(e){case"next":i&&i.call(n,t);break;case"error":if(Gi(r),i)i.call(n,t);else throw t;break;case"complete":Gi(r),i&&i.call(n);break}}catch(s){fr(s)}r._state==="closed"?Va(r):r._state==="running"&&(r._state="ready")}function Ji(r,e,t){if(r._state!=="closed"){if(r._state==="buffering"){r._queue.push({type:e,value:t});return}if(r._state!=="ready"){r._state="buffering",r._queue=[{type:e,value:t}],jn(function(){return Jh(r)});return}Qa(r,e,t)}}var Yh=function(){function r(t,n){this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";var i=new Xh(this);try{this._cleanup=n.call(void 0,i)}catch(s){i.error(s)}this._state==="initializing"&&(this._state="ready")}var e=r.prototype;return e.unsubscribe=function(){this._state!=="closed"&&(Gi(this),Va(this))},Qi(r,[{key:"closed",get:function(){return this._state==="closed"}}]),r}(),Xh=function(){function r(t){this._subscription=t}var e=r.prototype;return e.next=function(n){Ji(this._subscription,"next",n)},e.error=function(n){Ji(this._subscription,"error",n)},e.complete=function(){Ji(this._subscription,"complete")},Qi(r,[{key:"closed",get:function(){return this._subscription._state==="closed"}}]),r}(),Z=function(){function r(t){if(!(this instanceof r))throw new TypeError("Observable cannot be called as a function");if(typeof t!="function")throw new TypeError("Observable initializer must be a function");this._subscriber=t}var e=r.prototype;return e.subscribe=function(n){return(typeof n!="object"||n===null)&&(n={next:n,error:arguments[1],complete:arguments[2]}),new Yh(n,this._subscriber)},e.forEach=function(n){var i=this;return new Promise(function(s,o){if(typeof n!="function"){o(new TypeError(n+" is not a function"));return}function a(){c.unsubscribe(),s()}var c=i.subscribe({next:function(l){try{n(l,a)}catch(u){o(u),c.unsubscribe()}},error:o,complete:s})})},e.map=function(n){var i=this;if(typeof n!="function")throw new TypeError(n+" is not a function");var s=Jr(this);return new s(function(o){return i.subscribe({next:function(a){try{a=n(a)}catch(c){return o.error(c)}o.next(a)},error:function(a){o.error(a)},complete:function(){o.complete()}})})},e.filter=function(n){var i=this;if(typeof n!="function")throw new TypeError(n+" is not a function");var s=Jr(this);return new s(function(o){return i.subscribe({next:function(a){try{if(!n(a))return}catch(c){return o.error(c)}o.next(a)},error:function(a){o.error(a)},complete:function(){o.complete()}})})},e.reduce=function(n){var i=this;if(typeof n!="function")throw new TypeError(n+" is not a function");var s=Jr(this),o=arguments.length>1,a=!1,c=arguments[1],l=c;return new s(function(u){return i.subscribe({next:function(d){var p=!a;if(a=!0,!p||o)try{l=n(l,d)}catch(y){return u.error(y)}else l=d},error:function(d){u.error(d)},complete:function(){if(!a&&!o)return u.error(new TypeError("Cannot reduce an empty sequence"));u.next(l),u.complete()}})})},e.concat=function(){for(var n=this,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];var a=Jr(this);return new a(function(c){var l,u=0;function d(p){l=p.subscribe({next:function(y){c.next(y)},error:function(y){c.error(y)},complete:function(){u===s.length?(l=void 0,c.complete()):d(a.from(s[u++]))}})}return d(n),function(){l&&(l.unsubscribe(),l=void 0)}})},e.flatMap=function(n){var i=this;if(typeof n!="function")throw new TypeError(n+" is not a function");var s=Jr(this);return new s(function(o){var a=[],c=i.subscribe({next:function(u){if(n)try{u=n(u)}catch(p){return o.error(p)}var d=s.from(u).subscribe({next:function(p){o.next(p)},error:function(p){o.error(p)},complete:function(){var p=a.indexOf(d);p>=0&&a.splice(p,1),l()}});a.push(d)},error:function(u){o.error(u)},complete:function(){l()}});function l(){c.closed&&a.length===0&&o.complete()}return function(){a.forEach(function(u){return u.unsubscribe()}),c.unsubscribe()}})},e[Ki]=function(){return this},r.from=function(n){var i=typeof this=="function"?this:r;if(n==null)throw new TypeError(n+" is not an object");var s=qn(n,Ki);if(s){var o=s.call(n);if(Object(o)!==o)throw new TypeError(o+" is not an object");return Gh(o)&&o.constructor===i?o:new i(function(a){return o.subscribe(a)})}if(Wi("iterator")&&(s=qn(n,Kh),s))return new i(function(a){jn(function(){if(!a.closed){for(var c=Wh(s.call(n)),l;!(l=c()).done;){var u=l.value;if(a.next(u),a.closed)return}a.complete()}})});if(Array.isArray(n))return new i(function(a){jn(function(){if(!a.closed){for(var c=0;c<n.length;++c)if(a.next(n[c]),a.closed)return;a.complete()}})});throw new TypeError(n+" is not observable")},r.of=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];var o=typeof this=="function"?this:r;return new o(function(a){jn(function(){if(!a.closed){for(var c=0;c<i.length;++c)if(a.next(i[c]),a.closed)return;a.complete()}})})},Qi(r,null,[{key:ja,get:function(){return this}}]),r}();Hi()&&Object.defineProperty(Z,Symbol("extensions"),{value:{symbol:Ki,hostReportError:fr},configurable:!0});function Zh(r){var e,t=r.Symbol;if(typeof t=="function")if(t.observable)e=t.observable;else{typeof t.for=="function"?e=t.for("https://github.com/benlesh/symbol-observable"):e=t("https://github.com/benlesh/symbol-observable");try{t.observable=e}catch{}}else e="@@observable";return e}var hr;typeof self<"u"?hr=self:typeof window<"u"?hr=window:typeof nt<"u"?hr=nt:typeof module<"u"?hr=module:hr=Function("return this")(),Zh(hr);var Ha=Z.prototype,Wa="@@observable";Ha[Wa]||(Ha[Wa]=function(){return this});function ep(r){return r.catch(function(){}),r}var tp=Object.prototype.toString;function za(r){return Yi(r)}function Yi(r,e){switch(tp.call(r)){case"[object Array]":{if(e=e||new Map,e.has(r))return e.get(r);var t=r.slice(0);return e.set(r,t),t.forEach(function(i,s){t[s]=Yi(i,e)}),t}case"[object Object]":{if(e=e||new Map,e.has(r))return e.get(r);var n=Object.create(Object.getPrototypeOf(r));return e.set(r,n),Object.keys(r).forEach(function(i){n[i]=Yi(r[i],e)}),n}default:return r}}function rp(r){var e=new Set([r]);return e.forEach(function(t){ue(t)&&np(t)===t&&Object.getOwnPropertyNames(t).forEach(function(n){ue(t[n])&&e.add(t[n])})}),r}function np(r){if(globalThis.__DEV__!==!1&&!Object.isFrozen(r))try{Object.freeze(r)}catch(e){if(e instanceof TypeError)return null;throw e}return r}function Vn(r){return globalThis.__DEV__!==!1&&rp(r),r}function Yr(r,e,t){var n=[];r.forEach(function(i){return i[e]&&n.push(i)}),n.forEach(function(i){return i[e](t)})}function Xi(r,e,t){return new Z(function(n){var i={then:function(c){return new Promise(function(l){return l(c())})}};function s(c,l){return function(u){if(c){var d=function(){return n.closed?0:c(u)};i=i.then(d,d).then(function(p){return n.next(p)},function(p){return n.error(p)})}else n[l](u)}}var o={next:s(e,"next"),error:s(t,"error"),complete:function(){i.then(function(){return n.complete()})}},a=r.subscribe(o);return function(){return a.unsubscribe()}})}function Ka(r){function e(t){Object.defineProperty(r,t,{value:Z})}return aa&&Symbol.species&&e(Symbol.species),e("@@species"),r}function Ga(r){return r&&typeof r.then=="function"}var pr=function(r){He(e,r);function e(t){var n=r.call(this,function(i){return n.addObserver(i),function(){return n.removeObserver(i)}})||this;return n.observers=new Set,n.promise=new Promise(function(i,s){n.resolve=i,n.reject=s}),n.handlers={next:function(i){n.sub!==null&&(n.latest=["next",i],n.notify("next",i),Yr(n.observers,"next",i))},error:function(i){var s=n.sub;s!==null&&(s&&setTimeout(function(){return s.unsubscribe()}),n.sub=null,n.latest=["error",i],n.reject(i),n.notify("error",i),Yr(n.observers,"error",i))},complete:function(){var i=n,s=i.sub,o=i.sources,a=o===void 0?[]:o;if(s!==null){var c=a.shift();c?Ga(c)?c.then(function(l){return n.sub=l.subscribe(n.handlers)},n.handlers.error):n.sub=c.subscribe(n.handlers):(s&&setTimeout(function(){return s.unsubscribe()}),n.sub=null,n.latest&&n.latest[0]==="next"?n.resolve(n.latest[1]):n.resolve(),n.notify("complete"),Yr(n.observers,"complete"))}}},n.nextResultListeners=new Set,n.cancel=function(i){n.reject(i),n.sources=[],n.handlers.error(i)},n.promise.catch(function(i){}),typeof t=="function"&&(t=[new Z(t)]),Ga(t)?t.then(function(i){return n.start(i)},n.handlers.error):n.start(t),n}return e.prototype.start=function(t){this.sub===void 0&&(this.sources=Array.from(t),this.handlers.complete())},e.prototype.deliverLastMessage=function(t){if(this.latest){var n=this.latest[0],i=t[n];i&&i.call(t,this.latest[1]),this.sub===null&&n==="next"&&t.complete&&t.complete()}},e.prototype.addObserver=function(t){this.observers.has(t)||(this.deliverLastMessage(t),this.observers.add(t))},e.prototype.removeObserver=function(t){this.observers.delete(t)&&this.observers.size<1&&this.handlers.complete()},e.prototype.notify=function(t,n){var i=this.nextResultListeners;i.size&&(this.nextResultListeners=new Set,i.forEach(function(s){return s(t,n)}))},e.prototype.beforeNext=function(t){var n=!1;this.nextResultListeners.add(function(i,s){n||(n=!0,t(i,s))})},e}(Z);Ka(pr);function dr(r){return"incremental"in r}function ip(r){return"hasNext"in r&&"data"in r}function sp(r){return dr(r)||ip(r)}function op(r){return ue(r)&&"payload"in r}function Ja(r,e){var t=r,n=new Ct;return dr(e)&&ot(e.incremental)&&e.incremental.forEach(function(i){for(var s=i.data,o=i.path,a=o.length-1;a>=0;--a){var c=o[a],l=!isNaN(+c),u=l?[]:{};u[c]=s,s=u}t=n.merge(t,s)}),t}function Qn(r){var e=Zi(r);return ot(e)}function Zi(r){var e=ot(r.errors)?r.errors.slice(0):[];return dr(r)&&ot(r.incremental)&&r.incremental.forEach(function(t){t.errors&&e.push.apply(e,t.errors)}),e}function yr(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Object.create(null);return r.forEach(function(n){n&&Object.keys(n).forEach(function(i){var s=n[i];s!==void 0&&(t[i]=s)})}),t}function es(r,e){return yr(r,e,e.variables&&{variables:yr(T(T({},r&&r.variables),e.variables))})}function ts(r){return new Z(function(e){e.error(r)})}var Ya=function(r,e,t){var n=new Error(t);throw n.name="ServerError",n.response=r,n.statusCode=r.status,n.result=e,n};function ap(r){for(var e=["query","operationName","variables","extensions","context"],t=0,n=Object.keys(r);t<n.length;t++){var i=n[t];if(e.indexOf(i)<0)throw Fe(46,i)}return r}function up(r,e){var t=T({},r),n=function(s){typeof s=="function"?t=T(T({},t),s(t)):t=T(T({},t),s)},i=function(){return T({},t)};return Object.defineProperty(e,"setContext",{enumerable:!1,value:n}),Object.defineProperty(e,"getContext",{enumerable:!1,value:i}),e}function cp(r){var e={variables:r.variables||{},extensions:r.extensions||{},operationName:r.operationName,query:r.query};return e.operationName||(e.operationName=typeof e.query!="string"?Wr(e.query)||void 0:""),e}function lp(r,e){var t=T({},r),n=new Set(Object.keys(r));return Je(e,{Variable:function(i,s,o){o&&o.kind!=="VariableDefinition"&&n.delete(i.name.value)}}),n.forEach(function(i){delete t[i]}),t}function Xa(r,e){return e?e(r):Z.of()}function Xr(r){return typeof r=="function"?new We(r):r}function Hn(r){return r.request.length<=1}var We=function(){function r(e){e&&(this.request=e)}return r.empty=function(){return new r(function(){return Z.of()})},r.from=function(e){return e.length===0?r.empty():e.map(Xr).reduce(function(t,n){return t.concat(n)})},r.split=function(e,t,n){var i=Xr(t),s=Xr(n||new r(Xa)),o;return Hn(i)&&Hn(s)?o=new r(function(a){return e(a)?i.request(a)||Z.of():s.request(a)||Z.of()}):o=new r(function(a,c){return e(a)?i.request(a,c)||Z.of():s.request(a,c)||Z.of()}),Object.assign(o,{left:i,right:s})},r.execute=function(e,t){return e.request(up(t.context,cp(ap(t))))||Z.of()},r.concat=function(e,t){var n=Xr(e);if(Hn(n))return globalThis.__DEV__!==!1&&$.warn(38,n),n;var i=Xr(t),s;return Hn(i)?s=new r(function(o){return n.request(o,function(a){return i.request(a)||Z.of()})||Z.of()}):s=new r(function(o,a){return n.request(o,function(c){return i.request(c,a)||Z.of()})||Z.of()}),Object.assign(s,{left:n,right:i})},r.prototype.split=function(e,t,n){return this.concat(r.split(e,t,n||new r(Xa)))},r.prototype.concat=function(e){return r.concat(this,e)},r.prototype.request=function(e,t){throw Fe(39)},r.prototype.onError=function(e,t){if(t&&t.error)return t.error(e),!1;throw e},r.prototype.setOnError=function(e){return this.onError=e,this},r}(),Za=We.from,fp=We.split,rs=We.execute;function hp(r){var e,t=r[Symbol.asyncIterator]();return e={next:function(){return t.next()}},e[Symbol.asyncIterator]=function(){return this},e}function pp(r){var e=null,t=null,n=!1,i=[],s=[];function o(d){if(!t){if(s.length){var p=s.shift();if(Array.isArray(p)&&p[0])return p[0]({value:d,done:!1})}i.push(d)}}function a(d){t=d;var p=s.slice();p.forEach(function(y){y[1](d)}),!e||e()}function c(){n=!0;var d=s.slice();d.forEach(function(p){p[0]({value:void 0,done:!0})}),!e||e()}e=function(){e=null,r.removeListener("data",o),r.removeListener("error",a),r.removeListener("end",c),r.removeListener("finish",c),r.removeListener("close",c)},r.on("data",o),r.on("error",a),r.on("end",c),r.on("finish",c),r.on("close",c);function l(){return new Promise(function(d,p){if(t)return p(t);if(i.length)return d({value:i.shift(),done:!1});if(n)return d({value:void 0,done:!0});s.push([d,p])})}var u={next:function(){return l()}};return Dn&&(u[Symbol.asyncIterator]=function(){return this}),u}function dp(r){var e=!1,t={next:function(){return e?Promise.resolve({value:void 0,done:!0}):(e=!0,new Promise(function(n,i){r.then(function(s){n({value:s,done:!1})}).catch(i)}))}};return Dn&&(t[Symbol.asyncIterator]=function(){return this}),t}function eu(r){var e={next:function(){return r.read()}};return Dn&&(e[Symbol.asyncIterator]=function(){return this}),e}function yp(r){return!!r.body}function mp(r){return!!r.getReader}function gp(r){return!!(Dn&&r[Symbol.asyncIterator])}function vp(r){return!!r.stream}function bp(r){return!!r.arrayBuffer}function wp(r){return!!r.pipe}function Ep(r){var e=r;if(yp(r)&&(e=r.body),gp(e))return hp(e);if(mp(e))return eu(e.getReader());if(vp(e))return eu(e.stream().getReader());if(bp(e))return dp(e.arrayBuffer());if(wp(e))return pp(e);throw new Error("Unknown body type for responseIterator. Please pass a streamable response.")}var ns=Symbol();function _p(r){return r.extensions?Array.isArray(r.extensions[ns]):!1}function tu(r){return r.hasOwnProperty("graphQLErrors")}var Sp=function(r){var e=Re(Re(Re([],r.graphQLErrors,!0),r.clientErrors,!0),r.protocolErrors,!0);return r.networkError&&e.push(r.networkError),e.map(function(t){return ue(t)&&t.message||"Error message not found."}).join(`
`)},Rt=function(r){He(e,r);function e(t){var n=t.graphQLErrors,i=t.protocolErrors,s=t.clientErrors,o=t.networkError,a=t.errorMessage,c=t.extraInfo,l=r.call(this,a)||this;return l.name="ApolloError",l.graphQLErrors=n||[],l.protocolErrors=i||[],l.clientErrors=s||[],l.networkError=o||null,l.message=a||Sp(l),l.extraInfo=c,l.cause=Re(Re(Re([o],n||[],!0),i||[],!0),s||[],!0).find(function(u){return!!u})||null,l.__proto__=e.prototype,l}return e}(Error),ru=Object.prototype.hasOwnProperty;function kp(r,e){return St(this,void 0,void 0,function(){var t,n,i,s,o,a,c,l,u,d,p,y,v,E,w,b,k,S,I,O,C,M,F,L;return kt(this,function(V){switch(V.label){case 0:if(TextDecoder===void 0)throw new Error("TextDecoder must be defined in the environment: please import a polyfill.");t=new TextDecoder("utf-8"),n=(L=r.headers)===null||L===void 0?void 0:L.get("content-type"),i="boundary=",s=n?.includes(i)?n?.substring(n?.indexOf(i)+i.length).replace(/['"]/g,"").replace(/\;(.*)/gm,"").trim():"-",o=`\r
--`.concat(s),a="",c=Ep(r),l=!0,V.label=1;case 1:return l?[4,c.next()]:[3,3];case 2:for(u=V.sent(),d=u.value,p=u.done,y=typeof d=="string"?d:t.decode(d),v=a.length-o.length+1,l=!p,a+=y,E=a.indexOf(o,v);E>-1;){if(w=void 0,M=[a.slice(0,E),a.slice(E+o.length)],w=M[0],a=M[1],b=w.indexOf(`\r
\r
`),k=Tp(w.slice(0,b)),S=k["content-type"],S&&S.toLowerCase().indexOf("application/json")===-1)throw new Error("Unsupported patch content type: application/json is required.");if(I=w.slice(b),I){if(O=nu(r,I),Object.keys(O).length>1||"data"in O||"incremental"in O||"errors"in O||"payload"in O)if(op(O)){if(C={},"payload"in O){if(Object.keys(O).length===1&&O.payload===null)return[2];C=T({},O.payload)}"errors"in O&&(C=T(T({},C),{extensions:T(T({},"extensions"in C?C.extensions:null),(F={},F[ns]=O.errors,F))})),e(C)}else e(O);else if(Object.keys(O).length===1&&"hasNext"in O&&!O.hasNext)return[2]}E=a.indexOf(o)}return[3,1];case 3:return[2]}})})}function Tp(r){var e={};return r.split(`
`).forEach(function(t){var n=t.indexOf(":");if(n>-1){var i=t.slice(0,n).trim().toLowerCase(),s=t.slice(n+1).trim();e[i]=s}}),e}function nu(r,e){if(r.status>=300){var t=function(){try{return JSON.parse(e)}catch{return e}};Ya(r,t(),"Response not successful: Received status code ".concat(r.status))}try{return JSON.parse(e)}catch(i){var n=i;throw n.name="ServerParseError",n.response=r,n.statusCode=r.status,n.bodyText=e,n}}function xp(r,e){r.result&&r.result.errors&&r.result.data&&e.next(r.result),e.error(r)}function Ip(r){return function(e){return e.text().then(function(t){return nu(e,t)}).then(function(t){return!Array.isArray(t)&&!ru.call(t,"data")&&!ru.call(t,"errors")&&Ya(e,t,"Server response was missing for query '".concat(Array.isArray(r)?r.map(function(n){return n.operationName}):r.operationName,"'.")),t})}}var is=function(r,e){var t;try{t=JSON.stringify(r)}catch(i){var n=Fe(42,e,i.message);throw n.parseError=i,n}return t},Ap={includeQuery:!0,includeExtensions:!1,preserveHeaderCase:!1},Op={accept:"*/*","content-type":"application/json"},Cp={method:"POST"},Rp={http:Ap,headers:Op,options:Cp},Np=function(r,e){return e(r)};function Mp(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var i={},s={};t.forEach(function(d){i=T(T(T({},i),d.options),{headers:T(T({},i.headers),d.headers)}),d.credentials&&(i.credentials=d.credentials),s=T(T({},s),d.http)}),i.headers&&(i.headers=Dp(i.headers,s.preserveHeaderCase));var o=r.operationName,a=r.extensions,c=r.variables,l=r.query,u={operationName:o,variables:c};return s.includeExtensions&&(u.extensions=a),s.includeQuery&&(u.query=e(l,Ot)),{options:i,body:u}}function Dp(r,e){if(!e){var t={};return Object.keys(Object(r)).forEach(function(s){t[s.toLowerCase()]=r[s]}),t}var n={};Object.keys(Object(r)).forEach(function(s){n[s.toLowerCase()]={originalName:s,value:r[s]}});var i={};return Object.keys(n).forEach(function(s){i[n[s].originalName]=n[s].value}),i}var Fp=function(r){if(!r&&typeof fetch>"u")throw Fe(40)},Bp=function(r,e){var t=r.getContext(),n=t.uri;return n||(typeof e=="function"?e(r):e||"/graphql")};function Pp(r,e){var t=[],n=function(d,p){t.push("".concat(d,"=").concat(encodeURIComponent(p)))};if("query"in e&&n("query",e.query),e.operationName&&n("operationName",e.operationName),e.variables){var i=void 0;try{i=is(e.variables,"Variables map")}catch(d){return{parseError:d}}n("variables",i)}if(e.extensions){var s=void 0;try{s=is(e.extensions,"Extensions map")}catch(d){return{parseError:d}}n("extensions",s)}var o="",a=r,c=r.indexOf("#");c!==-1&&(o=r.substr(c),a=r.substr(0,c));var l=a.indexOf("?")===-1?"?":"&",u=a+l+t.join("&")+o;return{newURI:u}}var iu=Ge(function(){return fetch}),su=function(r){r===void 0&&(r={});var e=r.uri,t=e===void 0?"/graphql":e,n=r.fetch,i=r.print,s=i===void 0?Np:i,o=r.includeExtensions,a=r.preserveHeaderCase,c=r.useGETForQueries,l=r.includeUnusedVariables,u=l===void 0?!1:l,d=st(r,["uri","fetch","print","includeExtensions","preserveHeaderCase","useGETForQueries","includeUnusedVariables"]);globalThis.__DEV__!==!1&&Fp(n||iu);var p={http:{includeExtensions:o,preserveHeaderCase:a},options:d.fetchOptions,credentials:d.credentials,headers:d.headers};return new We(function(y){var v=Bp(y,t),E=y.getContext(),w={};if(E.clientAwareness){var b=E.clientAwareness,k=b.name,S=b.version;k&&(w["apollographql-client-name"]=k),S&&(w["apollographql-client-version"]=S)}var I=T(T({},w),E.headers),O={http:E.http,options:E.fetchOptions,credentials:E.credentials,headers:I};if(Qr(["client"],y.query)){var C=$a(y.query);if(!C)return ts(new Error("HttpLink: Trying to send a client-only query to the server. To send to the server, ensure a non-client field is added to the query or set the `transformOptions.removeClientFields` option to `true`."));y.query=C}var M=Mp(y,s,Rp,p,O),F=M.options,L=M.body;L.variables&&!u&&(L.variables=lp(L.variables,y.query));var V;!F.signal&&typeof AbortController<"u"&&(V=new AbortController,F.signal=V.signal);var G=function(H){return H.kind==="OperationDefinition"&&H.operation==="mutation"},Se=function(H){return H.kind==="OperationDefinition"&&H.operation==="subscription"},se=Se(cr(y.query)),ke=Qr(["defer"],y.query);if(c&&!y.query.definitions.some(G)&&(F.method="GET"),ke||se){F.headers=F.headers||{};var j="multipart/mixed;";se&&ke&&globalThis.__DEV__!==!1&&$.warn(41),se?j+="boundary=graphql;subscriptionSpec=1.0,application/json":ke&&(j+="deferSpec=20220824,application/json"),F.headers.accept=j}if(F.method==="GET"){var ee=Pp(v,L),q=ee.newURI,W=ee.parseError;if(W)return ts(W);v=q}else try{F.body=is(L,"Payload")}catch(H){return ts(H)}return new Z(function(H){var Te=n||Ge(function(){return fetch})||iu,J=H.next.bind(H);return Te(v,F).then(function(Ae){var Ze;y.setContext({response:Ae});var oe=(Ze=Ae.headers)===null||Ze===void 0?void 0:Ze.get("content-type");return oe!==null&&/^multipart\/mixed/i.test(oe)?kp(Ae,J):Ip(y)(Ae).then(J)}).then(function(){V=void 0,H.complete()}).catch(function(Ae){V=void 0,xp(Ae,H)}),function(){V&&V.abort()}})})},$p=function(r){He(e,r);function e(t){t===void 0&&(t={});var n=r.call(this,su(t).request)||this;return n.options=t,n}return e}(We);const{toString:ou,hasOwnProperty:Lp}=Object.prototype,au=Function.prototype.toString,ss=new Map;function ie(r,e){try{return os(r,e)}finally{ss.clear()}}function os(r,e){if(r===e)return!0;const t=ou.call(r),n=ou.call(e);if(t!==n)return!1;switch(t){case"[object Array]":if(r.length!==e.length)return!1;case"[object Object]":{if(cu(r,e))return!0;const i=uu(r),s=uu(e),o=i.length;if(o!==s.length)return!1;for(let a=0;a<o;++a)if(!Lp.call(e,i[a]))return!1;for(let a=0;a<o;++a){const c=i[a];if(!os(r[c],e[c]))return!1}return!0}case"[object Error]":return r.name===e.name&&r.message===e.message;case"[object Number]":if(r!==r)return e!==e;case"[object Boolean]":case"[object Date]":return+r==+e;case"[object RegExp]":case"[object String]":return r==`${e}`;case"[object Map]":case"[object Set]":{if(r.size!==e.size)return!1;if(cu(r,e))return!0;const i=r.entries(),s=t==="[object Map]";for(;;){const o=i.next();if(o.done)break;const[a,c]=o.value;if(!e.has(a)||s&&!os(c,e.get(a)))return!1}return!0}case"[object Uint16Array]":case"[object Uint8Array]":case"[object Uint32Array]":case"[object Int32Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object ArrayBuffer]":r=new Uint8Array(r),e=new Uint8Array(e);case"[object DataView]":{let i=r.byteLength;if(i===e.byteLength)for(;i--&&r[i]===e[i];);return i===-1}case"[object AsyncFunction]":case"[object GeneratorFunction]":case"[object AsyncGeneratorFunction]":case"[object Function]":{const i=au.call(r);return i!==au.call(e)?!1:!jp(i,qp)}}return!1}function uu(r){return Object.keys(r).filter(Up,r)}function Up(r){return this[r]!==void 0}const qp="{ [native code] }";function jp(r,e){const t=r.length-e.length;return t>=0&&r.indexOf(e,t)===t}function cu(r,e){let t=ss.get(r);if(t){if(t.has(e))return!0}else ss.set(r,t=new Set);return t.add(e),!1}function lu(r,e,t,n){var i=e.data,s=st(e,["data"]),o=t.data,a=st(t,["data"]);return ie(s,a)&&Wn(cr(r).selectionSet,i,o,{fragmentMap:nr(ur(r)),variables:n})}function Wn(r,e,t,n){if(e===t)return!0;var i=new Set;return r.selections.every(function(s){if(i.has(s)||(i.add(s),!Vr(s,n.variables))||fu(s))return!0;if(It(s)){var o=mt(s),a=e&&e[o],c=t&&t[o],l=s.selectionSet;if(!l)return ie(a,c);var u=Array.isArray(a),d=Array.isArray(c);if(u!==d)return!1;if(u&&d){var p=a.length;if(c.length!==p)return!1;for(var y=0;y<p;++y)if(!Wn(l,a[y],c[y],n))return!1;return!0}return Wn(l,a,c,n)}else{var v=Fn(s,n.fragmentMap);if(v)return fu(v)?!0:Wn(v.selectionSet,e,t,n)}})}function fu(r){return!!r.directives&&r.directives.some(Vp)}function Vp(r){return r.name.value==="nonreactive"}var hu=jt?WeakMap:Map,pu=Oi?WeakSet:Set,as=new $i,du=!1;function yu(){du||(du=!0,globalThis.__DEV__!==!1&&$.warn(52))}function mu(r,e,t){return as.withValue(!0,function(){var n=Zr(r,e,t,!1);return Object.isFrozen(r)&&Vn(n),n})}function Qp(r,e){if(e.has(r))return e.get(r);var t=Array.isArray(r)?[]:Object.create(null);return e.set(r,t),t}function Zr(r,e,t,n,i){var s,o=t.knownChanged,a=Qp(r,t.mutableTargets);if(Array.isArray(r)){for(var c=0,l=Array.from(r.entries());c<l.length;c++){var u=l[c],d=u[0],p=u[1];if(p===null){a[d]=null;continue}var y=Zr(p,e,t,n,globalThis.__DEV__!==!1?"".concat(i||"","[").concat(d,"]"):void 0);o.has(y)&&o.add(a),a[d]=y}return o.has(a)?a:r}for(var v=0,E=e.selections;v<E.length;v++){var w=E[v],b=void 0;if(n&&o.add(a),w.kind===D.FIELD){var k=mt(w),S=w.selectionSet;if(b=a[k]||r[k],b===void 0)continue;if(S&&b!==null){var y=Zr(r[k],S,t,n,globalThis.__DEV__!==!1?"".concat(i||"",".").concat(k):void 0);o.has(y)&&(b=y)}globalThis.__DEV__===!1&&(a[k]=b),globalThis.__DEV__!==!1&&(n&&k!=="__typename"&&!(!((s=Object.getOwnPropertyDescriptor(a,k))===null||s===void 0)&&s.value)?Object.defineProperty(a,k,Hp(k,b,i||"",t.operationName,t.operationType)):(delete a[k],a[k]=b))}if(w.kind===D.INLINE_FRAGMENT&&(!w.typeCondition||t.cache.fragmentMatches(w,r.__typename))&&(b=Zr(r,w.selectionSet,t,n,i)),w.kind===D.FRAGMENT_SPREAD){var I=w.name.value,O=t.fragmentMap[I]||(t.fragmentMap[I]=t.cache.lookupFragment(I));$(O,47,I);var C=Hf(w);C!=="mask"&&(b=Zr(r,O.selectionSet,t,C==="migrate",i))}o.has(b)&&o.add(a)}return"__typename"in r&&!("__typename"in a)&&(a.__typename=r.__typename),Object.keys(a).length!==Object.keys(r).length&&o.add(a),o.has(a)?a:r}function Hp(r,e,t,n,i){var s=function(){return as.getValue()||(globalThis.__DEV__!==!1&&$.warn(48,n?"".concat(i," '").concat(n,"'"):"anonymous ".concat(i),"".concat(t,".").concat(r).replace(/^\./,"")),s=function(){return e}),e};return{get:function(){return s()},set:function(o){s=function(){return o}},enumerable:!0,configurable:!0}}function gu(r,e,t,n){if(!t.fragmentMatches)return globalThis.__DEV__!==!1&&yu(),r;var i=e.definitions.filter(function(o){return o.kind===D.FRAGMENT_DEFINITION});typeof n>"u"&&($(i.length===1,49,i.length),n=i[0].name.value);var s=i.find(function(o){return o.name.value===n});return $(!!s,50,n),r==null||ie(r,{})?r:mu(r,s.selectionSet,{operationType:"fragment",operationName:s.name.value,fragmentMap:nr(ur(e)),cache:t,mutableTargets:new hu,knownChanged:new pu})}function Wp(r,e,t){var n;if(!t.fragmentMatches)return globalThis.__DEV__!==!1&&yu(),r;var i=Qt(e);return $(i,51),r==null?r:mu(r,i.selectionSet,{operationType:i.operation,operationName:(n=i.name)===null||n===void 0?void 0:n.value,fragmentMap:nr(ur(e)),cache:t,mutableTargets:new hu,knownChanged:new pu})}var vu=function(){function r(){this.assumeImmutableResults=!1,this.getFragmentDoc=Kr(Yf,{max:yt["cache.fragmentQueryDocuments"]||1e3,cache:Bn})}return r.prototype.lookupFragment=function(e){return null},r.prototype.batch=function(e){var t=this,n=typeof e.optimistic=="string"?e.optimistic:e.optimistic===!1?null:void 0,i;return this.performTransaction(function(){return i=e.update(t)},n),i},r.prototype.recordOptimisticTransaction=function(e,t){this.performTransaction(e,t)},r.prototype.transformDocument=function(e){return e},r.prototype.transformForLink=function(e){return e},r.prototype.identify=function(e){},r.prototype.gc=function(){return[]},r.prototype.modify=function(e){return!1},r.prototype.readQuery=function(e,t){return t===void 0&&(t=!!e.optimistic),this.read(T(T({},e),{rootId:e.id||"ROOT_QUERY",optimistic:t}))},r.prototype.watchFragment=function(e){var t=this,n=e.fragment,i=e.fragmentName,s=e.from,o=e.optimistic,a=o===void 0?!0:o,c=st(e,["fragment","fragmentName","from","optimistic"]),l=this.getFragmentDoc(n,i),u=typeof s>"u"||typeof s=="string"?s:this.identify(s),d=!!e[Symbol.for("apollo.dataMasking")];if(globalThis.__DEV__!==!1){var p=i||ma(n).name.value;u||globalThis.__DEV__!==!1&&$.warn(1,p)}var y=T(T({},c),{returnPartialData:!0,id:u,query:l,optimistic:a}),v;return new Z(function(E){return t.watch(T(T({},y),{immediate:!0,callback:function(w){var b=d?gu(w.result,n,t,i):w.result;if(!(v&&lu(l,{data:v?.result},{data:b}))){var k={data:b,complete:!!w.complete};w.missing&&(k.missing=Un(w.missing.map(function(S){return S.missing}))),v=T(T({},w),{result:b}),E.next(k)}}}))})},r.prototype.readFragment=function(e,t){return t===void 0&&(t=!!e.optimistic),this.read(T(T({},e),{query:this.getFragmentDoc(e.fragment,e.fragmentName),rootId:e.id,optimistic:t}))},r.prototype.writeQuery=function(e){var t=e.id,n=e.data,i=st(e,["id","data"]);return this.write(Object.assign(i,{dataId:t||"ROOT_QUERY",result:n}))},r.prototype.writeFragment=function(e){var t=e.id,n=e.data,i=e.fragment,s=e.fragmentName,o=st(e,["id","data","fragment","fragmentName"]);return this.write(Object.assign(o,{query:this.getFragmentDoc(i,s),dataId:t,result:n}))},r.prototype.updateQuery=function(e,t){return this.batch({update:function(n){var i=n.readQuery(e),s=t(i);return s==null?i:(n.writeQuery(T(T({},e),{data:s})),s)}})},r.prototype.updateFragment=function(e,t){return this.batch({update:function(n){var i=n.readFragment(e),s=t(i);return s==null?i:(n.writeFragment(T(T({},e),{data:s})),s)}})},r}();globalThis.__DEV__!==!1&&(vu.prototype.getMemoryInternals=ch);var bu=function(r){He(e,r);function e(t,n,i,s){var o,a=r.call(this,t)||this;if(a.message=t,a.path=n,a.query=i,a.variables=s,Array.isArray(a.path)){a.missing=a.message;for(var c=a.path.length-1;c>=0;--c)a.missing=(o={},o[a.path[c]]=a.missing,o)}else a.missing=a.path;return a.__proto__=e.prototype,a}return e}(Error),_e=Object.prototype.hasOwnProperty;function en(r){return r==null}function wu(r,e){var t=r.__typename,n=r.id,i=r._id;if(typeof t=="string"&&(e&&(e.keyObject=en(n)?en(i)?void 0:{_id:i}:{id:n}),en(n)&&!en(i)&&(n=i),!en(n)))return"".concat(t,":").concat(typeof n=="number"||typeof n=="string"?n:JSON.stringify(n))}var Eu={dataIdFromObject:wu,addTypename:!0,resultCaching:!0,canonizeResults:!1};function zp(r){return yr(Eu,r)}function _u(r){var e=r.canonizeResults;return e===void 0?Eu.canonizeResults:e}function Kp(r,e){return X(e)?r.get(e.__ref,"__typename"):e&&e.__typename}var Su=/^[_a-z][_0-9a-z]*/i;function Nt(r){var e=r.match(Su);return e?e[0]:r}function us(r,e,t){return ue(e)?fe(e)?e.every(function(n){return us(r,n,t)}):r.selections.every(function(n){if(It(n)&&Vr(n,t)){var i=mt(n);return _e.call(e,i)&&(!n.selectionSet||us(n.selectionSet,e[i],t))}return!0}):!1}function mr(r){return ue(r)&&!X(r)&&!fe(r)}function Gp(){return new Ct}function ku(r,e){var t=nr(ur(r));return{fragmentMap:t,lookupFragment:function(n){var i=t[n];return!i&&e&&(i=e.lookup(n)),i||null}}}var zn=Object.create(null),cs=function(){return zn},Tu=Object.create(null),Kn=function(){function r(e,t){var n=this;this.policies=e,this.group=t,this.data=Object.create(null),this.rootIds=Object.create(null),this.refs=Object.create(null),this.getFieldValue=function(i,s){return Vn(X(i)?n.get(i.__ref,s):i&&i[s])},this.canRead=function(i){return X(i)?n.has(i.__ref):typeof i=="object"},this.toReference=function(i,s){if(typeof i=="string")return sr(i);if(X(i))return i;var o=n.policies.identify(i)[0];if(o){var a=sr(o);return s&&n.merge(o,i),a}}}return r.prototype.toObject=function(){return T({},this.data)},r.prototype.has=function(e){return this.lookup(e,!0)!==void 0},r.prototype.get=function(e,t){if(this.group.depend(e,t),_e.call(this.data,e)){var n=this.data[e];if(n&&_e.call(n,t))return n[t]}if(t==="__typename"&&_e.call(this.policies.rootTypenamesById,e))return this.policies.rootTypenamesById[e];if(this instanceof Mt)return this.parent.get(e,t)},r.prototype.lookup=function(e,t){if(t&&this.group.depend(e,"__exists"),_e.call(this.data,e))return this.data[e];if(this instanceof Mt)return this.parent.lookup(e,t);if(this.policies.rootTypenamesById[e])return Object.create(null)},r.prototype.merge=function(e,t){var n=this,i;X(e)&&(e=e.__ref),X(t)&&(t=t.__ref);var s=typeof e=="string"?this.lookup(i=e):e,o=typeof t=="string"?this.lookup(i=t):t;if(o){$(typeof i=="string",2);var a=new Ct(Yp).merge(s,o);if(this.data[i]=a,a!==s&&(delete this.refs[i],this.group.caching)){var c=Object.create(null);s||(c.__exists=1),Object.keys(o).forEach(function(l){if(!s||s[l]!==a[l]){c[l]=1;var u=Nt(l);u!==l&&!n.policies.hasKeyArgs(a.__typename,u)&&(c[u]=1),a[l]===void 0&&!(n instanceof Mt)&&delete a[l]}}),c.__typename&&!(s&&s.__typename)&&this.policies.rootTypenamesById[i]===a.__typename&&delete c.__typename,Object.keys(c).forEach(function(l){return n.group.dirty(i,l)})}}},r.prototype.modify=function(e,t){var n=this,i=this.lookup(e);if(i){var s=Object.create(null),o=!1,a=!0,c={DELETE:zn,INVALIDATE:Tu,isReference:X,toReference:this.toReference,canRead:this.canRead,readField:function(l,u){return n.policies.readField(typeof l=="string"?{fieldName:l,from:u||sr(e)}:l,{store:n})}};if(Object.keys(i).forEach(function(l){var u=Nt(l),d=i[l];if(d!==void 0){var p=typeof t=="function"?t:t[l]||t[u];if(p){var y=p===cs?zn:p(Vn(d),T(T({},c),{fieldName:u,storeFieldName:l,storage:n.getStorage(e,l)}));if(y===Tu)n.group.dirty(e,l);else if(y===zn&&(y=void 0),y!==d&&(s[l]=y,o=!0,d=y,globalThis.__DEV__!==!1)){var v=function(O){if(n.lookup(O.__ref)===void 0)return globalThis.__DEV__!==!1&&$.warn(3,O),!0};if(X(y))v(y);else if(Array.isArray(y))for(var E=!1,w=void 0,b=0,k=y;b<k.length;b++){var S=k[b];if(X(S)){if(E=!0,v(S))break}else if(typeof S=="object"&&S){var I=n.policies.identify(S)[0];I&&(w=S)}if(E&&w!==void 0){globalThis.__DEV__!==!1&&$.warn(4,w);break}}}}d!==void 0&&(a=!1)}}),o)return this.merge(e,s),a&&(this instanceof Mt?this.data[e]=void 0:delete this.data[e],this.group.dirty(e,"__exists")),!0}return!1},r.prototype.delete=function(e,t,n){var i,s=this.lookup(e);if(s){var o=this.getFieldValue(s,"__typename"),a=t&&n?this.policies.getStoreFieldName({typename:o,fieldName:t,args:n}):t;return this.modify(e,a?(i={},i[a]=cs,i):cs)}return!1},r.prototype.evict=function(e,t){var n=!1;return e.id&&(_e.call(this.data,e.id)&&(n=this.delete(e.id,e.fieldName,e.args)),this instanceof Mt&&this!==t&&(n=this.parent.evict(e,t)||n),(e.fieldName||n)&&this.group.dirty(e.id,e.fieldName||"__exists")),n},r.prototype.clear=function(){this.replace(null)},r.prototype.extract=function(){var e=this,t=this.toObject(),n=[];return this.getRootIdSet().forEach(function(i){_e.call(e.policies.rootTypenamesById,i)||n.push(i)}),n.length&&(t.__META={extraRootIds:n.sort()}),t},r.prototype.replace=function(e){var t=this;if(Object.keys(this.data).forEach(function(s){e&&_e.call(e,s)||t.delete(s)}),e){var n=e.__META,i=st(e,["__META"]);Object.keys(i).forEach(function(s){t.merge(s,i[s])}),n&&n.extraRootIds.forEach(this.retain,this)}},r.prototype.retain=function(e){return this.rootIds[e]=(this.rootIds[e]||0)+1},r.prototype.release=function(e){if(this.rootIds[e]>0){var t=--this.rootIds[e];return t||delete this.rootIds[e],t}return 0},r.prototype.getRootIdSet=function(e){return e===void 0&&(e=new Set),Object.keys(this.rootIds).forEach(e.add,e),this instanceof Mt?this.parent.getRootIdSet(e):Object.keys(this.policies.rootTypenamesById).forEach(e.add,e),e},r.prototype.gc=function(){var e=this,t=this.getRootIdSet(),n=this.toObject();t.forEach(function(o){_e.call(n,o)&&(Object.keys(e.findChildRefIds(o)).forEach(t.add,t),delete n[o])});var i=Object.keys(n);if(i.length){for(var s=this;s instanceof Mt;)s=s.parent;i.forEach(function(o){return s.delete(o)})}return i},r.prototype.findChildRefIds=function(e){if(!_e.call(this.refs,e)){var t=this.refs[e]=Object.create(null),n=this.data[e];if(!n)return t;var i=new Set([n]);i.forEach(function(s){X(s)&&(t[s.__ref]=!0),ue(s)&&Object.keys(s).forEach(function(o){var a=s[o];ue(a)&&i.add(a)})})}return this.refs[e]},r.prototype.makeCacheKey=function(){return this.group.keyMaker.lookupArray(arguments)},r}(),xu=function(){function r(e,t){t===void 0&&(t=null),this.caching=e,this.parent=t,this.d=null,this.resetCaching()}return r.prototype.resetCaching=function(){this.d=this.caching?Ra():null,this.keyMaker=new dt(jt)},r.prototype.depend=function(e,t){if(this.d){this.d(ls(e,t));var n=Nt(t);n!==t&&this.d(ls(e,n)),this.parent&&this.parent.depend(e,t)}},r.prototype.dirty=function(e,t){this.d&&this.d.dirty(ls(e,t),t==="__exists"?"forget":"setDirty")},r}();function ls(r,e){return e+"#"+r}function Iu(r,e){tn(r)&&r.group.depend(e,"__exists")}(function(r){var e=function(t){He(n,t);function n(i){var s=i.policies,o=i.resultCaching,a=o===void 0?!0:o,c=i.seed,l=t.call(this,s,new xu(a))||this;return l.stump=new Jp(l),l.storageTrie=new dt(jt),c&&l.replace(c),l}return n.prototype.addLayer=function(i,s){return this.stump.addLayer(i,s)},n.prototype.removeLayer=function(){return this},n.prototype.getStorage=function(){return this.storageTrie.lookupArray(arguments)},n}(r);r.Root=e})(Kn);var Mt=function(r){He(e,r);function e(t,n,i,s){var o=r.call(this,n.policies,s)||this;return o.id=t,o.parent=n,o.replay=i,o.group=s,i(o),o}return e.prototype.addLayer=function(t,n){return new e(t,this,n,this.group)},e.prototype.removeLayer=function(t){var n=this,i=this.parent.removeLayer(t);return t===this.id?(this.group.caching&&Object.keys(this.data).forEach(function(s){var o=n.data[s],a=i.lookup(s);a?o?o!==a&&Object.keys(o).forEach(function(c){ie(o[c],a[c])||n.group.dirty(s,c)}):(n.group.dirty(s,"__exists"),Object.keys(a).forEach(function(c){n.group.dirty(s,c)})):n.delete(s)}),i):i===this.parent?this:i.addLayer(this.id,this.replay)},e.prototype.toObject=function(){return T(T({},this.parent.toObject()),this.data)},e.prototype.findChildRefIds=function(t){var n=this.parent.findChildRefIds(t);return _e.call(this.data,t)?T(T({},n),r.prototype.findChildRefIds.call(this,t)):n},e.prototype.getStorage=function(){for(var t=this.parent;t.parent;)t=t.parent;return t.getStorage.apply(t,arguments)},e}(Kn),Jp=function(r){He(e,r);function e(t){return r.call(this,"EntityStore.Stump",t,function(){},new xu(t.group.caching,t.group))||this}return e.prototype.removeLayer=function(){return this},e.prototype.merge=function(t,n){return this.parent.merge(t,n)},e}(Mt);function Yp(r,e,t){var n=r[t],i=e[t];return ie(n,i)?n:i}function tn(r){return!!(r instanceof Kn&&r.group.caching)}function Xp(r){return ue(r)?fe(r)?r.slice(0):T({__proto__:Object.getPrototypeOf(r)},r):r}var Au=function(){function r(){this.known=new(Oi?WeakSet:Set),this.pool=new dt(jt),this.passes=new WeakMap,this.keysByJSON=new Map,this.empty=this.admit({})}return r.prototype.isKnown=function(e){return ue(e)&&this.known.has(e)},r.prototype.pass=function(e){if(ue(e)){var t=Xp(e);return this.passes.set(t,e),t}return e},r.prototype.admit=function(e){var t=this;if(ue(e)){var n=this.passes.get(e);if(n)return n;var i=Object.getPrototypeOf(e);switch(i){case Array.prototype:{if(this.known.has(e))return e;var s=e.map(this.admit,this),o=this.pool.lookupArray(s);return o.array||(this.known.add(o.array=s),globalThis.__DEV__!==!1&&Object.freeze(s)),o.array}case null:case Object.prototype:{if(this.known.has(e))return e;var a=Object.getPrototypeOf(e),c=[a],l=this.sortedKeys(e);c.push(l.json);var u=c.length;l.sorted.forEach(function(y){c.push(t.admit(e[y]))});var o=this.pool.lookupArray(c);if(!o.object){var d=o.object=Object.create(a);this.known.add(d),l.sorted.forEach(function(y,v){d[y]=c[u+v]}),globalThis.__DEV__!==!1&&Object.freeze(d)}return o.object}}}return e},r.prototype.sortedKeys=function(e){var t=Object.keys(e),n=this.pool.lookupArray(t);if(!n.keys){t.sort();var i=JSON.stringify(t);(n.keys=this.keysByJSON.get(i))||this.keysByJSON.set(i,n.keys={sorted:t,json:i})}return n.keys},r}();function Ou(r){return[r.selectionSet,r.objectOrReference,r.context,r.context.canonizeResults]}var Zp=function(){function r(e){var t=this;this.knownResults=new(jt?WeakMap:Map),this.config=yr(e,{addTypename:e.addTypename!==!1,canonizeResults:_u(e)}),this.canon=e.canon||new Au,this.executeSelectionSet=Kr(function(n){var i,s=n.context.canonizeResults,o=Ou(n);o[3]=!s;var a=(i=t.executeSelectionSet).peek.apply(i,o);return a?s?T(T({},a),{result:t.canon.admit(a.result)}):a:(Iu(n.context.store,n.enclosingRef.__ref),t.execSelectionSetImpl(n))},{max:this.config.resultCacheMaxSize||yt["inMemoryCache.executeSelectionSet"]||5e4,keyArgs:Ou,makeCacheKey:function(n,i,s,o){if(tn(s.store))return s.store.makeCacheKey(n,X(i)?i.__ref:i,s.varString,o)}}),this.executeSubSelectedArray=Kr(function(n){return Iu(n.context.store,n.enclosingRef.__ref),t.execSubSelectedArrayImpl(n)},{max:this.config.resultCacheMaxSize||yt["inMemoryCache.executeSubSelectedArray"]||1e4,makeCacheKey:function(n){var i=n.field,s=n.array,o=n.context;if(tn(o.store))return o.store.makeCacheKey(i,s,o.varString)}})}return r.prototype.resetCanon=function(){this.canon=new Au},r.prototype.diffQueryAgainstStore=function(e){var t=e.store,n=e.query,i=e.rootId,s=i===void 0?"ROOT_QUERY":i,o=e.variables,a=e.returnPartialData,c=a===void 0?!0:a,l=e.canonizeResults,u=l===void 0?this.config.canonizeResults:l,d=this.config.cache.policies;o=T(T({},Bi(ya(n))),o);var p=sr(s),y=this.executeSelectionSet({selectionSet:cr(n).selectionSet,objectOrReference:p,enclosingRef:p,context:T({store:t,query:n,policies:d,variables:o,varString:xt(o),canonizeResults:u},ku(n,this.config.fragments))}),v;if(y.missing&&(v=[new bu(ed(y.missing),y.missing,n,o)],!c))throw v[0];return{result:y.result,complete:!v,missing:v}},r.prototype.isFresh=function(e,t,n,i){if(tn(i.store)&&this.knownResults.get(e)===n){var s=this.executeSelectionSet.peek(n,t,i,this.canon.isKnown(e));if(s&&e===s.result)return!0}return!1},r.prototype.execSelectionSetImpl=function(e){var t=this,n=e.selectionSet,i=e.objectOrReference,s=e.enclosingRef,o=e.context;if(X(i)&&!o.policies.rootTypenamesById[i.__ref]&&!o.store.has(i.__ref))return{result:this.canon.empty,missing:"Dangling reference to missing ".concat(i.__ref," object")};var a=o.variables,c=o.policies,l=o.store,u=l.getFieldValue(i,"__typename"),d=[],p,y=new Ct;this.config.addTypename&&typeof u=="string"&&!c.rootIdsByTypename[u]&&d.push({__typename:u});function v(S,I){var O;return S.missing&&(p=y.merge(p,(O={},O[I]=S.missing,O))),S.result}var E=new Set(n.selections);E.forEach(function(S){var I,O;if(Vr(S,a))if(It(S)){var C=c.readField({fieldName:S.name.value,field:S,variables:o.variables,from:i},o),M=mt(S);C===void 0?Vi.added(S)||(p=y.merge(p,(I={},I[M]="Can't find field '".concat(S.name.value,"' on ").concat(X(i)?i.__ref+" object":"object "+JSON.stringify(i,null,2)),I))):fe(C)?C.length>0&&(C=v(t.executeSubSelectedArray({field:S,array:C,enclosingRef:s,context:o}),M)):S.selectionSet?C!=null&&(C=v(t.executeSelectionSet({selectionSet:S.selectionSet,objectOrReference:C,enclosingRef:X(C)?C:s,context:o}),M)):o.canonizeResults&&(C=t.canon.pass(C)),C!==void 0&&d.push((O={},O[M]=C,O))}else{var F=Fn(S,o.lookupFragment);if(!F&&S.kind===D.FRAGMENT_SPREAD)throw Fe(10,S.name.value);F&&c.fragmentMatches(F,u)&&F.selectionSet.selections.forEach(E.add,E)}});var w=Un(d),b={result:w,missing:p},k=o.canonizeResults?this.canon.admit(b):Vn(b);return k.result&&this.knownResults.set(k.result,n),k},r.prototype.execSubSelectedArrayImpl=function(e){var t=this,n=e.field,i=e.array,s=e.enclosingRef,o=e.context,a,c=new Ct;function l(u,d){var p;return u.missing&&(a=c.merge(a,(p={},p[d]=u.missing,p))),u.result}return n.selectionSet&&(i=i.filter(o.store.canRead)),i=i.map(function(u,d){return u===null?null:fe(u)?l(t.executeSubSelectedArray({field:n,array:u,enclosingRef:s,context:o}),d):n.selectionSet?l(t.executeSelectionSet({selectionSet:n.selectionSet,objectOrReference:u,enclosingRef:X(u)?u:s,context:o}),d):(globalThis.__DEV__!==!1&&td(o.store,n,u),u)}),{result:o.canonizeResults?this.canon.admit(i):i,missing:a}},r}();function ed(r){try{JSON.stringify(r,function(e,t){if(typeof t=="string")throw t;return t})}catch(e){return e}}function td(r,e,t){if(!e.selectionSet){var n=new Set([t]);n.forEach(function(i){ue(i)&&($(!X(i),11,Kp(r,i),e.name.value),Object.values(i).forEach(n.add,n))})}}var fs=new $i,Cu=new WeakMap;function rn(r){var e=Cu.get(r);return e||Cu.set(r,e={vars:new Set,dep:Ra()}),e}function Ru(r){rn(r).vars.forEach(function(e){return e.forgetCache(r)})}function rd(r){rn(r).vars.forEach(function(e){return e.attachCache(r)})}function nd(r){var e=new Set,t=new Set,n=function(s){if(arguments.length>0){if(r!==s){r=s,e.forEach(function(c){rn(c).dep.dirty(n),id(c)});var o=Array.from(t);t.clear(),o.forEach(function(c){return c(r)})}}else{var a=fs.getValue();a&&(i(a),rn(a).dep(n))}return r};n.onNextChange=function(s){return t.add(s),function(){t.delete(s)}};var i=n.attachCache=function(s){return e.add(s),rn(s).vars.add(n),n};return n.forgetCache=function(s){return e.delete(s)},n}function id(r){r.broadcastWatches&&r.broadcastWatches()}var Nu=Object.create(null);function hs(r){var e=JSON.stringify(r);return Nu[e]||(Nu[e]=Object.create(null))}function Mu(r){var e=hs(r);return e.keyFieldsFn||(e.keyFieldsFn=function(t,n){var i=function(o,a){return n.readField(a,o)},s=n.keyObject=ps(r,function(o){var a=gr(n.storeObject,o,i);return a===void 0&&t!==n.storeObject&&_e.call(t,o[0])&&(a=gr(t,o,Bu)),$(a!==void 0,5,o.join("."),t),a});return"".concat(n.typename,":").concat(JSON.stringify(s))})}function Du(r){var e=hs(r);return e.keyArgsFn||(e.keyArgsFn=function(t,n){var i=n.field,s=n.variables,o=n.fieldName,a=ps(r,function(l){var u=l[0],d=u.charAt(0);if(d==="@"){if(i&&ot(i.directives)){var p=u.slice(1),y=i.directives.find(function(b){return b.name.value===p}),v=y&&Pn(y,s);return v&&gr(v,l.slice(1))}return}if(d==="$"){var E=u.slice(1);if(s&&_e.call(s,E)){var w=l.slice(0);return w[0]=E,gr(s,w)}return}if(t)return gr(t,l)}),c=JSON.stringify(a);return(t||c!=="{}")&&(o+=":"+c),o})}function ps(r,e){var t=new Ct;return Fu(r).reduce(function(n,i){var s,o=e(i);if(o!==void 0){for(var a=i.length-1;a>=0;--a)o=(s={},s[i[a]]=o,s);n=t.merge(n,o)}return n},Object.create(null))}function Fu(r){var e=hs(r);if(!e.paths){var t=e.paths=[],n=[];r.forEach(function(i,s){fe(i)?(Fu(i).forEach(function(o){return t.push(n.concat(o))}),n.length=0):(n.push(i),fe(r[s+1])||(t.push(n.slice(0)),n.length=0))})}return e.paths}function Bu(r,e){return r[e]}function gr(r,e,t){return t=t||Bu,Pu(e.reduce(function n(i,s){return fe(i)?i.map(function(o){return n(o,s)}):i&&t(i,s)},r))}function Pu(r){return ue(r)?fe(r)?r.map(Pu):ps(Object.keys(r).sort(),function(e){return gr(r,e)}):r}function ds(r){return r.args!==void 0?r.args:r.field?Pn(r.field,r.variables):null}var sd=function(){},$u=function(r,e){return e.fieldName},Lu=function(r,e,t){var n=t.mergeObjects;return n(r,e)},Uu=function(r,e){return e},od=function(){function r(e){this.config=e,this.typePolicies=Object.create(null),this.toBeAdded=Object.create(null),this.supertypeMap=new Map,this.fuzzySubtypes=new Map,this.rootIdsByTypename=Object.create(null),this.rootTypenamesById=Object.create(null),this.usingPossibleTypes=!1,this.config=T({dataIdFromObject:wu},e),this.cache=this.config.cache,this.setRootTypename("Query"),this.setRootTypename("Mutation"),this.setRootTypename("Subscription"),e.possibleTypes&&this.addPossibleTypes(e.possibleTypes),e.typePolicies&&this.addTypePolicies(e.typePolicies)}return r.prototype.identify=function(e,t){var n,i=this,s=t&&(t.typename||((n=t.storeObject)===null||n===void 0?void 0:n.__typename))||e.__typename;if(s===this.rootTypenamesById.ROOT_QUERY)return["ROOT_QUERY"];var o=t&&t.storeObject||e,a=T(T({},t),{typename:s,storeObject:o,readField:t&&t.readField||function(){var d=ys(arguments,o);return i.readField(d,{store:i.cache.data,variables:d.variables})}}),c,l=s&&this.getTypePolicy(s),u=l&&l.keyFn||this.config.dataIdFromObject;return as.withValue(!0,function(){for(;u;){var d=u(T(T({},e),o),a);if(fe(d))u=Mu(d);else{c=d;break}}}),c=c?String(c):void 0,a.keyObject?[c,a.keyObject]:[c]},r.prototype.addTypePolicies=function(e){var t=this;Object.keys(e).forEach(function(n){var i=e[n],s=i.queryType,o=i.mutationType,a=i.subscriptionType,c=st(i,["queryType","mutationType","subscriptionType"]);s&&t.setRootTypename("Query",n),o&&t.setRootTypename("Mutation",n),a&&t.setRootTypename("Subscription",n),_e.call(t.toBeAdded,n)?t.toBeAdded[n].push(c):t.toBeAdded[n]=[c]})},r.prototype.updateTypePolicy=function(e,t){var n=this,i=this.getTypePolicy(e),s=t.keyFields,o=t.fields;function a(c,l){c.merge=typeof l=="function"?l:l===!0?Lu:l===!1?Uu:c.merge}a(i,t.merge),i.keyFn=s===!1?sd:fe(s)?Mu(s):typeof s=="function"?s:i.keyFn,o&&Object.keys(o).forEach(function(c){var l=n.getFieldPolicy(e,c,!0),u=o[c];if(typeof u=="function")l.read=u;else{var d=u.keyArgs,p=u.read,y=u.merge;l.keyFn=d===!1?$u:fe(d)?Du(d):typeof d=="function"?d:l.keyFn,typeof p=="function"&&(l.read=p),a(l,y)}l.read&&l.merge&&(l.keyFn=l.keyFn||$u)})},r.prototype.setRootTypename=function(e,t){t===void 0&&(t=e);var n="ROOT_"+e.toUpperCase(),i=this.rootTypenamesById[n];t!==i&&($(!i||i===e,6,e),i&&delete this.rootIdsByTypename[i],this.rootIdsByTypename[t]=n,this.rootTypenamesById[n]=t)},r.prototype.addPossibleTypes=function(e){var t=this;this.usingPossibleTypes=!0,Object.keys(e).forEach(function(n){t.getSupertypeSet(n,!0),e[n].forEach(function(i){t.getSupertypeSet(i,!0).add(n);var s=i.match(Su);(!s||s[0]!==i)&&t.fuzzySubtypes.set(i,new RegExp(i))})})},r.prototype.getTypePolicy=function(e){var t=this;if(!_e.call(this.typePolicies,e)){var n=this.typePolicies[e]=Object.create(null);n.fields=Object.create(null);var i=this.supertypeMap.get(e);!i&&this.fuzzySubtypes.size&&(i=this.getSupertypeSet(e,!0),this.fuzzySubtypes.forEach(function(o,a){if(o.test(e)){var c=t.supertypeMap.get(a);c&&c.forEach(function(l){return i.add(l)})}})),i&&i.size&&i.forEach(function(o){var a=t.getTypePolicy(o),c=a.fields,l=st(a,["fields"]);Object.assign(n,l),Object.assign(n.fields,c)})}var s=this.toBeAdded[e];return s&&s.length&&s.splice(0).forEach(function(o){t.updateTypePolicy(e,o)}),this.typePolicies[e]},r.prototype.getFieldPolicy=function(e,t,n){if(e){var i=this.getTypePolicy(e).fields;return i[t]||n&&(i[t]=Object.create(null))}},r.prototype.getSupertypeSet=function(e,t){var n=this.supertypeMap.get(e);return!n&&t&&this.supertypeMap.set(e,n=new Set),n},r.prototype.fragmentMatches=function(e,t,n,i){var s=this;if(!e.typeCondition)return!0;if(!t)return!1;var o=e.typeCondition.name.value;if(t===o)return!0;if(this.usingPossibleTypes&&this.supertypeMap.has(o))for(var a=this.getSupertypeSet(t,!0),c=[a],l=function(v){var E=s.getSupertypeSet(v,!1);E&&E.size&&c.indexOf(E)<0&&c.push(E)},u=!!(n&&this.fuzzySubtypes.size),d=!1,p=0;p<c.length;++p){var y=c[p];if(y.has(o))return a.has(o)||(d&&globalThis.__DEV__!==!1&&$.warn(7,t,o),a.add(o)),!0;y.forEach(l),u&&p===c.length-1&&us(e.selectionSet,n,i)&&(u=!1,d=!0,this.fuzzySubtypes.forEach(function(v,E){var w=t.match(v);w&&w[0]===t&&l(E)}))}return!1},r.prototype.hasKeyArgs=function(e,t){var n=this.getFieldPolicy(e,t,!1);return!!(n&&n.keyFn)},r.prototype.getStoreFieldName=function(e){var t=e.typename,n=e.fieldName,i=this.getFieldPolicy(t,n,!1),s,o=i&&i.keyFn;if(o&&t)for(var a={typename:t,fieldName:n,field:e.field||null,variables:e.variables},c=ds(e);o;){var l=o(c,a);if(fe(l))o=Du(l);else{s=l||n;break}}return s===void 0&&(s=e.field?xh(e.field,e.variables):da(n,ds(e))),s===!1?n:n===Nt(s)?s:n+":"+s},r.prototype.readField=function(e,t){var n=e.from;if(n){var i=e.field||e.fieldName;if(i){if(e.typename===void 0){var s=t.store.getFieldValue(n,"__typename");s&&(e.typename=s)}var o=this.getStoreFieldName(e),a=Nt(o),c=t.store.getFieldValue(n,o),l=this.getFieldPolicy(e.typename,a,!1),u=l&&l.read;if(u){var d=qu(this,n,e,t,t.store.getStorage(X(n)?n.__ref:n,o));return fs.withValue(this.cache,u,[c,d])}return c}}},r.prototype.getReadFunction=function(e,t){var n=this.getFieldPolicy(e,t,!1);return n&&n.read},r.prototype.getMergeFunction=function(e,t,n){var i=this.getFieldPolicy(e,t,!1),s=i&&i.merge;return!s&&n&&(i=this.getTypePolicy(n),s=i&&i.merge),s},r.prototype.runMergeFunction=function(e,t,n,i,s){var o=n.field,a=n.typename,c=n.merge;return c===Lu?ju(i.store)(e,t):c===Uu?t:(i.overwrite&&(e=void 0),c(e,t,qu(this,void 0,{typename:a,fieldName:o.name.value,field:o,variables:i.variables},i,s||Object.create(null))))},r}();function qu(r,e,t,n,i){var s=r.getStoreFieldName(t),o=Nt(s),a=t.variables||n.variables,c=n.store,l=c.toReference,u=c.canRead;return{args:ds(t),field:t.field||null,fieldName:o,storeFieldName:s,variables:a,isReference:X,toReference:l,storage:i,cache:r.cache,canRead:u,readField:function(){return r.readField(ys(arguments,e,a),n)},mergeObjects:ju(n.store)}}function ys(r,e,t){var n=r[0],i=r[1],s=r.length,o;return typeof n=="string"?o={fieldName:n,from:s>1?i:e}:(o=T({},n),_e.call(o,"from")||(o.from=e)),globalThis.__DEV__!==!1&&o.from===void 0&&globalThis.__DEV__!==!1&&$.warn(8,Uo(Array.from(r))),o.variables===void 0&&(o.variables=t),o}function ju(r){return function(t,n){if(fe(t)||fe(n))throw Fe(9);if(ue(t)&&ue(n)){var i=r.getFieldValue(t,"__typename"),s=r.getFieldValue(n,"__typename"),o=i&&s&&i!==s;if(o)return n;if(X(t)&&mr(n))return r.merge(t.__ref,n),t;if(mr(t)&&X(n))return r.merge(t,n.__ref),n;if(mr(t)&&mr(n))return T(T({},t),n)}return n}}function ms(r,e,t){var n="".concat(e).concat(t),i=r.flavors.get(n);return i||r.flavors.set(n,i=r.clientOnly===e&&r.deferred===t?r:T(T({},r),{clientOnly:e,deferred:t})),i}var ad=function(){function r(e,t,n){this.cache=e,this.reader=t,this.fragments=n}return r.prototype.writeToStore=function(e,t){var n=this,i=t.query,s=t.result,o=t.dataId,a=t.variables,c=t.overwrite,l=Qt(i),u=Gp();a=T(T({},Bi(l)),a);var d=T(T({store:e,written:Object.create(null),merge:function(y,v){return u.merge(y,v)},variables:a,varString:xt(a)},ku(i,this.fragments)),{overwrite:!!c,incomingById:new Map,clientOnly:!1,deferred:!1,flavors:new Map}),p=this.processSelectionSet({result:s||Object.create(null),dataId:o,selectionSet:l.selectionSet,mergeTree:{map:new Map},context:d});if(!X(p))throw Fe(12,s);return d.incomingById.forEach(function(y,v){var E=y.storeObject,w=y.mergeTree,b=y.fieldNodeSet,k=sr(v);if(w&&w.map.size){var S=n.applyMerges(w,k,E,d);if(X(S))return;E=S}if(globalThis.__DEV__!==!1&&!d.overwrite){var I=Object.create(null);b.forEach(function(M){M.selectionSet&&(I[M.name.value]=!0)});var O=function(M){return I[Nt(M)]===!0},C=function(M){var F=w&&w.map.get(M);return!!(F&&F.info&&F.info.merge)};Object.keys(E).forEach(function(M){O(M)&&!C(M)&&ud(k,E,M,d.store)})}e.merge(v,E)}),e.retain(p.__ref),p},r.prototype.processSelectionSet=function(e){var t=this,n=e.dataId,i=e.result,s=e.selectionSet,o=e.context,a=e.mergeTree,c=this.cache.policies,l=Object.create(null),u=n&&c.rootTypenamesById[n]||Fi(i,s,o.fragmentMap)||n&&o.store.get(n,"__typename");typeof u=="string"&&(l.__typename=u);var d=function(){var S=ys(arguments,l,o.variables);if(X(S.from)){var I=o.incomingById.get(S.from.__ref);if(I){var O=c.readField(T(T({},S),{from:I.storeObject}),o);if(O!==void 0)return O}}return c.readField(S,o)},p=new Set;this.flattenFields(s,i,o,u).forEach(function(S,I){var O,C=mt(I),M=i[C];if(p.add(I),M!==void 0){var F=c.getStoreFieldName({typename:u,fieldName:I.name.value,field:I,variables:S.variables}),L=Qu(a,F),V=t.processFieldValue(M,I,I.selectionSet?ms(S,!1,!1):S,L),G=void 0;I.selectionSet&&(X(V)||mr(V))&&(G=d("__typename",V));var Se=c.getMergeFunction(u,I.name.value,G);Se?L.info={field:I,typename:u,merge:Se}:Hu(a,F),l=S.merge(l,(O={},O[F]=V,O))}else globalThis.__DEV__!==!1&&!S.clientOnly&&!S.deferred&&!Vi.added(I)&&!c.getReadFunction(u,I.name.value)&&globalThis.__DEV__!==!1&&$.error(13,mt(I),i)});try{var y=c.identify(i,{typename:u,selectionSet:s,fragmentMap:o.fragmentMap,storeObject:l,readField:d}),v=y[0],E=y[1];n=n||v,E&&(l=o.merge(l,E))}catch(S){if(!n)throw S}if(typeof n=="string"){var w=sr(n),b=o.written[n]||(o.written[n]=[]);if(b.indexOf(s)>=0||(b.push(s),this.reader&&this.reader.isFresh(i,w,s,o)))return w;var k=o.incomingById.get(n);return k?(k.storeObject=o.merge(k.storeObject,l),k.mergeTree=gs(k.mergeTree,a),p.forEach(function(S){return k.fieldNodeSet.add(S)})):o.incomingById.set(n,{storeObject:l,mergeTree:Gn(a)?void 0:a,fieldNodeSet:p}),w}return l},r.prototype.processFieldValue=function(e,t,n,i){var s=this;return!t.selectionSet||e===null?globalThis.__DEV__!==!1?za(e):e:fe(e)?e.map(function(o,a){var c=s.processFieldValue(o,t,n,Qu(i,a));return Hu(i,a),c}):this.processSelectionSet({result:e,selectionSet:t.selectionSet,context:n,mergeTree:i})},r.prototype.flattenFields=function(e,t,n,i){i===void 0&&(i=Fi(t,e,n.fragmentMap));var s=new Map,o=this.cache.policies,a=new dt(!1);return function c(l,u){var d=a.lookup(l,u.clientOnly,u.deferred);d.visited||(d.visited=!0,l.selections.forEach(function(p){if(Vr(p,n.variables)){var y=u.clientOnly,v=u.deferred;if(!(y&&v)&&ot(p.directives)&&p.directives.forEach(function(b){var k=b.name.value;if(k==="client"&&(y=!0),k==="defer"){var S=Pn(b,n.variables);(!S||S.if!==!1)&&(v=!0)}}),It(p)){var E=s.get(p);E&&(y=y&&E.clientOnly,v=v&&E.deferred),s.set(p,ms(n,y,v))}else{var w=Fn(p,n.lookupFragment);if(!w&&p.kind===D.FRAGMENT_SPREAD)throw Fe(14,p.name.value);w&&o.fragmentMatches(w,i,t,n.variables)&&c(w.selectionSet,ms(n,y,v))}}}))}(e,n),s},r.prototype.applyMerges=function(e,t,n,i,s){var o,a=this;if(e.map.size&&!X(n)){var c=!fe(n)&&(X(t)||mr(t))?t:void 0,l=n;c&&!s&&(s=[X(c)?c.__ref:c]);var u,d=function(p,y){return fe(p)?typeof y=="number"?p[y]:void 0:i.store.getFieldValue(p,String(y))};e.map.forEach(function(p,y){var v=d(c,y),E=d(l,y);if(E!==void 0){s&&s.push(y);var w=a.applyMerges(p,v,E,i,s);w!==E&&(u=u||new Map,u.set(y,w)),s&&$(s.pop()===y)}}),u&&(n=fe(l)?l.slice(0):T({},l),u.forEach(function(p,y){n[y]=p}))}return e.info?this.cache.policies.runMergeFunction(t,n,e.info,i,s&&(o=i.store).getStorage.apply(o,s)):n},r}(),Vu=[];function Qu(r,e){var t=r.map;return t.has(e)||t.set(e,Vu.pop()||{map:new Map}),t.get(e)}function gs(r,e){if(r===e||!e||Gn(e))return r;if(!r||Gn(r))return e;var t=r.info&&e.info?T(T({},r.info),e.info):r.info||e.info,n=r.map.size&&e.map.size,i=n?new Map:r.map.size?r.map:e.map,s={info:t,map:i};if(n){var o=new Set(e.map.keys());r.map.forEach(function(a,c){s.map.set(c,gs(a,e.map.get(c))),o.delete(c)}),o.forEach(function(a){s.map.set(a,gs(e.map.get(a),r.map.get(a)))})}return s}function Gn(r){return!r||!(r.info||r.map.size)}function Hu(r,e){var t=r.map,n=t.get(e);n&&Gn(n)&&(Vu.push(n),t.delete(e))}var Wu=new Set;function ud(r,e,t,n){var i=function(d){var p=n.getFieldValue(d,t);return typeof p=="object"&&p},s=i(r);if(s){var o=i(e);if(o&&!X(s)&&!ie(s,o)&&!Object.keys(s).every(function(d){return n.getFieldValue(o,d)!==void 0})){var a=n.getFieldValue(r,"__typename")||n.getFieldValue(e,"__typename"),c=Nt(t),l="".concat(a,".").concat(c);if(!Wu.has(l)){Wu.add(l);var u=[];!fe(s)&&!fe(o)&&[s,o].forEach(function(d){var p=n.getFieldValue(d,"__typename");typeof p=="string"&&!u.includes(p)&&u.push(p)}),globalThis.__DEV__!==!1&&$.warn(15,c,a,u.length?"either ensure all objects of type "+u.join(" and ")+" have an ID or a custom merge function, or ":"",l,T({},s),T({},o))}}}}var zu=function(r){He(e,r);function e(t){t===void 0&&(t={});var n=r.call(this)||this;return n.watches=new Set,n.addTypenameTransform=new Ma(Vi),n.assumeImmutableResults=!0,n.makeVar=nd,n.txCount=0,n.config=zp(t),n.addTypename=!!n.config.addTypename,n.policies=new od({cache:n,dataIdFromObject:n.config.dataIdFromObject,possibleTypes:n.config.possibleTypes,typePolicies:n.config.typePolicies}),n.init(),n}return e.prototype.init=function(){var t=this.data=new Kn.Root({policies:this.policies,resultCaching:this.config.resultCaching});this.optimisticData=t.stump,this.resetResultCache()},e.prototype.resetResultCache=function(t){var n=this,i=this.storeReader,s=this.config.fragments;this.storeWriter=new ad(this,this.storeReader=new Zp({cache:this,addTypename:this.addTypename,resultCacheMaxSize:this.config.resultCacheMaxSize,canonizeResults:_u(this.config),canon:t?void 0:i&&i.canon,fragments:s}),s),this.maybeBroadcastWatch=Kr(function(o,a){return n.broadcastWatch(o,a)},{max:this.config.resultCacheMaxSize||yt["inMemoryCache.maybeBroadcastWatch"]||5e3,makeCacheKey:function(o){var a=o.optimistic?n.optimisticData:n.data;if(tn(a)){var c=o.optimistic,l=o.id,u=o.variables;return a.makeCacheKey(o.query,o.callback,xt({optimistic:c,id:l,variables:u}))}}}),new Set([this.data.group,this.optimisticData.group]).forEach(function(o){return o.resetCaching()})},e.prototype.restore=function(t){return this.init(),t&&this.data.replace(t),this},e.prototype.extract=function(t){return t===void 0&&(t=!1),(t?this.optimisticData:this.data).extract()},e.prototype.read=function(t){var n=t.returnPartialData,i=n===void 0?!1:n;try{return this.storeReader.diffQueryAgainstStore(T(T({},t),{store:t.optimistic?this.optimisticData:this.data,config:this.config,returnPartialData:i})).result||null}catch(s){if(s instanceof bu)return null;throw s}},e.prototype.write=function(t){try{return++this.txCount,this.storeWriter.writeToStore(this.data,t)}finally{!--this.txCount&&t.broadcast!==!1&&this.broadcastWatches()}},e.prototype.modify=function(t){if(_e.call(t,"id")&&!t.id)return!1;var n=t.optimistic?this.optimisticData:this.data;try{return++this.txCount,n.modify(t.id||"ROOT_QUERY",t.fields)}finally{!--this.txCount&&t.broadcast!==!1&&this.broadcastWatches()}},e.prototype.diff=function(t){return this.storeReader.diffQueryAgainstStore(T(T({},t),{store:t.optimistic?this.optimisticData:this.data,rootId:t.id||"ROOT_QUERY",config:this.config}))},e.prototype.watch=function(t){var n=this;return this.watches.size||rd(this),this.watches.add(t),t.immediate&&this.maybeBroadcastWatch(t),function(){n.watches.delete(t)&&!n.watches.size&&Ru(n),n.maybeBroadcastWatch.forget(t)}},e.prototype.gc=function(t){var n;xt.reset(),Ot.reset(),this.addTypenameTransform.resetCache(),(n=this.config.fragments)===null||n===void 0||n.resetCaches();var i=this.optimisticData.gc();return t&&!this.txCount&&(t.resetResultCache?this.resetResultCache(t.resetResultIdentities):t.resetResultIdentities&&this.storeReader.resetCanon()),i},e.prototype.retain=function(t,n){return(n?this.optimisticData:this.data).retain(t)},e.prototype.release=function(t,n){return(n?this.optimisticData:this.data).release(t)},e.prototype.identify=function(t){if(X(t))return t.__ref;try{return this.policies.identify(t)[0]}catch(n){globalThis.__DEV__!==!1&&$.warn(n)}},e.prototype.evict=function(t){if(!t.id){if(_e.call(t,"id"))return!1;t=T(T({},t),{id:"ROOT_QUERY"})}try{return++this.txCount,this.optimisticData.evict(t,this.data)}finally{!--this.txCount&&t.broadcast!==!1&&this.broadcastWatches()}},e.prototype.reset=function(t){var n=this;return this.init(),xt.reset(),t&&t.discardWatches?(this.watches.forEach(function(i){return n.maybeBroadcastWatch.forget(i)}),this.watches.clear(),Ru(this)):this.broadcastWatches(),Promise.resolve()},e.prototype.removeOptimistic=function(t){var n=this.optimisticData.removeLayer(t);n!==this.optimisticData&&(this.optimisticData=n,this.broadcastWatches())},e.prototype.batch=function(t){var n=this,i=t.update,s=t.optimistic,o=s===void 0?!0:s,a=t.removeOptimistic,c=t.onWatchUpdated,l,u=function(p){var y=n,v=y.data,E=y.optimisticData;++n.txCount,p&&(n.data=n.optimisticData=p);try{return l=i(n)}finally{--n.txCount,n.data=v,n.optimisticData=E}},d=new Set;return c&&!this.txCount&&this.broadcastWatches(T(T({},t),{onWatchUpdated:function(p){return d.add(p),!1}})),typeof o=="string"?this.optimisticData=this.optimisticData.addLayer(o,u):o===!1?u(this.data):u(),typeof a=="string"&&(this.optimisticData=this.optimisticData.removeLayer(a)),c&&d.size?(this.broadcastWatches(T(T({},t),{onWatchUpdated:function(p,y){var v=c.call(this,p,y);return v!==!1&&d.delete(p),v}})),d.size&&d.forEach(function(p){return n.maybeBroadcastWatch.dirty(p)})):this.broadcastWatches(t),l},e.prototype.performTransaction=function(t,n){return this.batch({update:t,optimistic:n||n!==null})},e.prototype.transformDocument=function(t){return this.addTypenameToDocument(this.addFragmentsToDocument(t))},e.prototype.fragmentMatches=function(t,n){return this.policies.fragmentMatches(t,n)},e.prototype.lookupFragment=function(t){var n;return((n=this.config.fragments)===null||n===void 0?void 0:n.lookup(t))||null},e.prototype.broadcastWatches=function(t){var n=this;this.txCount||this.watches.forEach(function(i){return n.maybeBroadcastWatch(i,t)})},e.prototype.addFragmentsToDocument=function(t){var n=this.config.fragments;return n?n.transform(t):t},e.prototype.addTypenameToDocument=function(t){return this.addTypename?this.addTypenameTransform.transformDocument(t):t},e.prototype.broadcastWatch=function(t,n){var i=t.lastDiff,s=this.diff(t);n&&(t.optimistic&&typeof n.optimistic=="string"&&(s.fromOptimisticTransaction=!0),n.onWatchUpdated&&n.onWatchUpdated.call(this,t,s,i)===!1)||(!i||!ie(i.result,s.result))&&t.callback(t.lastDiff=s,i)},e}(vu);globalThis.__DEV__!==!1&&(zu.prototype.getMemoryInternals=uh);var te;(function(r){r[r.loading=1]="loading",r[r.setVariables=2]="setVariables",r[r.fetchMore=3]="fetchMore",r[r.refetch=4]="refetch",r[r.poll=6]="poll",r[r.ready=7]="ready",r[r.error=8]="error"})(te||(te={}));function nn(r){return r?r<7:!1}var Ku=Object.assign,cd=Object.hasOwnProperty,vs=function(r){He(e,r);function e(t){var n=t.queryManager,i=t.queryInfo,s=t.options,o=r.call(this,function(w){try{var b=w._subscription._observer;b&&!b.error&&(b.error=ld)}catch{}var k=!o.observers.size;o.observers.add(w);var S=o.last;return S&&S.error?w.error&&w.error(S.error):S&&S.result&&w.next&&w.next(o.maskResult(S.result)),k&&o.reobserve().catch(function(){}),function(){o.observers.delete(w)&&!o.observers.size&&o.tearDownQuery()}})||this;o.observers=new Set,o.subscriptions=new Set,o.queryInfo=i,o.queryManager=n,o.waitForOwnResult=bs(s.fetchPolicy),o.isTornDown=!1,o.subscribeToMore=o.subscribeToMore.bind(o),o.maskResult=o.maskResult.bind(o);var a=n.defaultOptions.watchQuery,c=a===void 0?{}:a,l=c.fetchPolicy,u=l===void 0?"cache-first":l,d=s.fetchPolicy,p=d===void 0?u:d,y=s.initialFetchPolicy,v=y===void 0?p==="standby"?u:p:y;o.options=T(T({},s),{initialFetchPolicy:v,fetchPolicy:p}),o.queryId=i.queryId||n.generateQueryId();var E=Qt(o.query);return o.queryName=E&&E.name&&E.name.value,o}return Object.defineProperty(e.prototype,"query",{get:function(){return this.lastQuery||this.options.query},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"variables",{get:function(){return this.options.variables},enumerable:!1,configurable:!0}),e.prototype.result=function(){var t=this;return new Promise(function(n,i){var s={next:function(a){n(a),t.observers.delete(s),t.observers.size||t.queryManager.removeQuery(t.queryId),setTimeout(function(){o.unsubscribe()},0)},error:i},o=t.subscribe(s)})},e.prototype.resetDiff=function(){this.queryInfo.resetDiff()},e.prototype.getCurrentFullResult=function(t){t===void 0&&(t=!0);var n=this.getLastResult(!0),i=this.queryInfo.networkStatus||n&&n.networkStatus||te.ready,s=T(T({},n),{loading:nn(i),networkStatus:i}),o=this.options.fetchPolicy,a=o===void 0?"cache-first":o;if(!(bs(a)||this.queryManager.getDocumentInfo(this.query).hasForcedResolvers))if(this.waitForOwnResult)this.queryInfo.updateWatch();else{var c=this.queryInfo.getDiff();(c.complete||this.options.returnPartialData)&&(s.data=c.result),ie(s.data,{})&&(s.data=void 0),c.complete?(delete s.partial,c.complete&&s.networkStatus===te.loading&&(a==="cache-first"||a==="cache-only")&&(s.networkStatus=te.ready,s.loading=!1)):s.partial=!0,globalThis.__DEV__!==!1&&!c.complete&&!this.options.partialRefetch&&!s.loading&&!s.data&&!s.error&&Ju(c.missing)}return t&&this.updateLastResult(s),s},e.prototype.getCurrentResult=function(t){return t===void 0&&(t=!0),this.maskResult(this.getCurrentFullResult(t))},e.prototype.isDifferentFromLastResult=function(t,n){if(!this.last)return!0;var i=this.queryManager.getDocumentInfo(this.query),s=this.queryManager.dataMasking,o=s?i.nonReactiveQuery:this.query,a=s||i.hasNonreactiveDirective?!lu(o,this.last.result,t,this.variables):!ie(this.last.result,t);return a||n&&!ie(this.last.variables,n)},e.prototype.getLast=function(t,n){var i=this.last;if(i&&i[t]&&(!n||ie(i.variables,this.variables)))return i[t]},e.prototype.getLastResult=function(t){return this.getLast("result",t)},e.prototype.getLastError=function(t){return this.getLast("error",t)},e.prototype.resetLastResults=function(){delete this.last,this.isTornDown=!1},e.prototype.resetQueryStoreErrors=function(){this.queryManager.resetErrors(this.queryId)},e.prototype.refetch=function(t){var n,i={pollInterval:0},s=this.options.fetchPolicy;if(s==="cache-and-network"?i.fetchPolicy=s:s==="no-cache"?i.fetchPolicy="no-cache":i.fetchPolicy="network-only",globalThis.__DEV__!==!1&&t&&cd.call(t,"variables")){var o=ya(this.query),a=o.variableDefinitions;(!a||!a.some(function(c){return c.variable.name.value==="variables"}))&&globalThis.__DEV__!==!1&&$.warn(21,t,((n=o.name)===null||n===void 0?void 0:n.value)||o)}return t&&!ie(this.options.variables,t)&&(i.variables=this.options.variables=T(T({},this.options.variables),t)),this.queryInfo.resetLastWrite(),this.reobserve(i,te.refetch)},e.prototype.fetchMore=function(t){var n=this,i=T(T({},t.query?t:T(T(T(T({},this.options),{query:this.options.query}),t),{variables:T(T({},this.options.variables),t.variables)})),{fetchPolicy:"no-cache"});i.query=this.transformDocument(i.query);var s=this.queryManager.generateQueryId();this.lastQuery=t.query?this.transformDocument(this.options.query):i.query;var o=this.queryInfo,a=o.networkStatus;o.networkStatus=te.fetchMore,i.notifyOnNetworkStatusChange&&this.observe();var c=new Set,l=t?.updateQuery,u=this.options.fetchPolicy!=="no-cache";return u||$(l,22),this.queryManager.fetchQuery(s,i,te.fetchMore).then(function(d){if(n.queryManager.removeQuery(s),o.networkStatus===te.fetchMore&&(o.networkStatus=a),u)n.queryManager.cache.batch({update:function(v){var E=t.updateQuery;E?v.updateQuery({query:n.query,variables:n.variables,returnPartialData:!0,optimistic:!1},function(w){return E(w,{fetchMoreResult:d.data,variables:i.variables})}):v.writeQuery({query:i.query,variables:i.variables,data:d.data})},onWatchUpdated:function(v){c.add(v.query)}});else{var p=n.getLast("result"),y=l(p.data,{fetchMoreResult:d.data,variables:i.variables});n.reportResult(T(T({},p),{data:y}),n.variables)}return n.maskResult(d)}).finally(function(){u&&!c.has(n.query)&&Gu(n)})},e.prototype.subscribeToMore=function(t){var n=this,i=this.queryManager.startGraphQLSubscription({query:t.document,variables:t.variables,context:t.context}).subscribe({next:function(s){var o=t.updateQuery;o&&n.updateQuery(function(a,c){var l=c.variables;return o(a,{subscriptionData:s,variables:l})})},error:function(s){if(t.onError){t.onError(s);return}globalThis.__DEV__!==!1&&$.error(23,s)}});return this.subscriptions.add(i),function(){n.subscriptions.delete(i)&&i.unsubscribe()}},e.prototype.setOptions=function(t){return this.reobserve(t)},e.prototype.silentSetOptions=function(t){var n=yr(this.options,t||{});Ku(this.options,n)},e.prototype.setVariables=function(t){return ie(this.variables,t)?this.observers.size?this.result():Promise.resolve():(this.options.variables=t,this.observers.size?this.reobserve({fetchPolicy:this.options.initialFetchPolicy,variables:t},te.setVariables):Promise.resolve())},e.prototype.updateQuery=function(t){var n=this.queryManager,i=n.cache.diff({query:this.options.query,variables:this.variables,returnPartialData:!0,optimistic:!1}).result,s=t(i,{variables:this.variables});s&&(n.cache.writeQuery({query:this.options.query,data:s,variables:this.variables}),n.broadcastQueries())},e.prototype.startPolling=function(t){this.options.pollInterval=t,this.updatePolling()},e.prototype.stopPolling=function(){this.options.pollInterval=0,this.updatePolling()},e.prototype.applyNextFetchPolicy=function(t,n){if(n.nextFetchPolicy){var i=n.fetchPolicy,s=i===void 0?"cache-first":i,o=n.initialFetchPolicy,a=o===void 0?s:o;s==="standby"||(typeof n.nextFetchPolicy=="function"?n.fetchPolicy=n.nextFetchPolicy(s,{reason:t,options:n,observable:this,initialFetchPolicy:a}):t==="variables-changed"?n.fetchPolicy=a:n.fetchPolicy=n.nextFetchPolicy)}return n.fetchPolicy},e.prototype.fetch=function(t,n,i){return this.queryManager.setObservableQuery(this),this.queryManager.fetchConcastWithInfo(this.queryId,t,n,i)},e.prototype.updatePolling=function(){var t=this;if(!this.queryManager.ssrMode){var n=this,i=n.pollingInfo,s=n.options.pollInterval;if(!s||!this.hasObservers()){i&&(clearTimeout(i.timeout),delete this.pollingInfo);return}if(!(i&&i.interval===s)){$(s,24);var o=i||(this.pollingInfo={});o.interval=s;var a=function(){var l,u;t.pollingInfo&&(!nn(t.queryInfo.networkStatus)&&!(!((u=(l=t.options).skipPollAttempt)===null||u===void 0)&&u.call(l))?t.reobserve({fetchPolicy:t.options.initialFetchPolicy==="no-cache"?"no-cache":"network-only"},te.poll).then(c,c):c())},c=function(){var l=t.pollingInfo;l&&(clearTimeout(l.timeout),l.timeout=setTimeout(a,l.interval))};c()}}},e.prototype.updateLastResult=function(t,n){n===void 0&&(n=this.variables);var i=this.getLastError();return i&&this.last&&!ie(n,this.last.variables)&&(i=void 0),this.last=T({result:this.queryManager.assumeImmutableResults?t:za(t),variables:n},i?{error:i}:null)},e.prototype.reobserveAsConcast=function(t,n){var i=this;this.isTornDown=!1;var s=n===te.refetch||n===te.fetchMore||n===te.poll,o=this.options.variables,a=this.options.fetchPolicy,c=yr(this.options,t||{}),l=s?c:Ku(this.options,c),u=this.transformDocument(l.query);this.lastQuery=u,s||(this.updatePolling(),t&&t.variables&&!ie(t.variables,o)&&l.fetchPolicy!=="standby"&&(l.fetchPolicy===a||typeof l.nextFetchPolicy=="function")&&(this.applyNextFetchPolicy("variables-changed",l),n===void 0&&(n=te.setVariables))),this.waitForOwnResult&&(this.waitForOwnResult=bs(l.fetchPolicy));var d=function(){i.concast===v&&(i.waitForOwnResult=!1)},p=l.variables&&T({},l.variables),y=this.fetch(l,n,u),v=y.concast,E=y.fromLink,w={next:function(b){ie(i.variables,p)&&(d(),i.reportResult(b,p))},error:function(b){ie(i.variables,p)&&(tu(b)||(b=new Rt({networkError:b})),d(),i.reportError(b,p))}};return!s&&(E||!this.concast)&&(this.concast&&this.observer&&this.concast.removeObserver(this.observer),this.concast=v,this.observer=w),v.addObserver(w),v},e.prototype.reobserve=function(t,n){return ep(this.reobserveAsConcast(t,n).promise.then(this.maskResult))},e.prototype.resubscribeAfterError=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=this.last;this.resetLastResults();var s=this.subscribe.apply(this,t);return this.last=i,s},e.prototype.observe=function(){this.reportResult(this.getCurrentFullResult(!1),this.variables)},e.prototype.reportResult=function(t,n){var i=this.getLastError(),s=this.isDifferentFromLastResult(t,n);(i||!t.partial||this.options.returnPartialData)&&this.updateLastResult(t,n),(i||s)&&Yr(this.observers,"next",this.maskResult(t))},e.prototype.reportError=function(t,n){var i=T(T({},this.getLastResult()),{error:t,errors:t.graphQLErrors,networkStatus:te.error,loading:!1});this.updateLastResult(i,n),Yr(this.observers,"error",this.last.error=t)},e.prototype.hasObservers=function(){return this.observers.size>0},e.prototype.tearDownQuery=function(){this.isTornDown||(this.concast&&this.observer&&(this.concast.removeObserver(this.observer),delete this.concast,delete this.observer),this.stopPolling(),this.subscriptions.forEach(function(t){return t.unsubscribe()}),this.subscriptions.clear(),this.queryManager.stopQuery(this.queryId),this.observers.clear(),this.isTornDown=!0)},e.prototype.transformDocument=function(t){return this.queryManager.transform(t)},e.prototype.maskResult=function(t){return t&&"data"in t?T(T({},t),{data:this.queryManager.maskOperation({document:this.query,data:t.data,fetchPolicy:this.options.fetchPolicy,id:this.queryId})}):t},e}(Z);Ka(vs);function Gu(r){var e=r.options,t=e.fetchPolicy,n=e.nextFetchPolicy;return t==="cache-and-network"||t==="network-only"?r.reobserve({fetchPolicy:"cache-first",nextFetchPolicy:function(i,s){return this.nextFetchPolicy=n,typeof this.nextFetchPolicy=="function"?this.nextFetchPolicy(i,s):t}}):r.reobserve()}function ld(r){globalThis.__DEV__!==!1&&$.error(25,r.message,r.stack)}function Ju(r){globalThis.__DEV__!==!1&&r&&globalThis.__DEV__!==!1&&$.debug(26,r)}function bs(r){return r==="network-only"||r==="no-cache"||r==="standby"}var vr=new(jt?WeakMap:Map);function ws(r,e){var t=r[e];typeof t=="function"&&(r[e]=function(){return vr.set(r,(vr.get(r)+1)%1e15),t.apply(this,arguments)})}function Yu(r){r.notifyTimeout&&(clearTimeout(r.notifyTimeout),r.notifyTimeout=void 0)}var Es=function(){function r(e,t){t===void 0&&(t=e.generateQueryId()),this.queryId=t,this.listeners=new Set,this.document=null,this.lastRequestId=1,this.stopped=!1,this.dirty=!1,this.observableQuery=null;var n=this.cache=e.cache;vr.has(n)||(vr.set(n,0),ws(n,"evict"),ws(n,"modify"),ws(n,"reset"))}return r.prototype.init=function(e){var t=e.networkStatus||te.loading;return this.variables&&this.networkStatus!==te.loading&&!ie(this.variables,e.variables)&&(t=te.setVariables),ie(e.variables,this.variables)||(this.lastDiff=void 0),Object.assign(this,{document:e.document,variables:e.variables,networkError:null,graphQLErrors:this.graphQLErrors||[],networkStatus:t}),e.observableQuery&&this.setObservableQuery(e.observableQuery),e.lastRequestId&&(this.lastRequestId=e.lastRequestId),this},r.prototype.reset=function(){Yu(this),this.dirty=!1},r.prototype.resetDiff=function(){this.lastDiff=void 0},r.prototype.getDiff=function(){var e=this.getDiffOptions();if(this.lastDiff&&ie(e,this.lastDiff.options))return this.lastDiff.diff;this.updateWatch(this.variables);var t=this.observableQuery;if(t&&t.options.fetchPolicy==="no-cache")return{complete:!1};var n=this.cache.diff(e);return this.updateLastDiff(n,e),n},r.prototype.updateLastDiff=function(e,t){this.lastDiff=e?{diff:e,options:t||this.getDiffOptions()}:void 0},r.prototype.getDiffOptions=function(e){var t;return e===void 0&&(e=this.variables),{query:this.document,variables:e,returnPartialData:!0,optimistic:!0,canonizeResults:(t=this.observableQuery)===null||t===void 0?void 0:t.options.canonizeResults}},r.prototype.setDiff=function(e){var t=this,n,i=this.lastDiff&&this.lastDiff.diff;e&&!e.complete&&(!((n=this.observableQuery)===null||n===void 0)&&n.getLastError())||(this.updateLastDiff(e),!this.dirty&&!ie(i&&i.result,e&&e.result)&&(this.dirty=!0,this.notifyTimeout||(this.notifyTimeout=setTimeout(function(){return t.notify()},0))))},r.prototype.setObservableQuery=function(e){var t=this;e!==this.observableQuery&&(this.oqListener&&this.listeners.delete(this.oqListener),this.observableQuery=e,e?(e.queryInfo=this,this.listeners.add(this.oqListener=function(){var n=t.getDiff();n.fromOptimisticTransaction?e.observe():Gu(e)})):delete this.oqListener)},r.prototype.notify=function(){var e=this;Yu(this),this.shouldNotify()&&this.listeners.forEach(function(t){return t(e)}),this.dirty=!1},r.prototype.shouldNotify=function(){if(!this.dirty||!this.listeners.size)return!1;if(nn(this.networkStatus)&&this.observableQuery){var e=this.observableQuery.options.fetchPolicy;if(e!=="cache-only"&&e!=="cache-and-network")return!1}return!0},r.prototype.stop=function(){if(!this.stopped){this.stopped=!0,this.reset(),this.cancel(),this.cancel=r.prototype.cancel;var e=this.observableQuery;e&&e.stopPolling()}},r.prototype.cancel=function(){},r.prototype.updateWatch=function(e){var t=this;e===void 0&&(e=this.variables);var n=this.observableQuery;if(!(n&&n.options.fetchPolicy==="no-cache")){var i=T(T({},this.getDiffOptions(e)),{watcher:this,callback:function(s){return t.setDiff(s)}});(!this.lastWatch||!ie(i,this.lastWatch))&&(this.cancel(),this.cancel=this.cache.watch(this.lastWatch=i))}},r.prototype.resetLastWrite=function(){this.lastWrite=void 0},r.prototype.shouldWrite=function(e,t){var n=this.lastWrite;return!(n&&n.dmCount===vr.get(this.cache)&&ie(t,n.variables)&&ie(e.data,n.result.data))},r.prototype.markResult=function(e,t,n,i){var s=this,o=new Ct,a=ot(e.errors)?e.errors.slice(0):[];if(this.reset(),"incremental"in e&&ot(e.incremental)){var c=Ja(this.getDiff().result,e);e.data=c}else if("hasNext"in e&&e.hasNext){var l=this.getDiff();e.data=o.merge(l.result,e.data)}this.graphQLErrors=a,n.fetchPolicy==="no-cache"?this.updateLastDiff({result:e.data,complete:!0},this.getDiffOptions(n.variables)):i!==0&&(_s(e,n.errorPolicy)?this.cache.performTransaction(function(u){if(s.shouldWrite(e,n.variables))u.writeQuery({query:t,data:e.data,variables:n.variables,overwrite:i===1}),s.lastWrite={result:e,variables:n.variables,dmCount:vr.get(s.cache)};else if(s.lastDiff&&s.lastDiff.diff.complete){e.data=s.lastDiff.diff.result;return}var d=s.getDiffOptions(n.variables),p=u.diff(d);!s.stopped&&ie(s.variables,n.variables)&&s.updateWatch(n.variables),s.updateLastDiff(p,d),p.complete&&(e.data=p.result)}):this.lastWrite=void 0)},r.prototype.markReady=function(){return this.networkError=null,this.networkStatus=te.ready},r.prototype.markError=function(e){return this.networkStatus=te.error,this.lastWrite=void 0,this.reset(),e.graphQLErrors&&(this.graphQLErrors=e.graphQLErrors),e.networkError&&(this.networkError=e.networkError),e},r}();function _s(r,e){e===void 0&&(e="none");var t=e==="ignore"||e==="all",n=!Qn(r);return!n&&t&&r.data&&(n=!0),n}var fd=Object.prototype.hasOwnProperty,Xu=Object.create(null),hd=function(){function r(e){var t=this;this.clientAwareness={},this.queries=new Map,this.fetchCancelFns=new Map,this.transformCache=new ca(yt["queryManager.getDocumentInfo"]||2e3),this.queryIdCounter=1,this.requestIdCounter=1,this.mutationIdCounter=1,this.inFlightLinkObservables=new dt(!1),this.noCacheWarningsByQueryId=new Set;var n=new Ma(function(s){return t.cache.transformDocument(s)},{cache:!1});this.cache=e.cache,this.link=e.link,this.defaultOptions=e.defaultOptions,this.queryDeduplication=e.queryDeduplication,this.clientAwareness=e.clientAwareness,this.localState=e.localState,this.ssrMode=e.ssrMode,this.assumeImmutableResults=e.assumeImmutableResults,this.dataMasking=e.dataMasking;var i=e.documentTransform;this.documentTransform=i?n.concat(i).concat(n):n,this.defaultContext=e.defaultContext||Object.create(null),(this.onBroadcast=e.onBroadcast)&&(this.mutationStore=Object.create(null))}return r.prototype.stop=function(){var e=this;this.queries.forEach(function(t,n){e.stopQueryNoBroadcast(n)}),this.cancelPendingFetches(Fe(27))},r.prototype.cancelPendingFetches=function(e){this.fetchCancelFns.forEach(function(t){return t(e)}),this.fetchCancelFns.clear()},r.prototype.mutate=function(e){return St(this,arguments,void 0,function(t){var n,i,s,o,a,c,l,u=t.mutation,d=t.variables,p=t.optimisticResponse,y=t.updateQueries,v=t.refetchQueries,E=v===void 0?[]:v,w=t.awaitRefetchQueries,b=w===void 0?!1:w,k=t.update,S=t.onQueryUpdated,I=t.fetchPolicy,O=I===void 0?((c=this.defaultOptions.mutate)===null||c===void 0?void 0:c.fetchPolicy)||"network-only":I,C=t.errorPolicy,M=C===void 0?((l=this.defaultOptions.mutate)===null||l===void 0?void 0:l.errorPolicy)||"none":C,F=t.keepRootFields,L=t.context;return kt(this,function(V){switch(V.label){case 0:return $(u,28),$(O==="network-only"||O==="no-cache",29),n=this.generateMutationId(),u=this.cache.transformForLink(this.transform(u)),i=this.getDocumentInfo(u).hasClientExports,d=this.getVariables(u,d),i?[4,this.localState.addExportedVariables(u,d,L)]:[3,2];case 1:d=V.sent(),V.label=2;case 2:return s=this.mutationStore&&(this.mutationStore[n]={mutation:u,variables:d,loading:!0,error:null}),o=p&&this.markMutationOptimistic(p,{mutationId:n,document:u,variables:d,fetchPolicy:O,errorPolicy:M,context:L,updateQueries:y,update:k,keepRootFields:F}),this.broadcastQueries(),a=this,[2,new Promise(function(G,Se){return Xi(a.getObservableFromLink(u,T(T({},L),{optimisticResponse:o?p:void 0}),d,{},!1),function(se){if(Qn(se)&&M==="none")throw new Rt({graphQLErrors:Zi(se)});s&&(s.loading=!1,s.error=null);var ke=T({},se);return typeof E=="function"&&(E=E(ke)),M==="ignore"&&Qn(ke)&&delete ke.errors,a.markMutationResult({mutationId:n,result:ke,document:u,variables:d,fetchPolicy:O,errorPolicy:M,context:L,update:k,updateQueries:y,awaitRefetchQueries:b,refetchQueries:E,removeOptimistic:o?n:void 0,onQueryUpdated:S,keepRootFields:F})}).subscribe({next:function(se){a.broadcastQueries(),(!("hasNext"in se)||se.hasNext===!1)&&G(T(T({},se),{data:a.maskOperation({document:u,data:se.data,fetchPolicy:O,id:n})}))},error:function(se){s&&(s.loading=!1,s.error=se),o&&a.cache.removeOptimistic(n),a.broadcastQueries(),Se(se instanceof Rt?se:new Rt({networkError:se}))}})})]}})})},r.prototype.markMutationResult=function(e,t){var n=this;t===void 0&&(t=this.cache);var i=e.result,s=[],o=e.fetchPolicy==="no-cache";if(!o&&_s(i,e.errorPolicy)){if(dr(i)||s.push({result:i.data,dataId:"ROOT_MUTATION",query:e.document,variables:e.variables}),dr(i)&&ot(i.incremental)){var a=t.diff({id:"ROOT_MUTATION",query:this.getDocumentInfo(e.document).asQuery,variables:e.variables,optimistic:!1,returnPartialData:!0}),c=void 0;a.result&&(c=Ja(a.result,i)),typeof c<"u"&&(i.data=c,s.push({result:c,dataId:"ROOT_MUTATION",query:e.document,variables:e.variables}))}var l=e.updateQueries;l&&this.queries.forEach(function(d,p){var y=d.observableQuery,v=y&&y.queryName;if(!(!v||!fd.call(l,v))){var E=l[v],w=n.queries.get(p),b=w.document,k=w.variables,S=t.diff({query:b,variables:k,returnPartialData:!0,optimistic:!1}),I=S.result,O=S.complete;if(O&&I){var C=E(I,{mutationResult:i,queryName:b&&Wr(b)||void 0,queryVariables:k});C&&s.push({result:C,dataId:"ROOT_QUERY",query:b,variables:k})}}})}if(s.length>0||(e.refetchQueries||"").length>0||e.update||e.onQueryUpdated||e.removeOptimistic){var u=[];if(this.refetchQueries({updateCache:function(d){o||s.forEach(function(E){return d.write(E)});var p=e.update,y=!sp(i)||dr(i)&&!i.hasNext;if(p){if(!o){var v=d.diff({id:"ROOT_MUTATION",query:n.getDocumentInfo(e.document).asQuery,variables:e.variables,optimistic:!1,returnPartialData:!0});v.complete&&(i=T(T({},i),{data:v.result}),"incremental"in i&&delete i.incremental,"hasNext"in i&&delete i.hasNext)}y&&p(d,i,{context:e.context,variables:e.variables})}!o&&!e.keepRootFields&&y&&d.modify({id:"ROOT_MUTATION",fields:function(E,w){var b=w.fieldName,k=w.DELETE;return b==="__typename"?E:k}})},include:e.refetchQueries,optimistic:!1,removeOptimistic:e.removeOptimistic,onQueryUpdated:e.onQueryUpdated||null}).forEach(function(d){return u.push(d)}),e.awaitRefetchQueries||e.onQueryUpdated)return Promise.all(u).then(function(){return i})}return Promise.resolve(i)},r.prototype.markMutationOptimistic=function(e,t){var n=this,i=typeof e=="function"?e(t.variables,{IGNORE:Xu}):e;return i===Xu?!1:(this.cache.recordOptimisticTransaction(function(s){try{n.markMutationResult(T(T({},t),{result:{data:i}}),s)}catch(o){globalThis.__DEV__!==!1&&$.error(o)}},t.mutationId),!0)},r.prototype.fetchQuery=function(e,t,n){return this.fetchConcastWithInfo(e,t,n).concast.promise},r.prototype.getQueryStore=function(){var e=Object.create(null);return this.queries.forEach(function(t,n){e[n]={variables:t.variables,networkStatus:t.networkStatus,networkError:t.networkError,graphQLErrors:t.graphQLErrors}}),e},r.prototype.resetErrors=function(e){var t=this.queries.get(e);t&&(t.networkError=void 0,t.graphQLErrors=[])},r.prototype.transform=function(e){return this.documentTransform.transformDocument(e)},r.prototype.getDocumentInfo=function(e){var t=this.transformCache;if(!t.has(e)){var n={hasClientExports:jf(e),hasForcedResolvers:this.localState.shouldForceResolvers(e),hasNonreactiveDirective:Qr(["nonreactive"],e),nonReactiveQuery:Vh(e),clientQuery:this.localState.clientQuery(e),serverQuery:Pa([{name:"client",remove:!0},{name:"connection"},{name:"nonreactive"},{name:"unmask"}],e),defaultVars:Bi(Qt(e)),asQuery:T(T({},e),{definitions:e.definitions.map(function(i){return i.kind==="OperationDefinition"&&i.operation!=="query"?T(T({},i),{operation:"query"}):i})})};t.set(e,n)}return t.get(e)},r.prototype.getVariables=function(e,t){return T(T({},this.getDocumentInfo(e).defaultVars),t)},r.prototype.watchQuery=function(e){var t=this.transform(e.query);e=T(T({},e),{variables:this.getVariables(t,e.variables)}),typeof e.notifyOnNetworkStatusChange>"u"&&(e.notifyOnNetworkStatusChange=!1);var n=new Es(this),i=new vs({queryManager:this,queryInfo:n,options:e});return i.lastQuery=t,this.queries.set(i.queryId,n),n.init({document:t,observableQuery:i,variables:i.variables}),i},r.prototype.query=function(e,t){var n=this;t===void 0&&(t=this.generateQueryId()),$(e.query,30),$(e.query.kind==="Document",31),$(!e.returnPartialData,32),$(!e.pollInterval,33);var i=this.transform(e.query);return this.fetchQuery(t,T(T({},e),{query:i})).then(function(s){return s&&T(T({},s),{data:n.maskOperation({document:i,data:s.data,fetchPolicy:e.fetchPolicy,id:t})})}).finally(function(){return n.stopQuery(t)})},r.prototype.generateQueryId=function(){return String(this.queryIdCounter++)},r.prototype.generateRequestId=function(){return this.requestIdCounter++},r.prototype.generateMutationId=function(){return String(this.mutationIdCounter++)},r.prototype.stopQueryInStore=function(e){this.stopQueryInStoreNoBroadcast(e),this.broadcastQueries()},r.prototype.stopQueryInStoreNoBroadcast=function(e){var t=this.queries.get(e);t&&t.stop()},r.prototype.clearStore=function(e){return e===void 0&&(e={discardWatches:!0}),this.cancelPendingFetches(Fe(34)),this.queries.forEach(function(t){t.observableQuery?t.networkStatus=te.loading:t.stop()}),this.mutationStore&&(this.mutationStore=Object.create(null)),this.cache.reset(e)},r.prototype.getObservableQueries=function(e){var t=this;e===void 0&&(e="active");var n=new Map,i=new Map,s=new Map,o=new Set;return Array.isArray(e)&&e.forEach(function(a){if(typeof a=="string")i.set(a,a),s.set(a,!1);else if(mh(a)){var c=Ot(t.transform(a));i.set(c,Wr(a)),s.set(c,!1)}else ue(a)&&a.query&&o.add(a)}),this.queries.forEach(function(a,c){var l=a.observableQuery,u=a.document;if(l){if(e==="all"){n.set(c,l);return}var d=l.queryName,p=l.options.fetchPolicy;if(p==="standby"||e==="active"&&!l.hasObservers())return;(e==="active"||d&&s.has(d)||u&&s.has(Ot(u)))&&(n.set(c,l),d&&s.set(d,!0),u&&s.set(Ot(u),!0))}}),o.size&&o.forEach(function(a){var c=wi("legacyOneTimeQuery"),l=t.getQuery(c).init({document:a.query,variables:a.variables}),u=new vs({queryManager:t,queryInfo:l,options:T(T({},a),{fetchPolicy:"network-only"})});$(u.queryId===c),l.setObservableQuery(u),n.set(c,u)}),globalThis.__DEV__!==!1&&s.size&&s.forEach(function(a,c){if(!a){var l=i.get(c);l?globalThis.__DEV__!==!1&&$.warn(35,l):globalThis.__DEV__!==!1&&$.warn(36)}}),n},r.prototype.reFetchObservableQueries=function(e){var t=this;e===void 0&&(e=!1);var n=[];return this.getObservableQueries(e?"all":"active").forEach(function(i,s){var o=i.options.fetchPolicy;i.resetLastResults(),(e||o!=="standby"&&o!=="cache-only")&&n.push(i.refetch()),t.getQuery(s).setDiff(null)}),this.broadcastQueries(),Promise.all(n)},r.prototype.setObservableQuery=function(e){this.getQuery(e.queryId).setObservableQuery(e)},r.prototype.startGraphQLSubscription=function(e){var t=this,n=e.query,i=e.variables,s=e.fetchPolicy,o=e.errorPolicy,a=o===void 0?"none":o,c=e.context,l=c===void 0?{}:c,u=e.extensions,d=u===void 0?{}:u;n=this.transform(n),i=this.getVariables(n,i);var p=function(v){return t.getObservableFromLink(n,l,v,d).map(function(E){s!=="no-cache"&&(_s(E,a)&&t.cache.write({query:n,result:E.data,dataId:"ROOT_SUBSCRIPTION",variables:v}),t.broadcastQueries());var w=Qn(E),b=_p(E);if(w||b){var k={};if(w&&(k.graphQLErrors=E.errors),b&&(k.protocolErrors=E.extensions[ns]),a==="none"||b)throw new Rt(k)}return a==="ignore"&&delete E.errors,E})};if(this.getDocumentInfo(n).hasClientExports){var y=this.localState.addExportedVariables(n,i,l).then(p);return new Z(function(v){var E=null;return y.then(function(w){return E=w.subscribe(v)},v.error),function(){return E&&E.unsubscribe()}})}return p(i)},r.prototype.stopQuery=function(e){this.stopQueryNoBroadcast(e),this.broadcastQueries()},r.prototype.stopQueryNoBroadcast=function(e){this.stopQueryInStoreNoBroadcast(e),this.removeQuery(e)},r.prototype.removeQuery=function(e){this.fetchCancelFns.delete(e),this.queries.has(e)&&(this.getQuery(e).stop(),this.queries.delete(e))},r.prototype.broadcastQueries=function(){this.onBroadcast&&this.onBroadcast(),this.queries.forEach(function(e){return e.notify()})},r.prototype.getLocalState=function(){return this.localState},r.prototype.getObservableFromLink=function(e,t,n,i,s){var o=this,a;s===void 0&&(s=(a=t?.queryDeduplication)!==null&&a!==void 0?a:this.queryDeduplication);var c,l=this.getDocumentInfo(e),u=l.serverQuery,d=l.clientQuery;if(u){var p=this,y=p.inFlightLinkObservables,v=p.link,E={query:u,variables:n,operationName:Wr(u)||void 0,context:this.prepareContext(T(T({},t),{forceFetch:!s})),extensions:i};if(t=E.context,s){var w=Ot(u),b=xt(n),k=y.lookup(w,b);if(c=k.observable,!c){var S=new pr([rs(v,E)]);c=k.observable=S,S.beforeNext(function(){y.remove(w,b)})}}else c=new pr([rs(v,E)])}else c=new pr([Z.of({data:{}})]),t=this.prepareContext(t);return d&&(c=Xi(c,function(I){return o.localState.runResolvers({document:d,remoteResult:I,context:t,variables:n})})),c},r.prototype.getResultsFromLink=function(e,t,n){var i=e.lastRequestId=this.generateRequestId(),s=this.cache.transformForLink(n.query);return Xi(this.getObservableFromLink(s,n.context,n.variables),function(o){var a=Zi(o),c=a.length>0,l=n.errorPolicy;if(i>=e.lastRequestId){if(c&&l==="none")throw e.markError(new Rt({graphQLErrors:a}));e.markResult(o,s,n,t),e.markReady()}var u={data:o.data,loading:!1,networkStatus:te.ready};return c&&l==="none"&&(u.data=void 0),c&&l!=="ignore"&&(u.errors=a,u.networkStatus=te.error),u},function(o){var a=tu(o)?o:new Rt({networkError:o});throw i>=e.lastRequestId&&e.markError(a),a})},r.prototype.fetchConcastWithInfo=function(e,t,n,i){var s=this;n===void 0&&(n=te.loading),i===void 0&&(i=t.query);var o=this.getVariables(i,t.variables),a=this.getQuery(e),c=this.defaultOptions.watchQuery,l=t.fetchPolicy,u=l===void 0?c&&c.fetchPolicy||"cache-first":l,d=t.errorPolicy,p=d===void 0?c&&c.errorPolicy||"none":d,y=t.returnPartialData,v=y===void 0?!1:y,E=t.notifyOnNetworkStatusChange,w=E===void 0?!1:E,b=t.context,k=b===void 0?{}:b,S=Object.assign({},t,{query:i,variables:o,fetchPolicy:u,errorPolicy:p,returnPartialData:v,notifyOnNetworkStatusChange:w,context:k}),I=function(L){S.variables=L;var V=s.fetchQueryByPolicy(a,S,n);return S.fetchPolicy!=="standby"&&V.sources.length>0&&a.observableQuery&&a.observableQuery.applyNextFetchPolicy("after-fetch",t),V},O=function(){return s.fetchCancelFns.delete(e)};this.fetchCancelFns.set(e,function(L){O(),setTimeout(function(){return C.cancel(L)})});var C,M;if(this.getDocumentInfo(S.query).hasClientExports)C=new pr(this.localState.addExportedVariables(S.query,S.variables,S.context).then(I).then(function(L){return L.sources})),M=!0;else{var F=I(S.variables);M=F.fromLink,C=new pr(F.sources)}return C.promise.then(O,O),{concast:C,fromLink:M}},r.prototype.refetchQueries=function(e){var t=this,n=e.updateCache,i=e.include,s=e.optimistic,o=s===void 0?!1:s,a=e.removeOptimistic,c=a===void 0?o?wi("refetchQueries"):void 0:a,l=e.onQueryUpdated,u=new Map;i&&this.getObservableQueries(i).forEach(function(p,y){u.set(y,{oq:p,lastDiff:t.getQuery(y).getDiff()})});var d=new Map;return n&&this.cache.batch({update:n,optimistic:o&&c||!1,removeOptimistic:c,onWatchUpdated:function(p,y,v){var E=p.watcher instanceof Es&&p.watcher.observableQuery;if(E){if(l){u.delete(E.queryId);var w=l(E,y,v);return w===!0&&(w=E.refetch()),w!==!1&&d.set(E,w),w}l!==null&&u.set(E.queryId,{oq:E,lastDiff:v,diff:y})}}}),u.size&&u.forEach(function(p,y){var v=p.oq,E=p.lastDiff,w=p.diff,b;if(l){if(!w){var k=v.queryInfo;k.reset(),w=k.getDiff()}b=l(v,w,E)}(!l||b===!0)&&(b=v.refetch()),b!==!1&&d.set(v,b),y.indexOf("legacyOneTimeQuery")>=0&&t.stopQueryNoBroadcast(y)}),c&&this.cache.removeOptimistic(c),d},r.prototype.maskOperation=function(e){var t,n,i,s=e.document,o=e.data;if(globalThis.__DEV__!==!1){var a=e.fetchPolicy,c=e.id,l=(t=Qt(s))===null||t===void 0?void 0:t.operation,u=((n=l?.[0])!==null&&n!==void 0?n:"o")+c;this.dataMasking&&a==="no-cache"&&!Xf(s)&&!this.noCacheWarningsByQueryId.has(u)&&(this.noCacheWarningsByQueryId.add(u),globalThis.__DEV__!==!1&&$.warn(37,(i=Wr(s))!==null&&i!==void 0?i:"Unnamed ".concat(l??"operation")))}return this.dataMasking?Wp(o,s,this.cache):o},r.prototype.maskFragment=function(e){var t=e.data,n=e.fragment,i=e.fragmentName;return this.dataMasking?gu(t,n,this.cache,i):t},r.prototype.fetchQueryByPolicy=function(e,t,n){var i=this,s=t.query,o=t.variables,a=t.fetchPolicy,c=t.refetchWritePolicy,l=t.errorPolicy,u=t.returnPartialData,d=t.context,p=t.notifyOnNetworkStatusChange,y=e.networkStatus;e.init({document:s,variables:o,networkStatus:n});var v=function(){return e.getDiff()},E=function(I,O){O===void 0&&(O=e.networkStatus||te.loading);var C=I.result;globalThis.__DEV__!==!1&&!u&&!ie(C,{})&&Ju(I.missing);var M=function(F){return Z.of(T({data:F,loading:nn(O),networkStatus:O},I.complete?null:{partial:!0}))};return C&&i.getDocumentInfo(s).hasForcedResolvers?i.localState.runResolvers({document:s,remoteResult:{data:C},context:d,variables:o,onlyRunForcedResolvers:!0}).then(function(F){return M(F.data||void 0)}):l==="none"&&O===te.refetch&&Array.isArray(I.missing)?M(void 0):M(C)},w=a==="no-cache"?0:n===te.refetch&&c!=="merge"?1:2,b=function(){return i.getResultsFromLink(e,w,{query:s,variables:o,context:d,fetchPolicy:a,errorPolicy:l})},k=p&&typeof y=="number"&&y!==n&&nn(n);switch(a){default:case"cache-first":{var S=v();return S.complete?{fromLink:!1,sources:[E(S,e.markReady())]}:u||k?{fromLink:!0,sources:[E(S),b()]}:{fromLink:!0,sources:[b()]}}case"cache-and-network":{var S=v();return S.complete||u||k?{fromLink:!0,sources:[E(S),b()]}:{fromLink:!0,sources:[b()]}}case"cache-only":return{fromLink:!1,sources:[E(v(),e.markReady())]};case"network-only":return k?{fromLink:!0,sources:[E(v()),b()]}:{fromLink:!0,sources:[b()]};case"no-cache":return k?{fromLink:!0,sources:[E(e.getDiff()),b()]}:{fromLink:!0,sources:[b()]};case"standby":return{fromLink:!1,sources:[]}}},r.prototype.getQuery=function(e){return e&&!this.queries.has(e)&&this.queries.set(e,new Es(this,e)),this.queries.get(e)},r.prototype.prepareContext=function(e){e===void 0&&(e={});var t=this.localState.prepareContext(e);return T(T(T({},this.defaultContext),t),{clientAwareness:this.clientAwareness})},r}(),pd=function(){function r(e){var t=e.cache,n=e.client,i=e.resolvers,s=e.fragmentMatcher;this.selectionsToResolveCache=new WeakMap,this.cache=t,n&&(this.client=n),i&&this.addResolvers(i),s&&this.setFragmentMatcher(s)}return r.prototype.addResolvers=function(e){var t=this;this.resolvers=this.resolvers||{},Array.isArray(e)?e.forEach(function(n){t.resolvers=La(t.resolvers,n)}):this.resolvers=La(this.resolvers,e)},r.prototype.setResolvers=function(e){this.resolvers={},this.addResolvers(e)},r.prototype.getResolvers=function(){return this.resolvers||{}},r.prototype.runResolvers=function(e){return St(this,arguments,void 0,function(t){var n=t.document,i=t.remoteResult,s=t.context,o=t.variables,a=t.onlyRunForcedResolvers,c=a===void 0?!1:a;return kt(this,function(l){return n?[2,this.resolveDocument(n,i.data,s,o,this.fragmentMatcher,c).then(function(u){return T(T({},i),{data:u.result})})]:[2,i]})})},r.prototype.setFragmentMatcher=function(e){this.fragmentMatcher=e},r.prototype.getFragmentMatcher=function(){return this.fragmentMatcher},r.prototype.clientQuery=function(e){return Qr(["client"],e)&&this.resolvers?e:null},r.prototype.serverQuery=function(e){return $a(e)},r.prototype.prepareContext=function(e){var t=this.cache;return T(T({},e),{cache:t,getCacheKey:function(n){return t.identify(n)}})},r.prototype.addExportedVariables=function(e){return St(this,arguments,void 0,function(t,n,i){return n===void 0&&(n={}),i===void 0&&(i={}),kt(this,function(s){return t?[2,this.resolveDocument(t,this.buildRootValueFromCache(t,n)||{},this.prepareContext(i),n).then(function(o){return T(T({},n),o.exportedVariables)})]:[2,T({},n)]})})},r.prototype.shouldForceResolvers=function(e){var t=!1;return Je(e,{Directive:{enter:function(n){if(n.name.value==="client"&&n.arguments&&(t=n.arguments.some(function(i){return i.name.value==="always"&&i.value.kind==="BooleanValue"&&i.value.value===!0}),t))return Nn}}}),t},r.prototype.buildRootValueFromCache=function(e,t){return this.cache.diff({query:jh(e),variables:t,returnPartialData:!0,optimistic:!1}).result},r.prototype.resolveDocument=function(e,t){return St(this,arguments,void 0,function(n,i,s,o,a,c){var l,u,d,p,y,v,E,w,b,k,S;return s===void 0&&(s={}),o===void 0&&(o={}),a===void 0&&(a=function(){return!0}),c===void 0&&(c=!1),kt(this,function(I){return l=cr(n),u=ur(n),d=nr(u),p=this.collectSelectionsToResolve(l,d),y=l.operation,v=y?y.charAt(0).toUpperCase()+y.slice(1):"Query",E=this,w=E.cache,b=E.client,k={fragmentMap:d,context:T(T({},s),{cache:w,client:b}),variables:o,fragmentMatcher:a,defaultOperationType:v,exportedVariables:{},selectionsToResolve:p,onlyRunForcedResolvers:c},S=!1,[2,this.resolveSelectionSet(l.selectionSet,S,i,k).then(function(O){return{result:O,exportedVariables:k.exportedVariables}})]})})},r.prototype.resolveSelectionSet=function(e,t,n,i){return St(this,void 0,void 0,function(){var s,o,a,c,l,u=this;return kt(this,function(d){return s=i.fragmentMap,o=i.context,a=i.variables,c=[n],l=function(p){return St(u,void 0,void 0,function(){var y,v;return kt(this,function(E){return!t&&!i.selectionsToResolve.has(p)?[2]:Vr(p,a)?It(p)?[2,this.resolveField(p,t,n,i).then(function(w){var b;typeof w<"u"&&c.push((b={},b[mt(p)]=w,b))})]:(Ah(p)?y=p:(y=s[p.name.value],$(y,19,p.name.value)),y&&y.typeCondition&&(v=y.typeCondition.name.value,i.fragmentMatcher(n,v,o))?[2,this.resolveSelectionSet(y.selectionSet,t,n,i).then(function(w){c.push(w)})]:[2]):[2]})})},[2,Promise.all(e.selections.map(l)).then(function(){return Un(c)})]})})},r.prototype.resolveField=function(e,t,n,i){return St(this,void 0,void 0,function(){var s,o,a,c,l,u,d,p,y,v=this;return kt(this,function(E){return n?(s=i.variables,o=e.name.value,a=mt(e),c=o!==a,l=n[a]||n[o],u=Promise.resolve(l),(!i.onlyRunForcedResolvers||this.shouldForceResolvers(e))&&(d=n.__typename||i.defaultOperationType,p=this.resolvers&&this.resolvers[d],p&&(y=p[c?o:a],y&&(u=Promise.resolve(fs.withValue(this.cache,y,[n,Pn(e,s),i.context,{field:e,fragmentMap:i.fragmentMap}]))))),[2,u.then(function(w){var b,k;if(w===void 0&&(w=l),e.directives&&e.directives.forEach(function(I){I.name.value==="export"&&I.arguments&&I.arguments.forEach(function(O){O.name.value==="as"&&O.value.kind==="StringValue"&&(i.exportedVariables[O.value.value]=w)})}),!e.selectionSet||w==null)return w;var S=(k=(b=e.directives)===null||b===void 0?void 0:b.some(function(I){return I.name.value==="client"}))!==null&&k!==void 0?k:!1;if(Array.isArray(w))return v.resolveSubSelectedArray(e,t||S,w,i);if(e.selectionSet)return v.resolveSelectionSet(e.selectionSet,t||S,w,i)})]):[2,null]})})},r.prototype.resolveSubSelectedArray=function(e,t,n,i){var s=this;return Promise.all(n.map(function(o){if(o===null)return null;if(Array.isArray(o))return s.resolveSubSelectedArray(e,t,o,i);if(e.selectionSet)return s.resolveSelectionSet(e.selectionSet,t,o,i)}))},r.prototype.collectSelectionsToResolve=function(e,t){var n=function(o){return!Array.isArray(o)},i=this.selectionsToResolveCache;function s(o){if(!i.has(o)){var a=new Set;i.set(o,a),Je(o,{Directive:function(c,l,u,d,p){c.name.value==="client"&&p.forEach(function(y){n(y)&&sa(y)&&a.add(y)})},FragmentSpread:function(c,l,u,d,p){var y=t[c.name.value];$(y,20,c.name.value);var v=s(y);v.size>0&&(p.forEach(function(E){n(E)&&sa(E)&&a.add(E)}),a.add(c),v.forEach(function(E){a.add(E)}))}})}return i.get(o)}return s(e)},r}(),Zu=!1,ec=function(){function r(e){var t=this,n;if(this.resetStoreCallbacks=[],this.clearStoreCallbacks=[],!e.cache)throw Fe(16);var i=e.uri,s=e.credentials,o=e.headers,a=e.cache,c=e.documentTransform,l=e.ssrMode,u=l===void 0?!1:l,d=e.ssrForceFetchDelay,p=d===void 0?0:d,y=e.connectToDevTools,v=e.queryDeduplication,E=v===void 0?!0:v,w=e.defaultOptions,b=e.defaultContext,k=e.assumeImmutableResults,S=k===void 0?a.assumeImmutableResults:k,I=e.resolvers,O=e.typeDefs,C=e.fragmentMatcher,M=e.name,F=e.version,L=e.devtools,V=e.dataMasking,G=e.link;G||(G=i?new $p({uri:i,credentials:s,headers:o}):We.empty()),this.link=G,this.cache=a,this.disableNetworkFetches=u||p>0,this.queryDeduplication=E,this.defaultOptions=w||Object.create(null),this.typeDefs=O,this.devtoolsConfig=T(T({},L),{enabled:(n=L?.enabled)!==null&&n!==void 0?n:y}),this.devtoolsConfig.enabled===void 0&&(this.devtoolsConfig.enabled=globalThis.__DEV__!==!1),p&&setTimeout(function(){return t.disableNetworkFetches=!1},p),this.watchQuery=this.watchQuery.bind(this),this.query=this.query.bind(this),this.mutate=this.mutate.bind(this),this.watchFragment=this.watchFragment.bind(this),this.resetStore=this.resetStore.bind(this),this.reFetchObservableQueries=this.reFetchObservableQueries.bind(this),this.version=vi,this.localState=new pd({cache:a,client:this,resolvers:I,fragmentMatcher:C}),this.queryManager=new hd({cache:this.cache,link:this.link,defaultOptions:this.defaultOptions,defaultContext:b,documentTransform:c,queryDeduplication:E,ssrMode:u,dataMasking:!!V,clientAwareness:{name:M,version:F},localState:this.localState,assumeImmutableResults:S,onBroadcast:this.devtoolsConfig.enabled?function(){t.devToolsHookCb&&t.devToolsHookCb({action:{},state:{queries:t.queryManager.getQueryStore(),mutations:t.queryManager.mutationStore||{}},dataWithOptimisticResults:t.cache.extract(!0)})}:void 0}),this.devtoolsConfig.enabled&&this.connectToDevTools()}return r.prototype.connectToDevTools=function(){if(!(typeof window>"u")){var e=window,t=Symbol.for("apollo.devtools");(e[t]=e[t]||[]).push(this),e.__APOLLO_CLIENT__=this,!Zu&&globalThis.__DEV__!==!1&&(Zu=!0,window.document&&window.top===window.self&&/^(https?|file):$/.test(window.location.protocol)&&setTimeout(function(){if(!window.__APOLLO_DEVTOOLS_GLOBAL_HOOK__){var n=window.navigator,i=n&&n.userAgent,s=void 0;typeof i=="string"&&(i.indexOf("Chrome/")>-1?s="https://chrome.google.com/webstore/detail/apollo-client-developer-t/jdkknkkbebbapilgoeccciglkfbmbnfm":i.indexOf("Firefox/")>-1&&(s="https://addons.mozilla.org/en-US/firefox/addon/apollo-developer-tools/")),s&&globalThis.__DEV__!==!1&&$.log("Download the Apollo DevTools for a better development experience: %s",s)}},1e4))}},Object.defineProperty(r.prototype,"documentTransform",{get:function(){return this.queryManager.documentTransform},enumerable:!1,configurable:!0}),r.prototype.stop=function(){this.queryManager.stop()},r.prototype.watchQuery=function(e){return this.defaultOptions.watchQuery&&(e=es(this.defaultOptions.watchQuery,e)),this.disableNetworkFetches&&(e.fetchPolicy==="network-only"||e.fetchPolicy==="cache-and-network")&&(e=T(T({},e),{fetchPolicy:"cache-first"})),this.queryManager.watchQuery(e)},r.prototype.query=function(e){return this.defaultOptions.query&&(e=es(this.defaultOptions.query,e)),$(e.fetchPolicy!=="cache-and-network",17),this.disableNetworkFetches&&e.fetchPolicy==="network-only"&&(e=T(T({},e),{fetchPolicy:"cache-first"})),this.queryManager.query(e)},r.prototype.mutate=function(e){return this.defaultOptions.mutate&&(e=es(this.defaultOptions.mutate,e)),this.queryManager.mutate(e)},r.prototype.subscribe=function(e){var t=this,n=this.queryManager.generateQueryId();return this.queryManager.startGraphQLSubscription(e).map(function(i){return T(T({},i),{data:t.queryManager.maskOperation({document:e.query,data:i.data,fetchPolicy:e.fetchPolicy,id:n})})})},r.prototype.readQuery=function(e,t){return t===void 0&&(t=!1),this.cache.readQuery(e,t)},r.prototype.watchFragment=function(e){var t;return this.cache.watchFragment(T(T({},e),(t={},t[Symbol.for("apollo.dataMasking")]=this.queryManager.dataMasking,t)))},r.prototype.readFragment=function(e,t){return t===void 0&&(t=!1),this.cache.readFragment(e,t)},r.prototype.writeQuery=function(e){var t=this.cache.writeQuery(e);return e.broadcast!==!1&&this.queryManager.broadcastQueries(),t},r.prototype.writeFragment=function(e){var t=this.cache.writeFragment(e);return e.broadcast!==!1&&this.queryManager.broadcastQueries(),t},r.prototype.__actionHookForDevTools=function(e){this.devToolsHookCb=e},r.prototype.__requestRaw=function(e){return rs(this.link,e)},r.prototype.resetStore=function(){var e=this;return Promise.resolve().then(function(){return e.queryManager.clearStore({discardWatches:!1})}).then(function(){return Promise.all(e.resetStoreCallbacks.map(function(t){return t()}))}).then(function(){return e.reFetchObservableQueries()})},r.prototype.clearStore=function(){var e=this;return Promise.resolve().then(function(){return e.queryManager.clearStore({discardWatches:!0})}).then(function(){return Promise.all(e.clearStoreCallbacks.map(function(t){return t()}))})},r.prototype.onResetStore=function(e){var t=this;return this.resetStoreCallbacks.push(e),function(){t.resetStoreCallbacks=t.resetStoreCallbacks.filter(function(n){return n!==e})}},r.prototype.onClearStore=function(e){var t=this;return this.clearStoreCallbacks.push(e),function(){t.clearStoreCallbacks=t.clearStoreCallbacks.filter(function(n){return n!==e})}},r.prototype.reFetchObservableQueries=function(e){return this.queryManager.reFetchObservableQueries(e)},r.prototype.refetchQueries=function(e){var t=this.queryManager.refetchQueries(e),n=[],i=[];t.forEach(function(o,a){n.push(a),i.push(o)});var s=Promise.all(i);return s.queries=n,s.results=i,s.catch(function(o){globalThis.__DEV__!==!1&&$.debug(18,o)}),s},r.prototype.getObservableQueries=function(e){return e===void 0&&(e="active"),this.queryManager.getObservableQueries(e)},r.prototype.extract=function(e){return this.cache.extract(e)},r.prototype.restore=function(e){return this.cache.restore(e)},r.prototype.addResolvers=function(e){this.localState.addResolvers(e)},r.prototype.setResolvers=function(e){this.localState.setResolvers(e)},r.prototype.getResolvers=function(){return this.localState.getResolvers()},r.prototype.setLocalStateFragmentMatcher=function(e){this.localState.setFragmentMatcher(e)},r.prototype.setLink=function(e){this.link=this.queryManager.link=e},Object.defineProperty(r.prototype,"defaultContext",{get:function(){return this.queryManager.defaultContext},enumerable:!1,configurable:!0}),r}();globalThis.__DEV__!==!1&&(ec.prototype.getMemoryInternals=ah);var Jn=new Map,Ss=new Map,tc=!0,Yn=!1;function rc(r){return r.replace(/[\s,]+/g," ").trim()}function dd(r){return rc(r.source.body.substring(r.start,r.end))}function yd(r){var e=new Set,t=[];return r.definitions.forEach(function(n){if(n.kind==="FragmentDefinition"){var i=n.name.value,s=dd(n.loc),o=Ss.get(i);o&&!o.has(s)?tc&&console.warn("Warning: fragment with name "+i+` already exists.
graphql-tag enforces all fragment names across your application to be unique; read more about
this in the docs: http://dev.apollodata.com/core/fragments.html#unique-names`):o||Ss.set(i,o=new Set),o.add(s),e.has(s)||(e.add(s),t.push(n))}else t.push(n)}),T(T({},r),{definitions:t})}function md(r){var e=new Set(r.definitions);e.forEach(function(n){n.loc&&delete n.loc,Object.keys(n).forEach(function(i){var s=n[i];s&&typeof s=="object"&&e.add(s)})});var t=r.loc;return t&&(delete t.startToken,delete t.endToken),r}function gd(r){var e=rc(r);if(!Jn.has(e)){var t=Mf(r,{experimentalFragmentVariables:Yn,allowLegacyFragmentVariables:Yn});if(!t||t.kind!=="Document")throw new Error("Not a valid GraphQL document.");Jn.set(e,md(yd(t)))}return Jn.get(e)}function ae(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];typeof r=="string"&&(r=[r]);var n=r[0];return e.forEach(function(i,s){i&&i.kind==="Document"?n+=i.loc.source.body:n+=i,n+=r[s+1]}),gd(n)}function vd(){Jn.clear(),Ss.clear()}function bd(){tc=!1}function wd(){Yn=!0}function Ed(){Yn=!1}var sn={gql:ae,resetCaches:vd,disableFragmentWarnings:bd,enableExperimentalFragmentVariables:wd,disableExperimentalFragmentVariables:Ed};(function(r){r.gql=sn.gql,r.resetCaches=sn.resetCaches,r.disableFragmentWarnings=sn.disableFragmentWarnings,r.enableExperimentalFragmentVariables=sn.enableExperimentalFragmentVariables,r.disableExperimentalFragmentVariables=sn.disableExperimentalFragmentVariables})(ae),ae.default=ae;class _d extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query ($bundle: String!) {
      ContinuId(bundle: $bundle) {
        address,
        bundleHash,
        tokenSlug,
        position,
        batchId,
        characters,
        pubkey,
        amount,
        createdAt
      }
    }`}createResponse(e){return new Zl({query:this,json:e})}}class Sd extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.WalletBundle"})}payload(){const e=this.data();if(!e||e.length===0)return null;const t={};return e.forEach(n=>{n.metas=Ir.aggregateMeta(n.metas),t[n.bundleHash]=n}),t}}class kd extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query( $bundleHashes: [ String! ] ) {
      WalletBundle( bundleHashes: $bundleHashes ) {
        bundleHash,
        metas {
          molecularHash,
          position,
          key,
          value,
          createdAt
        },
        createdAt
      }
    }`}createResponse(e){return new Sd({query:this,json:e})}}class Xn extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.Wallet"})}static toClientWallet({data:e,secret:t=null}){let n;if(e.position===null||typeof e.position>"u"?n=Y.create({bundle:e.bundleHash,token:e.tokenSlug,batchId:e.batchId,characters:e.characters}):(n=new Y({secret:t,token:e.tokenSlug,position:e.position,batchId:e.batchId,characters:e.characters}),n.address=e.address,n.bundle=e.bundleHash),e.token&&(n.tokenName=e.token.name,n.tokenAmount=e.token.amount,n.tokenSupply=e.token.supply,n.tokenFungibility=e.token.fungibility),e.tokenUnits.length)for(const i of e.tokenUnits)n.tokenUnits.push(Or.createFromGraphQL(i));if(e.tradeRates.length)for(const i of e.tradeRates)n.tradeRates[i.tokenSlug]=i.amount;return n.balance=Number(e.amount),n.pubkey=e.pubkey,n.createdAt=e.createdAt,n}getWallets(e=null){const t=this.data();if(!t)return null;const n=[];for(const i of t)n.push(Xn.toClientWallet({data:i,secret:e}));return n}payload(){return this.getWallets()}}class Td extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query( $bundleHash: String, $tokenSlug: String ) {
      Wallet( bundleHash: $bundleHash, tokenSlug: $tokenSlug ) {
        address,
        bundleHash,
        token {
          name,
          amount,
          fungibility,
          supply
        },
        tokenSlug,
        batchId,
        position,
        amount,
        characters,
        pubkey,
        createdAt,
        tokenUnits {
          id,
          name,
          metas
        },
        tradeRates {
          tokenSlug,
          amount
        }
      }
    }`}createResponse(e){return new Xn({query:this,json:e})}}class xd extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.Balance"})}payload(){const e=this.data();return!e||!e.bundleHash||!e.tokenSlug?null:Xn.toClientWallet({data:e})}}class Id extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query( $address: String, $bundleHash: String, $type: String, $token: String, $position: String ) {
      Balance( address: $address, bundleHash: $bundleHash, type: $type, token: $token, position: $position ) {
        address,
        bundleHash,
        type,
        tokenSlug,
        batchId,
        position,
        amount,
        characters,
        pubkey,
        createdAt,
        tokenUnits {
          id,
          name,
          metas
        },
        tradeRates {
          tokenSlug,
          amount
        }
      }
    }`}createResponse(e){return new xd({query:this,json:e})}}class Ad extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.MetaType"})}payload(){const e=this.data();if(!e||e.length===0)return null;const t={instances:{},instanceCount:{},paginatorInfo:{}},n=e.pop();return n.instances&&(t.instances=n.instances),n.instanceCount&&(t.instanceCount=n.instanceCount),n.paginatorInfo&&(t.paginatorInfo=n.paginatorInfo),t}}class nc extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query( $metaType: String, $metaTypes: [ String! ], $metaId: String, $metaIds: [ String! ], $key: String, $keys: [ String! ], $value: String, $values: [ String! ], $count: String, $latest: Boolean, $filter: [ MetaFilter! ], $queryArgs: QueryArgs, $countBy: String ) {
      MetaType( metaType: $metaType, metaTypes: $metaTypes, metaId: $metaId, metaIds: $metaIds, key: $key, keys: $keys, value: $value, values: $values, count: $count, filter: $filter, queryArgs: $queryArgs, countBy: $countBy ) {
        metaType,
        instanceCount {
          key,
          value
        },
        instances {
          metaType,
          metaId,
          createdAt,
          metas(latest:$latest) {
            molecularHash,
            position,
            key,
            value,
            createdAt
          }
        },
        paginatorInfo {
          currentPage,
          total
        }
      }
    }`}static createVariables({metaType:e=null,metaId:t=null,key:n=null,value:i=null,latest:s=null,filter:o=null,queryArgs:a=null,count:c=null,countBy:l=null}){const u={};return e&&(u[typeof e=="string"?"metaType":"metaTypes"]=e),t&&(u[typeof t=="string"?"metaId":"metaIds"]=t),n&&(u[typeof n=="string"?"key":"keys"]=n),i&&(u[typeof i=="string"?"value":"values"]=i),u.latest=s===!0,o&&(u.filter=o),a&&((typeof a.limit>"u"||a.limit===0)&&(a.limit="*"),u.queryArgs=a),c&&(u.count=c),l&&(u.countBy=l),u}createResponse(e){return new Ad({query:this,json:e})}}class on extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query( $batchId: String ) {
      Batch( batchId: $batchId ) {
        ${on.getFields()},
        children {
          ${on.getFields()}
        }
      }
    }`}static getFields(){return`batchId,
              molecularHash,
              type,
              status,
              createdAt,
              wallet {
                  address,
                  bundleHash,
                  amount,
                  tokenSlug,
                  token {
                      name,
                      amount
                  },
                  tokenUnits {
                      id,
                      name,
                      metas
                  }
              },
              fromWallet {
                  address,
                  bundleHash,
                  amount,
                  batchId
              },
              toWallet {
                  address,
                  bundleHash,
                  amount,
                  batchId
              },
              sourceTokenUnits {
                  id,
                  name,
                  metas
              },
              transferTokenUnits {
                  id,
                  name,
                  metas
              },
              metas {
                  key,
                  value,
              },
              throughMetas {
                  key,
                  value
              }`}createResponse(e){const t=new ve({query:this,json:e});return t.dataKey="data.Batch",t}}class Od extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query( $batchId: String ) {
      BatchHistory( batchId: $batchId ) {
        ${on.getFields()}
      }
    }`}createResponse(e){const t=new ve({query:this,json:e});return t.dataKey="data.BatchHistory",t}}class at extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.ProposeMolecule"}),this.$__clientMolecule=e.molecule()}init(){const e=le.get(this.data(),"payload");try{this.$__payload=Object.prototype.toString.call(e)==="[object String]"?JSON.parse(e):e}catch{this.$__payload=null}}clientMolecule(){return this.$__clientMolecule}molecule(){const e=this.data();if(!e)return null;const t=new it({});return t.molecularHash=le.get(e,"molecularHash"),t.status=le.get(e,"status"),t.createdAt=le.get(e,"createdAt"),t}success(){return this.status()==="accepted"}status(){return le.get(this.data(),"status","rejected")}reason(){return le.get(this.data(),"reason","Invalid response from server")}payload(){return this.$__payload}}class ks extends Pe{createQuery({variables:e=null}){const t=super.createQuery({variables:e});return t.mutation=t.query,delete t.query,t}async execute({variables:e={},context:t={}}){this.$__request=this.createQuery({variables:e});const n={...t,...this.createQueryContext()};try{const i={...this.$__request,context:n},s=await this.client.mutate(i);return this.$__response=await this.createResponseRaw(s),this.$__response}catch(i){if(i.name==="AbortError")return this.knishIOClient.log("warn","Mutation was cancelled"),new ve({query:this,json:{data:null,errors:[{message:"Mutation was cancelled"}]}});throw i}}createQueryContext(){return{}}}class Ne extends ks{constructor(e,t,n){super(e,t),this.$__molecule=n,this.$__remainderWallet=null,this.$__query=ae`mutation( $molecule: MoleculeInput! ) {
      ProposeMolecule( molecule: $molecule ) {
        molecularHash,
        height,
        depth,
        status,
        reason,
        payload,
        createdAt,
        receivedAt,
        processedAt,
        broadcastedAt,
      }
    }`}compiledVariables(e){return{...super.compiledVariables(e),molecule:this.molecule()}}createResponse(e){return new at({query:this,json:e})}async execute({variables:e=null}){return e=e||{},e.molecule=this.molecule(),super.execute({variables:e})}remainderWallet(){return this.$__remainderWallet}molecule(){return this.$__molecule}}class Cd extends at{payloadKey(e){if(!le.has(this.payload(),e))throw new Ur(`ResponseRequestAuthorization::payloadKey() - '${e}' key was not found in the payload!`);return le.get(this.payload(),e)}token(){return this.payloadKey("token")}time(){return this.payloadKey("time")}encrypt(){return this.payloadKey("encrypt")}pubKey(){return this.payloadKey("key")}}class Rd extends Ne{fillMolecule({meta:e}){this.$__molecule.initAuthorization({meta:e}),this.$__molecule.sign({}),this.$__molecule.check()}createResponse(e){return new Cd({query:this,json:e})}}class Nd extends at{}class Md extends Ne{fillMolecule({recipientWallet:e,amount:t,meta:n=null}){this.$__molecule.initTokenCreation({recipientWallet:e,amount:t,meta:n||{}}),this.$__molecule.sign({bundle:e.bundle}),this.$__molecule.check()}createResponse(e){return new Nd({query:this,json:e})}}class Dd extends at{}class Fd extends Ne{fillMolecule({token:e,amount:t,metaType:n,metaId:i,meta:s=null,batchId:o=null}){this.$__molecule.initTokenRequest({token:e,amount:t,metaType:n,metaId:i,meta:s||{},batchId:o}),this.$__molecule.sign({}),this.$__molecule.check()}createResponse(e){return new Dd({query:this,json:e})}}class Bd extends at{payload(){const e={reason:null,status:null},t=this.data();return e.reason=typeof t.reason>"u"?"Invalid response from server":t.reason,e.status=typeof t.status>"u"?"rejected":t.status,e}}class Pd extends Ne{fillMolecule({recipientWallet:e,amount:t}){this.$__molecule.initValue({recipientWallet:e,amount:t}),this.$__molecule.sign({}),this.$__molecule.check(this.$__molecule.sourceWallet)}createResponse(e){return new Bd({query:this,json:e})}}class $d extends at{}class Ld extends Ne{fillMolecule({type:e,contact:t,code:n}){this.$__molecule.initIdentifierCreation({type:e,contact:t,code:n}),this.$__molecule.sign({}),this.$__molecule.check()}createResponse(e){return new $d({query:this,json:e})}}class Ud extends at{}class qd extends Ne{fillMolecule({token:e,batchId:t=null}){const n=Y.create({secret:this.$__molecule.secret,bundle:this.$__molecule.bundle,token:e,batchId:t});this.$__molecule.initShadowWalletClaim(n),this.$__molecule.sign({}),this.$__molecule.check()}createResponse(e){return new Ud({query:this,json:e})}}class jd extends at{}class Vd extends Ne{fillMolecule({metaType:e,metaId:t,meta:n,policy:i}){this.$__molecule.initMeta({meta:n,metaType:e,metaId:t,policy:i}),this.$__molecule.sign({}),this.$__molecule.check()}createResponse(e){return new jd({query:this,json:e})}}class Qd extends at{}class Hd extends Ne{fillMolecule(e){this.$__molecule.initWalletCreation(e),this.$__molecule.sign({}),this.$__molecule.check()}createResponse(e){return new Qd({query:this,json:e})}}class Wd extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.AccessToken"})}reason(){return"Invalid response from server"}success(){return this.payload()!==null}payload(){return this.data()}payloadKey(e){if(!le.has(this.payload(),e))throw new Ur(`ResponseAuthorizationGuest::payloadKey() - '${e}' key is not found in the payload!`);return le.get(this.payload(),e)}token(){return this.payloadKey("token")}time(){return this.payloadKey("time")}pubKey(){return this.payloadKey("key")}encrypt(){return this.payloadKey("encrypt")}}class zd extends ks{constructor(e,t){super(e,t),this.$__query=ae`mutation( $cellSlug: String, $pubkey: String, $encrypt: Boolean ) {
      AccessToken( cellSlug: $cellSlug, pubkey: $pubkey, encrypt: $encrypt ) {
        token,
        pubkey,
        expiresAt
      }
    }`}createResponse(e){return new Wd({query:this,json:e})}}class ic extends re{constructor(e="The shadow wallet does not exist",t=null,n=null){super(e,t,n),this.name="WalletShadowException"}}class Kd extends re{constructor(e="Stackable tokens with unit IDs cannot have decimal places!",t=null,n=null){super(e,t,n),this.name="StackableUnitDecimalsException"}}class Zn extends re{constructor(e="Stackable tokens with unit IDs cannot have an amount!",t=null,n=null){super(e,t,n),this.name="StackableUnitAmountException"}}class ei{constructor(e){this.client=e,this.$__variables=null,this.$__subscribe=null}createSubscribe({variables:e=null}){if(this.$__variables=this.compiledVariables(e),!this.uri())throw new Qe("Subscribe::createSubscribe() - Node URI was not initialized for this client instance!");if(this.$__subscribe===null)throw new Qe("Subscribe::createSubscribe() - GraphQL subscription was not initialized!");return{query:this.$__subscribe,variables:this.variables(),fetchPolicy:"no-cache"}}async execute({variables:e=null,closure:t}){if(!t)throw new Qe(`${this.constructor.name}::execute() - closure parameter is required!`);return this.$__request=this.createSubscribe({variables:e}),this.client.subscribe(this.$__request,t)}compiledVariables(e=null){return e||{}}uri(){return this.client.getUri()}variables(){return this.$__variables}}class Gd extends ei{constructor(e){super(e),this.$__subscribe=ae`
      subscription onCreateMolecule ( $bundle: String! ) {
        CreateMolecule( bundle: $bundle ) {
          molecularHash,
          cellSlug,
          counterparty,
          bundleHash,
          status,
          local,
          height,
          depth,
          createdAt,
          receivedAt,
          processedAt,
          broadcastedAt,
          reason,
          reasonPayload,
          payload,
          status,
          atoms {
            molecularHash,
            position,
            isotope,
            walletAddress,
            tokenSlug,
            batchId,
            value,
            index,
            metaType,
            metaId,
            metasJson,
            otsFragment,
            createdAt,
            metas {
              molecularHash,
              position,
              metaType,
              metaId,
              key,
              value,
              createdAt,
            }
          }
        }
      }
    `}}class Jd extends ei{constructor(e){super(e),this.$__subscribe=ae`
      subscription onWalletStatus ( $bundle: String!, $token: String! ) {
        WalletStatus( bundle: $bundle, token: $token ) {
          bundle,
          token,
          admission,
          balance,
        }
      }
    `}}class Yd extends ei{constructor(e){super(e),this.$__subscribe=ae`
      subscription onActiveWallet ( $bundle: String! ) {
        ActiveWallet( bundle: $bundle ) {
          address,
          bundleHash,
          walletBundle {
            bundleHash,
            slug,
            createdAt,
          },
          tokenSlug,
          token {
            slug,
            name,
            fungibility,
            supply,
            decimals,
            amount,
            icon,
            createdAt
          },
          batchId,
          position,
          characters,
          pubkey,
          amount,
          createdAt,
          metas {
            molecularHash,
            position,
            metaType,
            metaId,
            key,
            value,
            createdAt,
          }
        }
      }
    `}}class Xd extends ei{constructor(e){super(e),this.$__subscribe=ae`
      subscription onActiveUser ( $metaType: String!, $metaId: String! ) {
        ActiveUser( metaType: $metaType, metaId: $metaId ) {
          bundleHash,
          metaType,
          metaId,
          jsonData,
          createdAt,
          updatedAt
        }
      }`}}class Zd extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.ActiveSession"})}}class ey extends ks{constructor(e,t){super(e,t),this.$__query=ae`mutation(
      $bundleHash: String!,
      $metaType: String!,
      $metaId: String!,
      $ipAddress: String,
      $browser: String,
      $osCpu: String,
      $resolution: String,
      $timeZone: String,
      $json: String ) {
      ActiveSession(
        bundleHash: $bundleHash,
        metaType: $metaType,
        metaId: $metaId,
        ipAddress: $ipAddress,
        browser: $browser,
        osCpu: $osCpu,
        resolution: $resolution,
        timeZone: $timeZone,
        json: $json
      ) {
        bundleHash,
        metaType,
        metaId,
        jsonData,
        createdAt,
        updatedAt
      }
    }`}createResponse(e){return new Zd({query:this,json:e})}}class ty extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.ActiveUser"})}payload(){const e=this.data();if(!e)return null;const t=[];for(const n of e){const i={...n};i.jsonData&&(i.jsonData=JSON.parse(i.jsonData)),i.createdAt&&(i.createdAt=new Date(i.createdAt)),i.updatedAt&&(i.updatedAt=new Date(i.updatedAt)),t.push(i)}return t}}class ry extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query ActiveUserQuery ($bundleHash:String, $metaType: String, $metaId: String) {
      ActiveUser (bundleHash: $bundleHash, metaType: $metaType, metaId: $metaId) {
        bundleHash,
        metaType,
        metaId,
        jsonData,
        createdAt,
        updatedAt
      }
    }`}createResponse(e){return new ty({query:this,json:e})}}class ny extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.UserActivity"})}payload(){const e=JSON.parse(JSON.stringify(this.data()));if(e.instances)for(const t of e.instances)t.jsonData=JSON.parse(t.jsonData);return e}}class iy extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query UserActivity (
      $bundleHash:String,
      $metaType: String,
      $metaId: String,
      $ipAddress: String,
      $browser: String,
      $osCpu: String,
      $resolution: String,
      $timeZone: String,
      $countBy: [CountByUserActivity],
      $interval: span
    ) {
      UserActivity (
        bundleHash: $bundleHash,
        metaType: $metaType,
        metaId: $metaId,
        ipAddress: $ipAddress,
        browser: $browser,
        osCpu: $osCpu,
        resolution: $resolution,
        timeZone: $timeZone,
        countBy: $countBy,
        interval: $interval
      ) {
        createdAt,
        bundleHash,
        metaType,
        metaId,
        instances {
          bundleHash,
          metaType,
          metaId,
          jsonData,
          createdAt,
          updatedAt
        },
        instanceCount {
          ...SubFields,
          ...Recursive
        }
      }
    }

    fragment SubFields on InstanceCountType {
      id,
      count
    }

    fragment Recursive on InstanceCountType {
      instances {
        ...SubFields
        instances {
          ...SubFields,
          instances {
            ...SubFields
            instances {
              ...SubFields
              instances {
                ...SubFields
                instances {
                  ...SubFields
                  instances {
                    ...SubFields
                    instances {
                      ...SubFields
                    }
                  }
                }
              }
            }
          }
        }
      }
    }`}createResponse(e){return new ny({query:this,json:e})}}class sy extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query( $slug: String, $slugs: [ String! ], $limit: Int, $order: String ) {
      Token( slug: $slug, slugs: $slugs, limit: $limit, order: $order ) {
        slug,
        name,
        fungibility,
        supply,
        decimals,
        amount,
        icon,
      }
    }`}createResponse(e){return new ve({query:this,json:e,dataKey:"data.Token"})}}class sc extends re{constructor(e="Authorization attempt rejected by ledger.",t=null,n=null){super(e,t,n),this.name="AuthorizationRejectedException"}}class oy extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.Atom"})}payload(){const e=this.data();if(!e)return null;const t={instances:[],instanceCount:{},paginatorInfo:{}};if(e.instances){t.instances=e.instances;for(const n in t.instances){const i=t.instances[n];i.metasJson&&(t.instances[n].metas=JSON.parse(i.metasJson))}}return e.instanceCount&&(t.instanceCount=e.instanceCount),e.paginatorInfo&&(t.paginatorInfo=e.paginatorInfo),t}metas(){const e=this.payload(),t=[];if(e&&e.instances)for(const n of e.instances)n.metasJson&&t.push(JSON.parse(n.metasJson));return t}}class oc extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query(
      $molecularHashes: [String!],
      $bundleHashes: [String!],
      $positions:[String!],
      $walletAddresses: [String!],
      $isotopes: [String!],
      $tokenSlugs: [String!],
      $cellSlugs: [String!],
      $batchIds: [String!],
      $values: [String!],
      $metaTypes: [String!],
      $metaIds: [String!],
      $indexes: [String!],
      $filter: [ MetaFilter! ],
      $latest: Boolean,
      $queryArgs: QueryArgs,
    ) {
      Atom(
        molecularHashes: $molecularHashes,
        bundleHashes: $bundleHashes,
        positions: $positions,
        walletAddresses: $walletAddresses,
        isotopes: $isotopes,
        tokenSlugs: $tokenSlugs,
        cellSlugs: $cellSlugs,
        batchIds: $batchIds,
        values: $values,
        metaTypes: $metaTypes,
        metaIds: $metaIds,
        indexes: $indexes,
        filter: $filter,
        latest: $latest,
        queryArgs: $queryArgs,
      ) {
        instances {
          position,
          walletAddress,
          tokenSlug,
          isotope,
          index,
          molecularHash,
          metaId,
          metaType,
          metasJson,
          batchId,
          value,
          bundleHashes,
          cellSlugs,
          createdAt,
          otsFragment
        },
        paginatorInfo {
          currentPage,
          total
        }
      }
    }`}static createVariables({molecularHashes:e,molecularHash:t,bundleHashes:n,bundleHash:i,positions:s,position:o,walletAddresses:a,walletAddress:c,isotopes:l,isotope:u,tokenSlugs:d,tokenSlug:p,cellSlugs:y,cellSlug:v,batchIds:E,batchId:w,values:b,value:k,metaTypes:S,metaType:I,metaIds:O,metaId:C,indexes:M,index:F,filter:L,latest:V,queryArgs:G}){return t&&(e=e||[],e.push(t)),i&&(n=n||[],n.push(i)),o&&(s=s||[],s.push(o)),c&&(a=a||[],a.push(c)),u&&(l=l||[],l.push(u)),p&&(d=d||[],d.push(p)),v&&(y=y||[],y.push(v)),w&&(E=E||[],E.push(w)),k&&(b=b||[],b.push(k)),I&&(S=S||[],S.push(I)),C&&(O=O||[],O.push(C)),F&&(M=M||[],M.push(F)),{molecularHashes:e,bundleHashes:n,positions:s,walletAddresses:a,isotopes:l,tokenSlugs:d,cellSlugs:y,batchIds:E,values:b,metaTypes:S,metaIds:O,indexes:M,filter:L,latest:V,queryArgs:G}}createResponse(e){return new oy({query:this,json:e})}}class ay extends ve{constructor({query:e,json:t}){super({query:e,json:t}),this.dataKey="data.Policy",this.init()}payload(){const e=this.data();return e&&e.callback?JSON.parse(e.callback):null}}class uy extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query( $metaType: String, $metaId: String, ) {
      Policy( metaType: $metaType, metaId: $metaId ) {
        molecularHash,
        position,
        metaType,
        metaId,
        conditions,
        callback,
        rule,
        createdAt
      }
    }`}createResponse(e){return new ay({query:this,json:e})}}class cy extends ve{constructor({query:e,json:t}){super({query:e,json:t,dataKey:"data.MetaTypeViaAtom"})}payload(){const e=this.data();if(!e||e.length===0)return null;const t={instances:{},instanceCount:{},paginatorInfo:{}},n=e.pop();return n.instances&&(t.instances=n.instances),n.instanceCount&&(t.instanceCount=n.instanceCount),n.paginatorInfo&&(t.paginatorInfo=n.paginatorInfo),t}}class ac extends Pe{constructor(e,t){super(e,t),this.$__query=ae`query ($metaTypes: [String!], $metaIds: [String!], $values: [String!], $keys: [String!], $latest: Boolean, $filter: [MetaFilter!], $queryArgs: QueryArgs, $countBy: String, $atomValues: [String!] ) {
      MetaTypeViaAtom(
        metaTypes: $metaTypes
        metaIds: $metaIds
        atomValues: $atomValues
        filter: $filter,
        latest: $latest,
        queryArgs: $queryArgs
        countBy: $countBy
      ) {
        metaType,
        instanceCount {
          key,
          value
        },
        instances {
          metaType,
          metaId,
          createdAt,
          metas( values: $values, keys: $keys ) {
            molecularHash,
            position,
            key,
            value,
            createdAt
          }
        },
        paginatorInfo {
          currentPage,
          total
        }
      }
    }`}static createVariables({metaType:e=null,metaId:t=null,key:n=null,value:i=null,keys:s=null,values:o=null,atomValues:a=null,latest:c=null,filter:l=null,queryArgs:u=null,countBy:d=null}){const p={};return a&&(p.atomValues=a),s&&(p.keys=s),o&&(p.values=o),e&&(p.metaTypes=typeof e=="string"?[e]:e),t&&(p.metaIds=typeof t=="string"?[t]:t),d&&(p.countBy=d),l&&(p.filter=l),n&&i&&(p.filter=p.filter||[],p.filter.push({key:n,value:i,comparison:"="})),p.latest=c===!0,u&&((typeof u.limit>"u"||u.limit===0)&&(u.limit="*"),p.queryArgs=u),p}createResponse(e){return new cy({query:this,json:e})}}class ly extends at{}class fy extends Ne{fillMolecule({metaType:e,metaId:t,rule:n,policy:i}){this.$__molecule.createRule({metaType:e,metaId:t,rule:n,policy:i}),this.$__molecule.sign({}),this.$__molecule.check()}createResponse(e){return new ly({query:this,json:e})}}class hy extends Ne{fillMolecule({amount:e,tradeRates:t}){this.$__molecule.initDepositBuffer({amount:e,tradeRates:t}),this.$__molecule.sign({}),this.$__molecule.check(this.$__molecule.sourceWallet)}}class py extends Ne{fillMolecule({recipients:e,signingWallet:t}){this.$__molecule.initWithdrawBuffer({recipients:e,signingWallet:t}),this.$__molecule.sign({}),this.$__molecule.check(this.$__molecule.sourceWallet)}}function gt(r,e,t,n){return new(t||(t=Promise))(function(i,s){function o(l){try{c(n.next(l))}catch(u){s(u)}}function a(l){try{c(n.throw(l))}catch(u){s(u)}}function c(l){var u;l.done?i(l.value):(u=l.value,u instanceof t?u:new t(function(d){d(u)})).then(o,a)}c((n=n.apply(r,[])).next())})}function vt(r,e){var t,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(l){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(o=0)),o;)try{if(t=1,n&&(i=2&u[0]?n.return:u[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,u[1])).done)return i;switch(n=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,n=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(i=o.trys,!((i=i.length>0&&i[i.length-1])||u[0]!==6&&u[0]!==2)){o=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){o.label=u[1];break}if(u[0]===6&&o.label<i[1]){o.label=i[1],i=u;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(u);break}i[2]&&o.ops.pop(),o.trys.pop();continue}u=e.call(r,o)}catch(d){u=[6,d],n=0}finally{t=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([c,l])}}}typeof SuppressedError=="function"&&SuppressedError;var bt={exclude:[]},uc={},dy={timeout:"true"},Xe=function(r,e){typeof window<"u"&&(uc[r]=e)},yy=function(){return Object.fromEntries(Object.entries(uc).filter(function(r){var e,t=r[0];return!(!((e=bt?.exclude)===null||e===void 0)&&e.includes(t))}).map(function(r){return[r[0],(0,r[1])()]}))};function ti(r){return r^=r>>>16,r=Math.imul(r,2246822507),r^=r>>>13,r=Math.imul(r,3266489909),(r^=r>>>16)>>>0}var Me=new Uint32Array([597399067,2869860233,951274213,2716044179]);function ze(r,e){return r<<e|r>>>32-e}function Ts(r,e){var t;if(e===void 0&&(e=0),e=e?0|e:0,typeof r=="string"&&(t=r,r=new TextEncoder().encode(t).buffer),!(r instanceof ArrayBuffer))throw new TypeError("Expected key to be ArrayBuffer or string");var n=new Uint32Array([e,e,e,e]);(function(s,o){for(var a=s.byteLength/16|0,c=new Uint32Array(s,0,4*a),l=0;l<a;l++){var u=c.subarray(4*l,4*(l+1));u[0]=Math.imul(u[0],Me[0]),u[0]=ze(u[0],15),u[0]=Math.imul(u[0],Me[1]),o[0]=o[0]^u[0],o[0]=ze(o[0],19),o[0]=o[0]+o[1],o[0]=Math.imul(o[0],5)+1444728091,u[1]=Math.imul(u[1],Me[1]),u[1]=ze(u[1],16),u[1]=Math.imul(u[1],Me[2]),o[1]=o[1]^u[1],o[1]=ze(o[1],17),o[1]=o[1]+o[2],o[1]=Math.imul(o[1],5)+197830471,u[2]=Math.imul(u[2],Me[2]),u[2]=ze(u[2],17),u[2]=Math.imul(u[2],Me[3]),o[2]=o[2]^u[2],o[2]=ze(o[2],15),o[2]=o[2]+o[3],o[2]=Math.imul(o[2],5)+2530024501,u[3]=Math.imul(u[3],Me[3]),u[3]=ze(u[3],18),u[3]=Math.imul(u[3],Me[0]),o[3]=o[3]^u[3],o[3]=ze(o[3],13),o[3]=o[3]+o[0],o[3]=Math.imul(o[3],5)+850148119}})(r,n),function(s,o){var a=s.byteLength/16|0,c=s.byteLength%16,l=new Uint32Array(4),u=new Uint8Array(s,16*a,c);switch(c){case 15:l[3]=l[3]^u[14]<<16;case 14:l[3]=l[3]^u[13]<<8;case 13:l[3]=l[3]^u[12]<<0,l[3]=Math.imul(l[3],Me[3]),l[3]=ze(l[3],18),l[3]=Math.imul(l[3],Me[0]),o[3]=o[3]^l[3];case 12:l[2]=l[2]^u[11]<<24;case 11:l[2]=l[2]^u[10]<<16;case 10:l[2]=l[2]^u[9]<<8;case 9:l[2]=l[2]^u[8]<<0,l[2]=Math.imul(l[2],Me[2]),l[2]=ze(l[2],17),l[2]=Math.imul(l[2],Me[3]),o[2]=o[2]^l[2];case 8:l[1]=l[1]^u[7]<<24;case 7:l[1]=l[1]^u[6]<<16;case 6:l[1]=l[1]^u[5]<<8;case 5:l[1]=l[1]^u[4]<<0,l[1]=Math.imul(l[1],Me[1]),l[1]=ze(l[1],16),l[1]=Math.imul(l[1],Me[2]),o[1]=o[1]^l[1];case 4:l[0]=l[0]^u[3]<<24;case 3:l[0]=l[0]^u[2]<<16;case 2:l[0]=l[0]^u[1]<<8;case 1:l[0]=l[0]^u[0]<<0,l[0]=Math.imul(l[0],Me[0]),l[0]=ze(l[0],15),l[0]=Math.imul(l[0],Me[1]),o[0]=o[0]^l[0]}}(r,n),function(s,o){o[0]=o[0]^s.byteLength,o[1]=o[1]^s.byteLength,o[2]=o[2]^s.byteLength,o[3]=o[3]^s.byteLength,o[0]=o[0]+o[1]|0,o[0]=o[0]+o[2]|0,o[0]=o[0]+o[3]|0,o[1]=o[1]+o[0]|0,o[2]=o[2]+o[0]|0,o[3]=o[3]+o[0]|0,o[0]=ti(o[0]),o[1]=ti(o[1]),o[2]=ti(o[2]),o[3]=ti(o[3]),o[0]=o[0]+o[1]|0,o[0]=o[0]+o[2]|0,o[0]=o[0]+o[3]|0,o[1]=o[1]+o[0]|0,o[2]=o[2]+o[0]|0,o[3]=o[3]+o[0]|0}(r,n);var i=new Uint8Array(n.buffer);return Array.from(i).map(function(s){return s.toString(16).padStart(2,"0")}).join("")}function my(r,e){return new Promise(function(t){setTimeout(function(){return t(e)},r)})}function gy(r,e,t){return Promise.all(r.map(function(n){return Promise.race([n,my(e,t)])}))}function cc(){return gt(this,void 0,void 0,function(){var r,e,t,n,i;return vt(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),r=yy(),e=Object.keys(r),[4,gy(Object.values(r),bt?.timeout||1e3,dy)];case 1:return t=s.sent(),n=t.filter(function(o){return o!==void 0}),i={},n.forEach(function(o,a){i[e[a]]=o}),[2,lc(i,bt.exclude||[])];case 2:throw s.sent();case 3:return[2]}})})}function lc(r,e){var t={},n=function(s){if(r.hasOwnProperty(s)){var o=r[s];if(typeof o!="object"||Array.isArray(o))e.includes(s)||(t[s]=o);else{var a=lc(o,e.map(function(c){return c.startsWith(s+".")?c.slice(s.length+1):c}));Object.keys(a).length>0&&(t[s]=a)}}};for(var i in r)n(i);return t}function vy(r){return gt(this,void 0,void 0,function(){var e,t;return vt(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,cc()];case 1:return e=n.sent(),t=Ts(JSON.stringify(e)),[2,t.toString()];case 2:throw n.sent();case 3:return[2]}})})}function by(r){for(var e=0,t=0;t<r.length;++t)e+=Math.abs(r[t]);return e}function fc(r,e,t){for(var n=[],i=0;i<r[0].data.length;i++){for(var s=[],o=0;o<r.length;o++)s.push(r[o].data[i]);n.push(wy(s))}var a=new Uint8ClampedArray(n);return new ImageData(a,e,t)}function wy(r){if(r.length===0)return 0;for(var e={},t=0,n=r;t<n.length;t++)e[s=n[t]]=(e[s]||0)+1;var i=r[0];for(var s in e)e[s]>e[i]&&(i=parseInt(s,10));return i}function an(){if(typeof navigator>"u")return{name:"unknown",version:"unknown"};for(var r=navigator.userAgent,e={Edg:"Edge",OPR:"Opera"},t=0,n=[/(?<name>Edge|Edg)\/(?<version>\d+(?:\.\d+)?)/,/(?<name>(?:Chrome|Chromium|OPR|Opera|Vivaldi|Brave))\/(?<version>\d+(?:\.\d+)?)/,/(?<name>(?:Firefox|Waterfox|Iceweasel|IceCat))\/(?<version>\d+(?:\.\d+)?)/,/(?<name>Safari)\/(?<version>\d+(?:\.\d+)?)/,/(?<name>MSIE|Trident|IEMobile).+?(?<version>\d+(?:\.\d+)?)/,/(?<name>[A-Za-z]+)\/(?<version>\d+(?:\.\d+)?)/,/(?<name>SamsungBrowser)\/(?<version>\d+(?:\.\d+)?)/];t<n.length;t++){var i=n[t],s=r.match(i);if(s&&s.groups)return{name:e[s.groups.name]||s.groups.name,version:s.groups.version}}return{name:"unknown",version:"unknown"}}Xe("audio",function(){return gt(this,void 0,void 0,function(){return vt(this,function(r){return[2,new Promise(function(e,t){try{var n=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,5e3,44100),i=n.createBufferSource(),s=n.createOscillator();s.frequency.value=1e3;var o,a=n.createDynamicsCompressor();a.threshold.value=-50,a.knee.value=40,a.ratio.value=12,a.attack.value=0,a.release.value=.2,s.connect(a),a.connect(n.destination),s.start(),n.oncomplete=function(c){o=c.renderedBuffer.getChannelData(0),e({sampleHash:by(o),oscillator:s.type,maxChannels:n.destination.maxChannelCount,channelCountMode:i.channelCountMode})},n.startRendering()}catch(c){console.error("Error creating audio fingerprint:",c),t(c)}})]})})});var Ey=an().name!=="SamsungBrowser"?1:3,hc=280,pc=20;an().name!="Firefox"&&Xe("canvas",function(){return document.createElement("canvas").getContext("2d"),new Promise(function(r){var e=Array.from({length:Ey},function(){return function(){var t=document.createElement("canvas"),n=t.getContext("2d");if(!n)return new ImageData(1,1);t.width=hc,t.height=pc;var i=n.createLinearGradient(0,0,t.width,t.height);i.addColorStop(0,"red"),i.addColorStop(.16666666666666666,"orange"),i.addColorStop(.3333333333333333,"yellow"),i.addColorStop(.5,"green"),i.addColorStop(.6666666666666666,"blue"),i.addColorStop(.8333333333333334,"indigo"),i.addColorStop(1,"violet"),n.fillStyle=i,n.fillRect(0,0,t.width,t.height);var s="Random Text WMwmil10Oo";n.font="23.123px Arial",n.fillStyle="black",n.fillText(s,-5,15),n.fillStyle="rgba(0, 0, 255, 0.5)",n.fillText(s,-3.3,17.7),n.beginPath(),n.moveTo(0,0),n.lineTo(2*t.width/7,t.height),n.strokeStyle="white",n.lineWidth=2,n.stroke();var o=n.getImageData(0,0,t.width,t.height);return o}()});r({commonImageDataHash:Ts(fc(e,hc,pc).data.toString()).toString()})})});var xs,_y=["Arial","Arial Black","Arial Narrow","Arial Rounded MT","Arimo","Archivo","Barlow","Bebas Neue","Bitter","Bookman","Calibri","Cabin","Candara","Century","Century Gothic","Comic Sans MS","Constantia","Courier","Courier New","Crimson Text","DM Mono","DM Sans","DM Serif Display","DM Serif Text","Dosis","Droid Sans","Exo","Fira Code","Fira Sans","Franklin Gothic Medium","Garamond","Geneva","Georgia","Gill Sans","Helvetica","Impact","Inconsolata","Indie Flower","Inter","Josefin Sans","Karla","Lato","Lexend","Lucida Bright","Lucida Console","Lucida Sans Unicode","Manrope","Merriweather","Merriweather Sans","Montserrat","Myriad","Noto Sans","Nunito","Nunito Sans","Open Sans","Optima","Orbitron","Oswald","Pacifico","Palatino","Perpetua","PT Sans","PT Serif","Poppins","Prompt","Public Sans","Quicksand","Rajdhani","Recursive","Roboto","Roboto Condensed","Rockwell","Rubik","Segoe Print","Segoe Script","Segoe UI","Sora","Source Sans Pro","Space Mono","Tahoma","Taviraj","Times","Times New Roman","Titillium Web","Trebuchet MS","Ubuntu","Varela Round","Verdana","Work Sans"],Sy=["monospace","sans-serif","serif"];function dc(r,e){if(!r)throw new Error("Canvas context not supported");return r.font,r.font="72px ".concat(e),r.measureText("WwMmLli0Oo").width}function ky(){var r,e=document.createElement("canvas"),t=(r=e.getContext("webgl"))!==null&&r!==void 0?r:e.getContext("experimental-webgl");if(t&&"getParameter"in t)try{var n=(t.getParameter(t.VENDOR)||"").toString(),i=(t.getParameter(t.RENDERER)||"").toString(),s={vendor:n,renderer:i,version:(t.getParameter(t.VERSION)||"").toString(),shadingLanguageVersion:(t.getParameter(t.SHADING_LANGUAGE_VERSION)||"").toString()};if(!i.length||!n.length){var o=t.getExtension("WEBGL_debug_renderer_info");if(o){var a=(t.getParameter(o.UNMASKED_VENDOR_WEBGL)||"").toString(),c=(t.getParameter(o.UNMASKED_RENDERER_WEBGL)||"").toString();a&&(s.vendorUnmasked=a),c&&(s.rendererUnmasked=c)}}return s}catch{}return"undefined"}function Ty(){var r=new Float32Array(1),e=new Uint8Array(r.buffer);return r[0]=1/0,r[0]=r[0]-r[0],e[3]}function xy(r,e){var t={};return e.forEach(function(n){var i=function(s){if(s.length===0)return null;var o={};s.forEach(function(l){var u=String(l);o[u]=(o[u]||0)+1});var a=s[0],c=1;return Object.keys(o).forEach(function(l){o[l]>c&&(a=l,c=o[l])}),a}(r.map(function(s){return n in s?s[n]:void 0}).filter(function(s){return s!==void 0}));i&&(t[n]=i)}),t}function Iy(){var r=[],e={"prefers-contrast":["high","more","low","less","forced","no-preference"],"any-hover":["hover","none"],"any-pointer":["none","coarse","fine"],pointer:["none","coarse","fine"],hover:["hover","none"],update:["fast","slow"],"inverted-colors":["inverted","none"],"prefers-reduced-motion":["reduce","no-preference"],"prefers-reduced-transparency":["reduce","no-preference"],scripting:["none","initial-only","enabled"],"forced-colors":["active","none"]};return Object.keys(e).forEach(function(t){e[t].forEach(function(n){matchMedia("(".concat(t,": ").concat(n,")")).matches&&r.push("".concat(t,": ").concat(n))})}),r}function Ay(){if(window.location.protocol==="https:"&&typeof window.ApplePaySession=="function")try{for(var r=window.ApplePaySession.supportsVersion,e=15;e>0;e--)if(r(e))return e}catch{return 0}return 0}an().name!="Firefox"&&Xe("fonts",function(){var r=this;return new Promise(function(e,t){try{(function(n){var i;gt(this,void 0,void 0,function(){var s,o,a;return vt(this,function(c){switch(c.label){case 0:return document.body?[3,2]:[4,(l=50,new Promise(function(d){return setTimeout(d,l,u)}))];case 1:return c.sent(),[3,0];case 2:if((s=document.createElement("iframe")).setAttribute("frameBorder","0"),(o=s.style).setProperty("position","fixed"),o.setProperty("display","block","important"),o.setProperty("visibility","visible"),o.setProperty("border","0"),o.setProperty("opacity","0"),s.src="about:blank",document.body.appendChild(s),!(a=s.contentDocument||((i=s.contentWindow)===null||i===void 0?void 0:i.document)))throw new Error("Iframe document is not accessible");return n({iframe:a}),setTimeout(function(){document.body.removeChild(s)},0),[2]}var l,u})})})(function(n){var i=n.iframe;return gt(r,void 0,void 0,function(){var s,o,a,c;return vt(this,function(l){return s=i.createElement("canvas"),o=s.getContext("2d"),a=Sy.map(function(u){return dc(o,u)}),c={},_y.forEach(function(u){var d=dc(o,u);a.includes(d)||(c[u]=d)}),e(c),[2]})})})}catch{t({error:"unsupported"})}})}),Xe("hardware",function(){return new Promise(function(r,e){var t=navigator.deviceMemory!==void 0?navigator.deviceMemory:0,n=window.performance&&window.performance.memory?window.performance.memory:0;r({videocard:ky(),architecture:Ty(),deviceMemory:t.toString()||"undefined",jsHeapSizeLimit:n.jsHeapSizeLimit||0})})}),Xe("locales",function(){return new Promise(function(r){r({languages:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone})})}),Xe("permissions",function(){return gt(this,void 0,void 0,function(){var r;return vt(this,function(e){return xs=bt?.permissions_to_check||["accelerometer","accessibility","accessibility-events","ambient-light-sensor","background-fetch","background-sync","bluetooth","camera","clipboard-read","clipboard-write","device-info","display-capture","gyroscope","geolocation","local-fonts","magnetometer","microphone","midi","nfc","notifications","payment-handler","persistent-storage","push","speaker","storage-access","top-level-storage-access","window-management","query"],r=Array.from({length:bt?.retries||3},function(){return function(){return gt(this,void 0,void 0,function(){var t,n,i,s,o;return vt(this,function(a){switch(a.label){case 0:t={},n=0,i=xs,a.label=1;case 1:if(!(n<i.length))return[3,6];s=i[n],a.label=2;case 2:return a.trys.push([2,4,,5]),[4,navigator.permissions.query({name:s})];case 3:return o=a.sent(),t[s]=o.state.toString(),[3,5];case 4:return a.sent(),[3,5];case 5:return n++,[3,1];case 6:return[2,t]}})})}()}),[2,Promise.all(r).then(function(t){return xy(t,xs)})]})})}),Xe("plugins",function(){var r=[];if(navigator.plugins)for(var e=0;e<navigator.plugins.length;e++){var t=navigator.plugins[e];r.push([t.name,t.filename,t.description].join("|"))}return new Promise(function(n){n({plugins:r})})}),Xe("screen",function(){return new Promise(function(r){r({is_touchscreen:navigator.maxTouchPoints>0,maxTouchPoints:navigator.maxTouchPoints,colorDepth:screen.colorDepth,mediaMatches:Iy()})})}),Xe("system",function(){return new Promise(function(r){var e=an();r({platform:window.navigator.platform,cookieEnabled:window.navigator.cookieEnabled,productSub:navigator.productSub,product:navigator.product,useragent:navigator.userAgent,hardwareConcurrency:navigator.hardwareConcurrency,browser:{name:e.name,version:e.version},applePayVersion:Ay()})})});var Be,Oy=an().name!=="SamsungBrowser"?1:3,U=null;Xe("webgl",function(){return gt(this,void 0,void 0,function(){var r;return vt(this,function(e){typeof document<"u"&&((Be=document.createElement("canvas")).width=200,Be.height=100,U=Be.getContext("webgl"));try{if(!U)throw new Error("WebGL not supported");return r=Array.from({length:Oy},function(){return function(){try{if(!U)throw new Error("WebGL not supported");var t=`
          attribute vec2 position;
          void main() {
              gl_Position = vec4(position, 0.0, 1.0);
          }
      `,n=`
          precision mediump float;
          void main() {
              gl_FragColor = vec4(0.812, 0.195, 0.553, 0.921); // Set line color
          }
      `,i=U.createShader(U.VERTEX_SHADER),s=U.createShader(U.FRAGMENT_SHADER);if(!i||!s)throw new Error("Failed to create shaders");if(U.shaderSource(i,t),U.shaderSource(s,n),U.compileShader(i),!U.getShaderParameter(i,U.COMPILE_STATUS))throw new Error("Vertex shader compilation failed: "+U.getShaderInfoLog(i));if(U.compileShader(s),!U.getShaderParameter(s,U.COMPILE_STATUS))throw new Error("Fragment shader compilation failed: "+U.getShaderInfoLog(s));var o=U.createProgram();if(!o)throw new Error("Failed to create shader program");if(U.attachShader(o,i),U.attachShader(o,s),U.linkProgram(o),!U.getProgramParameter(o,U.LINK_STATUS))throw new Error("Shader program linking failed: "+U.getProgramInfoLog(o));U.useProgram(o);for(var a=137,c=new Float32Array(4*a),l=2*Math.PI/a,u=0;u<a;u++){var d=u*l;c[4*u]=0,c[4*u+1]=0,c[4*u+2]=Math.cos(d)*(Be.width/2),c[4*u+3]=Math.sin(d)*(Be.height/2)}var p=U.createBuffer();U.bindBuffer(U.ARRAY_BUFFER,p),U.bufferData(U.ARRAY_BUFFER,c,U.STATIC_DRAW);var y=U.getAttribLocation(o,"position");U.enableVertexAttribArray(y),U.vertexAttribPointer(y,2,U.FLOAT,!1,0,0),U.viewport(0,0,Be.width,Be.height),U.clearColor(0,0,0,1),U.clear(U.COLOR_BUFFER_BIT),U.drawArrays(U.LINES,0,2*a);var v=new Uint8ClampedArray(Be.width*Be.height*4);return U.readPixels(0,0,Be.width,Be.height,U.RGBA,U.UNSIGNED_BYTE,v),new ImageData(v,Be.width,Be.height)}catch{return new ImageData(1,1)}finally{U&&(U.bindBuffer(U.ARRAY_BUFFER,null),U.useProgram(null),U.viewport(0,0,U.drawingBufferWidth,U.drawingBufferHeight),U.clearColor(0,0,0,0))}}()}),[2,{commonImageHash:Ts(fc(r,Be.width,Be.height).data.toString()).toString()}]}catch{return[2,{webgl:"unsupported"}]}return[2]})})});var Ht=function(r,e,t,n){for(var i=(t-e)/n,s=0,o=0;o<n;o++)s+=r(e+(o+.5)*i);return s*i};Xe("math",function(){return gt(void 0,void 0,void 0,function(){return vt(this,function(r){return[2,{acos:Math.acos(.5),asin:Ht(Math.asin,-1,1,97),atan:Ht(Math.atan,-1,1,97),cos:Ht(Math.cos,0,Math.PI,97),cosh:Math.cosh(1.2857142857142858),e:Math.E,largeCos:Math.cos(1e20),largeSin:Math.sin(1e20),largeTan:Math.tan(1e20),log:Math.log(1e3),pi:Math.PI,sin:Ht(Math.sin,-Math.PI,Math.PI,97),sinh:Ht(Math.sinh,-1.2857142857142858,.7777777777777778,97),sqrt:Math.sqrt(2),tan:Ht(Math.tan,0,2*Math.PI,97),tanh:Ht(Math.tanh,-1.2857142857142858,.7777777777777778,97)}]})})});function yc(r){return new We(function(e,t){return new Z(function(n){var i,s,o;try{i=t(e).subscribe({next:function(a){if(a.errors&&(o=r({graphQLErrors:a.errors,response:a,operation:e,forward:t}),o)){s=o.subscribe({next:n.next.bind(n),error:n.error.bind(n),complete:n.complete.bind(n)});return}n.next(a)},error:function(a){if(o=r({operation:e,networkError:a,graphQLErrors:a&&a.result&&a.result.errors||void 0,forward:t}),o){s=o.subscribe({next:n.next.bind(n),error:n.error.bind(n),complete:n.complete.bind(n)});return}n.error(a)},complete:function(){o||n.complete.bind(n)()}})}catch(a){r({networkError:a,operation:e,forward:t}),n.error(a)}return function(){i&&i.unsubscribe(),s&&i.unsubscribe()}})})}(function(r){He(e,r);function e(t){var n=r.call(this)||this;return n.link=yc(t),n}return e.prototype.request=function(t,n){return this.link.request(t,n)},e})(We);function Cy(r){return new We(function(e,t){var n=st(e,[]);return new Z(function(i){var s,o=!1;return Promise.resolve(n).then(function(a){return r(a,e.getContext())}).then(e.setContext).then(function(){o||(s=t(e).subscribe({next:i.next.bind(i),error:i.error.bind(i),complete:i.complete.bind(i)}))}).catch(i.error.bind(i)),function(){o=!0,s&&s.unsubscribe()}})})}function Ry(r){return ue(r)&&"code"in r&&"reason"in r}function Ny(r){var e;return ue(r)&&((e=r.target)===null||e===void 0?void 0:e.readyState)===WebSocket.CLOSED}var My=function(r){He(e,r);function e(t){var n=r.call(this)||this;return n.client=t,n}return e.prototype.request=function(t){var n=this;return new Z(function(i){return n.client.subscribe(T(T({},t),{query:Ot(t.query)}),{next:i.next.bind(i),complete:i.complete.bind(i),error:function(s){if(s instanceof Error)return i.error(s);var o=Ry(s);return o||Ny(s)?i.error(new Error("Socket closed".concat(o?" with event ".concat(s.code):"").concat(o?" ".concat(s.reason):""))):i.error(new Rt({graphQLErrors:Array.isArray(s)?s:[s]}))}})})},e}(We);function $e(r){return r===null?"null":Array.isArray(r)?"array":typeof r}function Wt(r){return $e(r)==="object"}function Dy(r){return Array.isArray(r)&&r.length>0&&r.every(e=>"message"in e)}function mc(r,e){return r.length<124?r:e}const Fy="graphql-transport-ws";var qe;(function(r){r[r.InternalServerError=4500]="InternalServerError",r[r.InternalClientError=4005]="InternalClientError",r[r.BadRequest=4400]="BadRequest",r[r.BadResponse=4004]="BadResponse",r[r.Unauthorized=4401]="Unauthorized",r[r.Forbidden=4403]="Forbidden",r[r.SubprotocolNotAcceptable=4406]="SubprotocolNotAcceptable",r[r.ConnectionInitialisationTimeout=4408]="ConnectionInitialisationTimeout",r[r.ConnectionAcknowledgementTimeout=4504]="ConnectionAcknowledgementTimeout",r[r.SubscriberAlreadyExists=4409]="SubscriberAlreadyExists",r[r.TooManyInitialisationRequests=4429]="TooManyInitialisationRequests"})(qe||(qe={}));var de;(function(r){r.ConnectionInit="connection_init",r.ConnectionAck="connection_ack",r.Ping="ping",r.Pong="pong",r.Subscribe="subscribe",r.Next="next",r.Error="error",r.Complete="complete"})(de||(de={}));function gc(r){if(!Wt(r))throw new Error(`Message is expected to be an object, but got ${$e(r)}`);if(!r.type)throw new Error("Message is missing the 'type' property");if(typeof r.type!="string")throw new Error(`Message is expects the 'type' property to be a string, but got ${$e(r.type)}`);switch(r.type){case de.ConnectionInit:case de.ConnectionAck:case de.Ping:case de.Pong:{if(r.payload!=null&&!Wt(r.payload))throw new Error(`"${r.type}" message expects the 'payload' property to be an object or nullish or missing, but got "${r.payload}"`);break}case de.Subscribe:{if(typeof r.id!="string")throw new Error(`"${r.type}" message expects the 'id' property to be a string, but got ${$e(r.id)}`);if(!r.id)throw new Error(`"${r.type}" message requires a non-empty 'id' property`);if(!Wt(r.payload))throw new Error(`"${r.type}" message expects the 'payload' property to be an object, but got ${$e(r.payload)}`);if(typeof r.payload.query!="string")throw new Error(`"${r.type}" message payload expects the 'query' property to be a string, but got ${$e(r.payload.query)}`);if(r.payload.variables!=null&&!Wt(r.payload.variables))throw new Error(`"${r.type}" message payload expects the 'variables' property to be a an object or nullish or missing, but got ${$e(r.payload.variables)}`);if(r.payload.operationName!=null&&$e(r.payload.operationName)!=="string")throw new Error(`"${r.type}" message payload expects the 'operationName' property to be a string or nullish or missing, but got ${$e(r.payload.operationName)}`);if(r.payload.extensions!=null&&!Wt(r.payload.extensions))throw new Error(`"${r.type}" message payload expects the 'extensions' property to be a an object or nullish or missing, but got ${$e(r.payload.extensions)}`);break}case de.Next:{if(typeof r.id!="string")throw new Error(`"${r.type}" message expects the 'id' property to be a string, but got ${$e(r.id)}`);if(!r.id)throw new Error(`"${r.type}" message requires a non-empty 'id' property`);if(!Wt(r.payload))throw new Error(`"${r.type}" message expects the 'payload' property to be an object, but got ${$e(r.payload)}`);break}case de.Error:{if(typeof r.id!="string")throw new Error(`"${r.type}" message expects the 'id' property to be a string, but got ${$e(r.id)}`);if(!r.id)throw new Error(`"${r.type}" message requires a non-empty 'id' property`);if(!Dy(r.payload))throw new Error(`"${r.type}" message expects the 'payload' property to be an array of GraphQL errors, but got ${JSON.stringify(r.payload)}`);break}case de.Complete:{if(typeof r.id!="string")throw new Error(`"${r.type}" message expects the 'id' property to be a string, but got ${$e(r.id)}`);if(!r.id)throw new Error(`"${r.type}" message requires a non-empty 'id' property`);break}default:throw new Error(`Invalid message 'type' property "${r.type}"`)}return r}function By(r,e){return gc(typeof r=="string"?JSON.parse(r,e):r)}function un(r,e){return gc(r),JSON.stringify(r,e)}var br=function(r){return this instanceof br?(this.v=r,this):new br(r)},Py=function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(y){return function(v){return Promise.resolve(v).then(y,d)}}function a(y,v){n[y]&&(i[y]=function(E){return new Promise(function(w,b){s.push([y,E,w,b])>1||c(y,E)})},v&&(i[y]=v(i[y])))}function c(y,v){try{l(n[y](v))}catch(E){p(s[0][3],E)}}function l(y){y.value instanceof br?Promise.resolve(y.value.v).then(u,d):p(s[0][2],y)}function u(y){c("next",y)}function d(y){c("throw",y)}function p(y,v){y(v),s.shift(),s.length&&c(s[0][0],s[0][1])}};function $y(r){const{url:e,connectionParams:t,lazy:n=!0,onNonLazyError:i=console.error,lazyCloseTimeout:s=0,keepAlive:o=0,disablePong:a,connectionAckWaitTimeout:c=0,retryAttempts:l=5,retryWait:u=async function(ee){let q=1e3;for(let W=0;W<ee;W++)q*=2;await new Promise(W=>setTimeout(W,q+Math.floor(Math.random()*2700+300)))},shouldRetry:d=Is,isFatalConnectionProblem:p,on:y,webSocketImpl:v,generateID:E=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,ee=>{const q=Math.random()*16|0;return(ee=="x"?q:q&3|8).toString(16)})},jsonMessageReplacer:w,jsonMessageReviver:b}=r;let k;if(v){if(!Uy(v))throw new Error("Invalid WebSocket implementation provided");k=v}else typeof WebSocket<"u"?k=WebSocket:typeof nt<"u"?k=nt.WebSocket||nt.MozWebSocket:typeof window<"u"&&(k=window.WebSocket||window.MozWebSocket);if(!k)throw new Error("WebSocket implementation missing; on Node you can `import WebSocket from 'ws';` and pass `webSocketImpl: WebSocket` to `createClient`");const S=k,I=(()=>{const j=(()=>{const q={};return{on(W,H){return q[W]=H,()=>{delete q[W]}},emit(W){var H;"id"in W&&((H=q[W.id])===null||H===void 0||H.call(q,W))}}})(),ee={connecting:y?.connecting?[y.connecting]:[],opened:y?.opened?[y.opened]:[],connected:y?.connected?[y.connected]:[],ping:y?.ping?[y.ping]:[],pong:y?.pong?[y.pong]:[],message:y?.message?[j.emit,y.message]:[j.emit],closed:y?.closed?[y.closed]:[],error:y?.error?[y.error]:[]};return{onMessage:j.on,on(q,W){const H=ee[q];return H.push(W),()=>{H.splice(H.indexOf(W),1)}},emit(q,...W){for(const H of[...ee[q]])H(...W)}}})();function O(j){const ee=[I.on("error",q=>{ee.forEach(W=>W()),j(q)}),I.on("closed",q=>{ee.forEach(W=>W()),j(q)})]}let C,M=0,F,L=!1,V=0,G=!1;async function Se(){clearTimeout(F);const[j,ee]=await(C??(C=new Promise((H,Te)=>(async()=>{if(L){if(await u(V),!M)return C=void 0,Te({code:1e3,reason:"All Subscriptions Gone"});V++}I.emit("connecting",L);const J=new S(typeof e=="function"?await e():e,Fy);let Ae,Ze;function oe(){isFinite(o)&&o>0&&(clearTimeout(Ze),Ze=setTimeout(()=>{J.readyState===S.OPEN&&(J.send(un({type:de.Ping})),I.emit("ping",!1,void 0))},o))}O(we=>{C=void 0,clearTimeout(Ae),clearTimeout(Ze),Te(we),we instanceof vc&&(J.close(4499,"Terminated"),J.onerror=null,J.onclose=null)}),J.onerror=we=>I.emit("error",we),J.onclose=we=>I.emit("closed",we),J.onopen=async()=>{try{I.emit("opened",J);const we=typeof t=="function"?await t():t;if(J.readyState!==S.OPEN)return;J.send(un(we?{type:de.ConnectionInit,payload:we}:{type:de.ConnectionInit},w)),isFinite(c)&&c>0&&(Ae=setTimeout(()=>{J.close(qe.ConnectionAcknowledgementTimeout,"Connection acknowledgement timeout")},c)),oe()}catch(we){I.emit("error",we),J.close(qe.InternalClientError,mc(we instanceof Error?we.message:new Error(we).message,"Internal client error"))}};let ye=!1;J.onmessage=({data:we})=>{try{const ge=By(we,b);if(I.emit("message",ge),ge.type==="ping"||ge.type==="pong"){I.emit(ge.type,!0,ge.payload),ge.type==="pong"?oe():a||(J.send(un(ge.payload?{type:de.Pong,payload:ge.payload}:{type:de.Pong})),I.emit("pong",!1,ge.payload));return}if(ye)return;if(ge.type!==de.ConnectionAck)throw new Error(`First message cannot be of type ${ge.type}`);clearTimeout(Ae),ye=!0,I.emit("connected",J,ge.payload,L),L=!1,V=0,H([J,new Promise((Rs,ni)=>O(ni))])}catch(ge){J.onmessage=null,I.emit("error",ge),J.close(qe.BadResponse,mc(ge instanceof Error?ge.message:new Error(ge).message,"Bad response"))}}})())));j.readyState===S.CLOSING&&await ee;let q=()=>{};const W=new Promise(H=>q=H);return[j,q,Promise.race([W.then(()=>{if(!M){const H=()=>j.close(1e3,"Normal Closure");isFinite(s)&&s>0?F=setTimeout(()=>{j.readyState===S.OPEN&&H()},s):H()}}),ee])]}function se(j){if(Is(j)&&(Ly(j.code)||[qe.InternalServerError,qe.InternalClientError,qe.BadRequest,qe.BadResponse,qe.Unauthorized,qe.SubprotocolNotAcceptable,qe.SubscriberAlreadyExists,qe.TooManyInitialisationRequests].includes(j.code)))throw j;if(G)return!1;if(Is(j)&&j.code===1e3)return M>0;if(!l||V>=l||!d(j)||p?.(j))throw j;return L=!0}n||(async()=>{for(M++;;)try{const[,,j]=await Se();await j}catch(j){try{if(!se(j))return}catch(ee){return i?.(ee)}}})();function ke(j,ee){const q=E(j);let W=!1,H=!1,Te=()=>{M--,W=!0};return(async()=>{for(M++;;)try{const[J,Ae,Ze]=await Se();if(W)return Ae();const oe=I.onMessage(q,ye=>{switch(ye.type){case de.Next:{ee.next(ye.payload);return}case de.Error:{H=!0,W=!0,ee.error(ye.payload),Te();return}case de.Complete:{W=!0,Te();return}}});J.send(un({id:q,type:de.Subscribe,payload:j},w)),Te=()=>{!W&&J.readyState===S.OPEN&&J.send(un({id:q,type:de.Complete},w)),M--,W=!0,Ae()},await Ze.finally(oe);return}catch(J){if(!se(J))return}})().then(()=>{H||ee.complete()}).catch(J=>{ee.error(J)}),()=>{W||Te()}}return{on:I.on,subscribe:ke,iterate(j){const ee=[],q={done:!1,error:null,resolve:()=>{}},W=ke(j,{next(Te){ee.push(Te),q.resolve()},error(Te){q.done=!0,q.error=Te,q.resolve()},complete(){q.done=!0,q.resolve()}}),H=function(){return Py(this,arguments,function*(){for(;;){for(ee.length||(yield br(new Promise(Ae=>q.resolve=Ae)));ee.length;)yield yield br(ee.shift());if(q.error)throw q.error;if(q.done)return yield br(void 0)}})}();return H.throw=async Te=>(q.done||(q.done=!0,q.error=Te,q.resolve()),{done:!0,value:void 0}),H.return=async()=>(W(),{done:!0,value:void 0}),H},async dispose(){if(G=!0,C){const[j]=await C;j.close(1e3,"Normal Closure")}},terminate(){C&&I.emit("closed",new vc)}}}class vc extends Error{constructor(){super(...arguments),this.name="TerminatedCloseEvent",this.message="4499: Terminated",this.code=4499,this.reason="Terminated",this.wasClean=!1}}function Is(r){return Wt(r)&&"code"in r&&"reason"in r}function Ly(r){return[1e3,1001,1006,1005,1012,1013,1014].includes(r)?!1:r>=1e3&&r<=1999}function Uy(r){return typeof r=="function"&&"constructor"in r&&"CLOSED"in r&&"CLOSING"in r&&"CONNECTING"in r&&"OPEN"in r}function qy(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var De=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof De<"u"&&De,Le={searchParams:"URLSearchParams"in De,iterable:"Symbol"in De&&"iterator"in Symbol,blob:"FileReader"in De&&"Blob"in De&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in De,arrayBuffer:"ArrayBuffer"in De};function jy(r){return r&&DataView.prototype.isPrototypeOf(r)}if(Le.arrayBuffer)var Vy=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Qy=ArrayBuffer.isView||function(r){return r&&Vy.indexOf(Object.prototype.toString.call(r))>-1};function cn(r){if(typeof r!="string"&&(r=String(r)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(r)||r==="")throw new TypeError('Invalid character in header field name: "'+r+'"');return r.toLowerCase()}function As(r){return typeof r!="string"&&(r=String(r)),r}function Os(r){var e={next:function(){var t=r.shift();return{done:t===void 0,value:t}}};return Le.iterable&&(e[Symbol.iterator]=function(){return e}),e}function be(r){this.map={},r instanceof be?r.forEach(function(e,t){this.append(t,e)},this):Array.isArray(r)?r.forEach(function(e){this.append(e[0],e[1])},this):r&&Object.getOwnPropertyNames(r).forEach(function(e){this.append(e,r[e])},this)}be.prototype.append=function(r,e){r=cn(r),e=As(e);var t=this.map[r];this.map[r]=t?t+", "+e:e},be.prototype.delete=function(r){delete this.map[cn(r)]},be.prototype.get=function(r){return r=cn(r),this.has(r)?this.map[r]:null},be.prototype.has=function(r){return this.map.hasOwnProperty(cn(r))},be.prototype.set=function(r,e){this.map[cn(r)]=As(e)},be.prototype.forEach=function(r,e){for(var t in this.map)this.map.hasOwnProperty(t)&&r.call(e,this.map[t],t,this)},be.prototype.keys=function(){var r=[];return this.forEach(function(e,t){r.push(t)}),Os(r)},be.prototype.values=function(){var r=[];return this.forEach(function(e){r.push(e)}),Os(r)},be.prototype.entries=function(){var r=[];return this.forEach(function(e,t){r.push([t,e])}),Os(r)},Le.iterable&&(be.prototype[Symbol.iterator]=be.prototype.entries);function Cs(r){if(r.bodyUsed)return Promise.reject(new TypeError("Already read"));r.bodyUsed=!0}function bc(r){return new Promise(function(e,t){r.onload=function(){e(r.result)},r.onerror=function(){t(r.error)}})}function Hy(r){var e=new FileReader,t=bc(e);return e.readAsArrayBuffer(r),t}function Wy(r){var e=new FileReader,t=bc(e);return e.readAsText(r),t}function zy(r){for(var e=new Uint8Array(r),t=new Array(e.length),n=0;n<e.length;n++)t[n]=String.fromCharCode(e[n]);return t.join("")}function wc(r){if(r.slice)return r.slice(0);var e=new Uint8Array(r.byteLength);return e.set(new Uint8Array(r)),e.buffer}function Ec(){return this.bodyUsed=!1,this._initBody=function(r){this.bodyUsed=this.bodyUsed,this._bodyInit=r,r?typeof r=="string"?this._bodyText=r:Le.blob&&Blob.prototype.isPrototypeOf(r)?this._bodyBlob=r:Le.formData&&FormData.prototype.isPrototypeOf(r)?this._bodyFormData=r:Le.searchParams&&URLSearchParams.prototype.isPrototypeOf(r)?this._bodyText=r.toString():Le.arrayBuffer&&Le.blob&&jy(r)?(this._bodyArrayBuffer=wc(r.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):Le.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(r)||Qy(r))?this._bodyArrayBuffer=wc(r):this._bodyText=r=Object.prototype.toString.call(r):this._bodyText="",this.headers.get("content-type")||(typeof r=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Le.searchParams&&URLSearchParams.prototype.isPrototypeOf(r)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Le.blob&&(this.blob=function(){var r=Cs(this);if(r)return r;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var r=Cs(this);return r||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then(Hy)}),this.text=function(){var r=Cs(this);if(r)return r;if(this._bodyBlob)return Wy(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(zy(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Le.formData&&(this.formData=function(){return this.text().then(Jy)}),this.json=function(){return this.text().then(JSON.parse)},this}var Ky=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Gy(r){var e=r.toUpperCase();return Ky.indexOf(e)>-1?e:r}function zt(r,e){if(!(this instanceof zt))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var t=e.body;if(r instanceof zt){if(r.bodyUsed)throw new TypeError("Already read");this.url=r.url,this.credentials=r.credentials,e.headers||(this.headers=new be(r.headers)),this.method=r.method,this.mode=r.mode,this.signal=r.signal,!t&&r._bodyInit!=null&&(t=r._bodyInit,r.bodyUsed=!0)}else this.url=String(r);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new be(e.headers)),this.method=Gy(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&t)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(t),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var n=/([?&])_=[^&]*/;if(n.test(this.url))this.url=this.url.replace(n,"$1_="+new Date().getTime());else{var i=/\?/;this.url+=(i.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}zt.prototype.clone=function(){return new zt(this,{body:this._bodyInit})};function Jy(r){var e=new FormData;return r.trim().split("&").forEach(function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),s=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(s))}}),e}function Yy(r){var e=new be,t=r.replace(/\r?\n[\t ]+/g," ");return t.split("\r").map(function(n){return n.indexOf(`
`)===0?n.substr(1,n.length):n}).forEach(function(n){var i=n.split(":"),s=i.shift().trim();if(s){var o=i.join(":").trim();e.append(s,o)}}),e}Ec.call(zt.prototype);function ut(r,e){if(!(this instanceof ut))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new be(e.headers),this.url=e.url||"",this._initBody(r)}Ec.call(ut.prototype),ut.prototype.clone=function(){return new ut(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new be(this.headers),url:this.url})},ut.error=function(){var r=new ut(null,{status:0,statusText:""});return r.type="error",r};var Xy=[301,302,303,307,308];ut.redirect=function(r,e){if(Xy.indexOf(e)===-1)throw new RangeError("Invalid status code");return new ut(null,{status:e,headers:{location:r}})};var Kt=De.DOMException;try{new Kt}catch{Kt=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},Kt.prototype=Object.create(Error.prototype),Kt.prototype.constructor=Kt}function _c(r,e){return new Promise(function(t,n){var i=new zt(r,e);if(i.signal&&i.signal.aborted)return n(new Kt("Aborted","AbortError"));var s=new XMLHttpRequest;function o(){s.abort()}s.onload=function(){var c={status:s.status,statusText:s.statusText,headers:Yy(s.getAllResponseHeaders()||"")};c.url="responseURL"in s?s.responseURL:c.headers.get("X-Request-URL");var l="response"in s?s.response:s.responseText;setTimeout(function(){t(new ut(l,c))},0)},s.onerror=function(){setTimeout(function(){n(new TypeError("Network request failed"))},0)},s.ontimeout=function(){setTimeout(function(){n(new TypeError("Network request failed"))},0)},s.onabort=function(){setTimeout(function(){n(new Kt("Aborted","AbortError"))},0)};function a(c){try{return c===""&&De.location.href?De.location.href:c}catch{return c}}s.open(i.method,a(i.url),!0),i.credentials==="include"?s.withCredentials=!0:i.credentials==="omit"&&(s.withCredentials=!1),"responseType"in s&&(Le.blob?s.responseType="blob":Le.arrayBuffer&&i.headers.get("Content-Type")&&i.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(s.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof be)?Object.getOwnPropertyNames(e.headers).forEach(function(c){s.setRequestHeader(c,As(e.headers[c]))}):i.headers.forEach(function(c,l){s.setRequestHeader(l,c)}),i.signal&&(i.signal.addEventListener("abort",o),s.onreadystatechange=function(){s.readyState===4&&i.signal.removeEventListener("abort",o)}),s.send(typeof i._bodyInit>"u"?null:i._bodyInit)})}_c.polyfill=!0,De.fetch||(De.fetch=_c,De.Headers=be,De.Request=zt,De.Response=ut);var Zy=self.fetch.bind(self);const em=qy(Zy);function tm({graphQLErrors:r,networkError:e,operation:t,forward:n,response:i}){if(r&&r.forEach(({message:s,debugMessage:o,locations:a,path:c})=>console.error(`[GraphQL error]: ${s}`,`
  Message : ${o}`,`
  Path    : ${c}`,`
  Location: ${JSON.stringify(a)}`)),e){const{name:s,statusCode:o,result:a={}}=e;console.error(`[Network error]: ${s}, status code: ${o}`)}}function rm(r){return r.query.definitions.find(n=>n.kind==="OperationDefinition").selectionSet.selections.find(n=>n.kind==="Field").name.value}function nm(r){return r.query.definitions.find(t=>t.kind==="OperationDefinition").operation}class im extends We{constructor(){super(),this.__wallet=null,this.__pubkey=null}setWallet(e){this.__wallet=e}getWallet(){return this.__wallet}setPubKey(e){this.__pubkey=e}getPubKey(){return this.__pubkey}request(e,t){const n=rm(e),i=nm(e),s=i==="mutation"&&n==="ProposeMolecule";if([i==="query"&&["__schema","ContinuId"].includes(n),i==="mutation"&&n==="AccessToken",s&&le.get(e,"variables.molecule.atoms.0.isotope")==="U"].some(u=>u))return t(e);const a=this.getWallet(),c=this.getPubKey();if(!c)throw new Qe("CipherLink::request() - Node public key missing!");if(!a)throw new Qe("CipherLink::request() - Authorized wallet missing!");const l={query:na(e.query),variables:JSON.stringify(e.variables)};return e.operationName=null,e.query=ae`query ($Hash: String!) { CipherHash(Hash: $Hash) { hash } }`,e.variables={Hash:JSON.stringify(a.encryptMessage(l,c))},t(e).map(u=>{let d=u.data;if(d.data&&(d=d.data),d.CipherHash&&d.CipherHash.hash){const p=JSON.parse(d.CipherHash.hash),y=a.decryptMessage(p);if(y===null)throw new Qe("CipherLink::request() - Unable to decrypt response!");return y}return u})}}class ri extends ec{constructor({serverUri:e,soketi:t=null,encrypt:n=!1}){const i=su({uri:e,fetch:em}),s="",o=Cy((d,{headers:p})=>({headers:{...p,"X-Auth-Token":s}})),a=yc(tm);let c=Za([o,a,i]),l;n&&(l=new im,c=Za([l,c]));let u;t&&t.socketUri&&(u=new My($y({url:t.socketUri,connectionParams:()=>({authToken:s})})),c=fp(({query:d})=>{const p=cr(d);return p.kind==="OperationDefinition"&&p.operation==="subscription"},u,c)),super({link:c,cache:new zu,defaultOptions:{watchQuery:{fetchPolicy:"no-cache",errorPolicy:"ignore"},query:{fetchPolicy:"no-cache",errorPolicy:"all"},mutate:{fetchPolicy:"no-cache",errorPolicy:"all"}}}),this.serverUri=e,this.soketi=t,this.authToken=s,this.pubkey=null,this.wallet=null,this.cipherLink=l,this.wsLink=u}setAuthData({token:e,pubkey:t,wallet:n}){this.authToken=e,this.pubkey=t,this.wallet=n,this.cipherLink&&(this.cipherLink.setWallet(n),this.cipherLink.setPubKey(t)),this.wsLink&&(this.wsLink.client.connectionParams=()=>({authToken:this.authToken}))}socketDisconnect(){this.wsLink&&this.wsLink.client.dispose()}getAuthToken(){return this.authToken}getPubKey(){return this.pubkey}getWallet(){return this.wallet}getServerUri(){return this.serverUri}getSocketUri(){return this.soketi?this.soketi.socketUri:null}}class sm{constructor(e){this.$__client=e,this.$__subscribers={}}setClient(e){this.$__client=e}subscribe(e,t){const n=this.$__client.subscribe(e).subscribe(t);return this.$__subscribers[e.operationName]=n,n}unsubscribe(e){this.$__subscribers[e]&&(this.$__subscribers[e].unsubscribe(),this.$__client.unsubscribeFromChannel(e),delete this.$__subscribers[e])}unsubscribeAll(){Object.keys(this.$__subscribers).forEach(this.unsubscribe.bind(this))}clear(){this.$__subscribers={}}}class om{constructor({serverUri:e,socket:t=null,encrypt:n=!1}){this.$__client=new ri({serverUri:e,soketi:t,encrypt:n}),this.$__subscriptionManager=new sm(this.$__client)}setEncryption(e=!1){const t={serverUri:this.$__client.getServerUri(),soketi:{socketUri:this.$__client.getSocketUri(),appKey:"knishio"},encrypt:e};this.$__client=new ri(t),this.$__subscriptionManager.setClient(this.$__client)}unsubscribe(e){this.$__subscriptionManager.unsubscribe(e)}unsubscribeAll(){this.$__subscriptionManager.unsubscribeAll()}socketDisconnect(){this.$__client.socketDisconnect(),this.$__subscriptionManager.clear()}subscribe(e,t){return this.$__subscriptionManager.subscribe(e,t)}async query(e){return this.$__client.query(e)}async mutate(e){return this.$__client.mutate(e)}setAuthData({token:e,pubkey:t,wallet:n}){this.$__client.setAuthData({token:e,pubkey:t,wallet:n})}getAuthToken(){return this.$__client.getAuthToken()}getUri(){return this.$__client?this.$__client.getServerUri():null}getSocketUri(){return this.$__client.getSocketUri()}setUri(e){const t={serverUri:e,soketi:{socketUri:this.$__client.getSocketUri(),appKey:"knishio"},encrypt:!!this.$__client.cipherLink};this.$__client=new ri(t),this.$__subscriptionManager.setClient(this.$__client)}setSocketUri({socketUri:e,appKey:t}){const n={serverUri:this.$__client.getServerUri(),soketi:{socketUri:e,appKey:t},encrypt:!!this.$__client.cipherLink};this.$__client=new ri(n),this.$__subscriptionManager.setClient(this.$__client)}}class am{constructor({uri:e,cellSlug:t=null,client:n=null,socket:i=null,serverSdkVersion:s=3,logging:o=!1}){this.initialize({uri:e,cellSlug:t,socket:i,client:n,serverSdkVersion:s,logging:o})}initialize({uri:e,cellSlug:t=null,socket:n=null,client:i=null,serverSdkVersion:s=3,logging:o=!1}){this.reset(),this.$__logging=o,this.$__authTokenObjects={},this.$__authInProcess=!1,this.abortControllers=new Map,this.setUri(e),t&&this.setCellSlug(t);for(const a in this.$__uris){const c=this.$__uris[a];this.$__authTokenObjects[c]=null}this.log("info",`KnishIOClient::initialize() - Initializing new Knish.IO client session for SDK version ${s}...`),this.$__client=i||new om({socket:{socketUri:null,appKey:"knishio",...n||{}},serverUri:this.getRandomUri()}),this.$__serverSdkVersion=s}getRandomUri(){const e=Math.floor(Math.random()*this.$__uris.length);return this.$__uris[e]}switchEncryption(e){return this.$__encrypt===e?!1:(this.log("info",`KnishIOClient::switchEncryption() - Forcing encryption ${e?"on":"off"} to match node...`),this.$__encrypt=e,this.$__client.setEncryption(e),!0)}deinitialize(){this.log("info","KnishIOClient::deinitialize() - Clearing the Knish.IO client session..."),this.reset()}subscribe(){if(!this.client().getSocketUri())throw new Qe("KnishIOClient::subscribe() - Socket client not initialized!");return this.client()}getServerSdkVersion(){return this.$__serverSdkVersion}reset(){this.$__secret="",this.$__bundle="",this.remainderWallet=null}cellSlug(){return this.$__cellSlug||null}setCellSlug(e){this.$__cellSlug=e}setUri(e){this.$__uris=typeof e=="object"?e:[e]}uri(){return this.$__client.getUri()}client(){if(!this.$__authInProcess){const e=this.getRandomUri();this.$__client.setUri(e);const t=this.$__authTokenObjects[e];t?this.$__client.setAuthData(t.getAuthData()):this.requestAuthToken({secret:this.$__secret,cellSlug:this.$__cellSlug,encrypt:this.$__encrypt}).then(()=>{})}return this.$__client}hasSecret(){return!!this.$__secret}setSecret(e){this.$__secret=e,this.$__bundle=this.hashSecret(e,"setSecret")}hashSecret(e,t=null){return this.log("info",`KnishIOClient::hashSecret(${t?`source: ${t}`:""}) - Computing wallet bundle from secret...`),Pt(e)}getSecret(){if(!this.hasSecret())throw new yi("KnishIOClient::getSecret() - Unable to find a stored secret! Have you set a secret?");return this.$__secret}hasBundle(){return!!this.$__bundle}getBundle(){if(!this.hasBundle())throw new yi("KnishIOClient::getBundle() - Unable to find a stored bundle! Have you set a secret?");return this.$__bundle}getFingerprint(){return vy()}getFingerprintData(){return cc()}async getSourceWallet(){let e=(await this.queryContinuId({bundle:this.getBundle()})).payload();return e?e.key=Y.generateKey({secret:this.getSecret(),token:e.token,position:e.position}):e=new Y({secret:this.getSecret()}),e}getRemainderWallet(){return this.remainderWallet}async createMolecule({secret:e=null,bundle:t=null,sourceWallet:n=null,remainderWallet:i=null}){return this.log("info","KnishIOClient::createMolecule() - Creating a new molecule..."),e=e||this.getSecret(),t=t||this.getBundle(),!n&&this.lastMoleculeQuery&&this.getRemainderWallet().token==="USER"&&this.lastMoleculeQuery.response()&&this.lastMoleculeQuery.response().success()&&(n=this.getRemainderWallet()),n===null&&(n=await this.getSourceWallet()),this.remainderWallet=i||Y.create({secret:e,bundle:t,token:"USER",batchId:n.batchId,characters:n.characters}),new it({secret:e,sourceWallet:n,remainderWallet:this.getRemainderWallet(),cellSlug:this.cellSlug(),version:this.getServerSdkVersion()})}createQuery(e){return new e(this.client(),this)}createSubscribe(e){return new e(this.subscribe())}async createMoleculeMutation({mutationClass:e,molecule:t=null}){this.log("info",`KnishIOClient::createMoleculeQuery() - Creating a new ${e.name} query...`);const n=t||await this.createMolecule({}),i=new e(this.client(),this,n);if(!(i instanceof Ne))throw new Qe(`${this.constructor.name}::createMoleculeMutation() - This method only accepts MutationProposeMolecule!`);return this.lastMoleculeQuery=i,i}async executeQuery(e,t=null){this.$__authToken&&this.$__authToken.isExpired()&&(this.log("info","KnishIOClient::executeQuery() - Access token is expired. Getting new one..."),await this.requestAuthToken({secret:this.$__secret,cellSlug:this.$__cellSlug,encrypt:this.$__encrypt}));const n=new AbortController,i=JSON.stringify({query:e.$__query,variables:t});this.abortControllers.set(i,n);try{const s=await e.execute({variables:t,context:{fetchOptions:{signal:n.signal}}});return this.abortControllers.delete(i),s}catch(s){if(s.name==="AbortError")this.log("warn","Query was cancelled");else throw s}}cancelQuery(e,t=null){const n=JSON.stringify({query:e.$__query,variables:t}),i=this.abortControllers.get(n);i&&(i.abort(),this.abortControllers.delete(n))}cancelAllQueries(){for(const e of this.abortControllers.values())e.abort();this.abortControllers.clear()}async queryBalance({token:e,bundle:t=null,type:n="regular"}){const i=this.createQuery(Id);return this.executeQuery(i,{bundleHash:t||this.getBundle(),token:e,type:n})}async querySourceWallet({token:e,amount:t,type:n="regular"}){const i=(await this.queryBalance({token:e,type:n})).payload();if(i===null||Zt.cmp(i.balance,t)<0)throw new pt;if(!i.position||!i.address)throw new pt("Source wallet can not be a shadow wallet.");return i}async subscribeCreateMolecule({bundle:e,closure:t}){return await this.createSubscribe(Gd).execute({variables:{bundle:e||this.getBundle()},closure:t})}subscribeWalletStatus({bundle:e,token:t,closure:n}){if(!t)throw new Qe(`${this.constructor.name}::subscribeWalletStatus() - Token parameter is required!`);return this.createSubscribe(Jd).execute({variables:{bundle:e||this.getBundle(),token:t},closure:n})}subscribeActiveWallet({bundle:e,closure:t}){return this.createSubscribe(Yd).execute({variables:{bundle:e||this.getBundle()},closure:t})}subscribeActiveSession({metaType:e,metaId:t,closure:n}){return this.createSubscribe(Xd).execute({variables:{metaType:e,metaId:t},closure:n})}unsubscribe(e){this.subscribe().unsubscribe(e)}unsubscribeAll(){this.subscribe().unsubscribeAll()}queryMeta({metaType:e,metaId:t=null,key:n=null,value:i=null,latest:s=!0,fields:o=null,filter:a=null,queryArgs:c=null,count:l=null,countBy:u=null,throughAtom:d=!0,values:p=null,keys:y=null,atomValues:v=null}){this.log("info",`KnishIOClient::queryMeta() - Querying metaType: ${e}, metaId: ${t}...`);let E,w;return d?(E=this.createQuery(ac),w=ac.createVariables({metaType:e,metaId:t,key:n,value:i,latest:s,filter:a,queryArgs:c,countBy:u,values:p,keys:y,atomValues:v})):(E=this.createQuery(nc),w=nc.createVariables({metaType:e,metaId:t,key:n,value:i,latest:s,filter:a,queryArgs:c,count:l,countBy:u})),this.executeQuery(E,w).then(b=>b.payload())}async queryBatch({batchId:e}){this.log("info",`KnishIOClient::queryBatch() - Querying cascading meta instances for batchId: ${e}...`);const t=this.createQuery(on);return await this.executeQuery(t,{batchId:e})}async queryBatchHistory({batchId:e}){this.log("info",`KnishIOClient::queryBatchHistory() - Querying cascading meta instances for batchId: ${e}...`);const t=this.createQuery(Od);return await this.executeQuery(t,{batchId:e})}async queryAtom({molecularHashes:e,molecularHash:t,bundleHashes:n,bundleHash:i,positions:s,position:o,walletAddresses:a,walletAddress:c,isotopes:l,isotope:u,tokenSlugs:d,tokenSlug:p,cellSlugs:y,cellSlug:v,batchIds:E,batchId:w,values:b,value:k,metaTypes:S,metaType:I,metaIds:O,metaId:C,indexes:M,index:F,filter:L,latest:V,queryArgs:G={limit:15,offset:1}}){this.log("info","KnishIOClient::queryAtom() - Querying atom instances");const Se=this.createQuery(oc);return await this.executeQuery(Se,oc.createVariables({molecularHashes:e,molecularHash:t,bundleHashes:n,bundleHash:i,positions:s,position:o,walletAddresses:a,walletAddress:c,isotopes:l,isotope:u,tokenSlugs:d,tokenSlug:p,cellSlugs:y,cellSlug:v,batchIds:E,batchId:w,values:b,value:k,metaTypes:S,metaType:I,metaIds:O,metaId:C,indexes:M,index:F,filter:L,latest:V,queryArgs:G}))}async createWallet({token:e}){const t=new Y({secret:this.getSecret(),token:e}),n=await this.createMoleculeMutation({mutationClass:Hd});return n.fillMolecule(t),await this.executeQuery(n)}async queryActiveSession({bundleHash:e,metaType:t,metaId:n}){const i=this.createQuery(ry);return await this.executeQuery(i,{bundleHash:e,metaType:t,metaId:n})}async queryUserActivity({bundleHash:e,metaType:t,metaId:n,ipAddress:i,browser:s,osCpu:o,resolution:a,timeZone:c,countBy:l,interval:u}){const d=this.createQuery(iy);return await this.executeQuery(d,{bundleHash:e,metaType:t,metaId:n,ipAddress:i,browser:s,osCpu:o,resolution:a,timeZone:c,countBy:l,interval:u})}async activeSession({bundle:e,metaType:t,metaId:n,ipAddress:i,browser:s,osCpu:o,resolution:a,timeZone:c,json:l={}}){const u=this.createQuery(ey);return await this.executeQuery(u,{bundleHash:e,metaType:t,metaId:n,ipAddress:i,browser:s,osCpu:o,resolution:a,timeZone:c,json:JSON.stringify(l)})}async createToken({token:e,amount:t=null,meta:n=null,batchId:i=null,units:s=[]}){const o=le.get(n||{},"fungibility");if(o==="stackable"&&(n.batchId=i||vn({})),["nonfungible","stackable"].includes(o)&&s.length>0){if(le.get(n||{},"decimals")>0)throw new Kd;if(t>0)throw new Zn;t=s.length,n.splittable=1,n.decimals=0,n.tokenUnits=JSON.stringify(s)}const a=new Y({secret:this.getSecret(),bundle:this.getBundle(),token:e,batchId:i}),c=await this.createMoleculeMutation({mutationClass:Md});return c.fillMolecule({recipientWallet:a,amount:t,meta:n||{}}),await this.executeQuery(c)}async createRule({metaType:e,metaId:t,rule:n,policy:i={}}){const s=await this.createMoleculeMutation({mutationClass:fy,molecule:await this.createMolecule({secret:this.getSecret(),sourceWallet:await this.getSourceWallet()})});return s.fillMolecule({metaType:e,metaId:t,rule:n,policy:i}),await this.executeQuery(s)}async createMeta({metaType:e,metaId:t,meta:n=null,policy:i={}}){const s=await this.createMoleculeMutation({mutationClass:Vd,molecule:await this.createMolecule({secret:this.getSecret(),sourceWallet:await this.getSourceWallet()})}),o=n||{};return s.fillMolecule({metaType:e,metaId:t,meta:o,policy:i}),await this.executeQuery(s)}async createIdentifier({type:e,contact:t,code:n}){const i=await this.createMoleculeMutation({mutationClass:Ld});return i.fillMolecule({type:e,contact:t,code:n}),await this.executeQuery(i)}async createPolicy({metaType:e,metaId:t,policy:n={}}){const i=await this.createMolecule({});i.addPolicyAtom({metaType:e,metaId:t,meta:{},policy:n}),i.addContinuIdAtom(),i.sign({bundle:this.getBundle()}),i.check();const s=await this.createMoleculeMutation({mutationClass:Ne,molecule:i});return await this.executeQuery(s)}async queryPolicy({metaType:e,metaId:t}){const n=this.createQuery(uy);return await this.executeQuery(n,{metaType:e,metaId:t})}queryWallets({bundle:e=null,token:t=null,unspent:n=!0}){this.log("info",`KnishIOClient::queryWallets() - Querying wallets${e?` for ${e}`:""}...`);const i=this.createQuery(Td);return this.executeQuery(i,{bundleHash:e||this.getBundle(),tokenSlug:t,unspent:n}).then(s=>s.payload())}queryBundle({bundle:e=null,fields:t=null,raw:n=!1}){this.log("info",`KnishIOClient::queryBundle() - Querying wallet bundle metadata${e?` for ${e}`:""}...`),e||(e=this.getBundle()),typeof e=="string"&&(e=[e]);const i=this.createQuery(kd);return this.executeQuery(i,{bundleHashes:e}).then(s=>n?s:s.payload())}async queryContinuId({bundle:e}){const t=this.createQuery(_d);return this.executeQuery(t,{bundle:e})}async requestTokens({token:e,to:t,amount:n=null,units:i=[],meta:s=null,batchId:o=null}){let a,c;s=s||{};const l=this.createQuery(sy),u=await this.executeQuery(l,{slug:e}),d=le.get(u.data(),"0.fungibility")==="stackable";if(!d&&o!==null)throw new kn("Expected Batch ID = null for non-stackable tokens.");if(d&&o===null&&(o=vn({})),i.length>0){if(n>0)throw new Zn;n=i.length,s.tokenUnits=JSON.stringify(i)}t?(Object.prototype.toString.call(t)==="[object String]"&&(Y.isBundleHash(t)?(a="walletBundle",c=t):t=Y.create({secret:t,token:e})),t instanceof Y&&(a="wallet",s.position=t.position,s.bundle=t.bundle,c=t.address)):(a="walletBundle",c=this.getBundle());const p=await this.createMoleculeMutation({mutationClass:Fd});return p.fillMolecule({token:e,amount:n,metaType:a,metaId:c,meta:s,batchId:o}),await this.executeQuery(p)}async claimShadowWallet({token:e,batchId:t=null,molecule:n=null}){const i=await this.createMoleculeMutation({mutationClass:qd,molecule:n});return i.fillMolecule({token:e,batchId:t}),await this.executeQuery(i)}async claimShadowWallets({token:e}){const t=await this.queryWallets({token:e});if(!t||!Array.isArray(t))throw new ic;t.forEach(i=>{if(!i.isShadow())throw new ic});const n=[];for(const i of t)n.push(await this.claimShadowWallet({token:e,batchId:i.batchId}));return n}async transferToken({bundleHash:e,token:t,amount:n=null,units:i=[],batchId:s=null,sourceWallet:o=null}){if(i.length>0){if(n>0)throw new Zn;n=i.length}if(o===null&&(o=await this.querySourceWallet({token:t,amount:n})),o===null||Zt.cmp(o.balance,n)<0)throw new pt;const a=Y.create({bundle:e,token:t});s!==null?a.batchId=s:a.initBatchId({sourceWallet:o});const c=o.createRemainder(this.getSecret());o.splitUnits(i,c,a);const l=await this.createMolecule({sourceWallet:o,remainderWallet:c}),u=await this.createMoleculeMutation({mutationClass:Pd,molecule:l});return u.fillMolecule({recipientWallet:a,amount:n}),await this.executeQuery(u)}async depositBufferToken({tokenSlug:e,amount:t,tradeRates:n,sourceWallet:i=null}){i===null&&(i=await this.querySourceWallet({token:e,amount:t}));const s=i.createRemainder(this.getSecret()),o=await this.createMolecule({sourceWallet:i,remainderWallet:s}),a=await this.createMoleculeMutation({mutationClass:hy,molecule:o});return a.fillMolecule({amount:t,tradeRates:n}),await this.executeQuery(a)}async withdrawBufferToken({tokenSlug:e,amount:t,sourceWallet:n=null,signingWallet:i=null}){n===null&&(n=await this.querySourceWallet({token:e,amount:t,type:"buffer"}));const s=n,o=await this.createMolecule({sourceWallet:n,remainderWallet:s}),a=await this.createMoleculeMutation({mutationClass:py,molecule:o}),c={};return c[this.getBundle()]=t,a.fillMolecule({recipients:c,signingWallet:i}),await this.executeQuery(a)}async burnTokens({token:e,amount:t=null,units:n=[],sourceWallet:i=null}){i===null&&(i=await this.querySourceWallet({token:e,amount:t}));const s=i.createRemainder(this.getSecret());if(n.length>0){if(t>0)throw new Zn;t=n.length,i.splitUnits(n,s)}const o=await this.createMolecule({sourceWallet:i,remainderWallet:s});o.burnToken({amount:t}),o.sign({bundle:this.getBundle()}),o.check();const a=await this.createMoleculeMutation({mutationClass:Ne,molecule:o});return this.executeQuery(a)}async replenishToken({token:e,amount:t=null,units:n=[],sourceWallet:i=null}){if(i===null&&(i=(await this.queryBalance({token:e})).payload()),!i)throw new pt("Source wallet is missing or invalid.");const s=i.createRemainder(this.getSecret()),o=await this.createMolecule({sourceWallet:i,remainderWallet:s});o.replenishToken({amount:t,units:n}),o.sign({bundle:this.getBundle()}),o.check();const a=await this.createMoleculeMutation({mutationClass:Ne,molecule:o});return this.executeQuery(a)}async fuseToken({bundleHash:e,tokenSlug:t,newTokenUnit:n,fusedTokenUnitIds:i,sourceWallet:s=null}){if(s===null&&(s=(await this.queryBalance({token:t})).payload()),s===null)throw new pt("Source wallet is missing or invalid.");if(!s.tokenUnits||!s.tokenUnits.length)throw new pt("Source wallet does not have token units.");if(!i.length)throw new pt("Fused token unit list is empty.");const o=[];s.tokenUnits.forEach(d=>{o.push(d.id)}),i.forEach(d=>{if(!o.includes(d))throw new pt(`Fused token unit ID = ${d} does not found in the source wallet.`)});const a=Y.create({bundle:e,token:t});a.initBatchId({sourceWallet:s});const c=s.createRemainder(this.getSecret());s.splitUnits(i,c),n.metas.fusedTokenUnits=s.getTokenUnitsData(),a.tokenUnits=[n];const l=await this.createMolecule({sourceWallet:s,remainderWallet:c});l.fuseToken(s.tokenUnits,a),l.sign({bundle:this.getBundle()}),l.check();const u=await this.createMoleculeMutation({mutationClass:Ne,molecule:l});return this.executeQuery(u)}async requestGuestAuthToken({cellSlug:e,encrypt:t}){this.setCellSlug(e);const n=new Y({secret:gn(await this.getFingerprint()),token:"AUTH"}),i=await this.createQuery(zd),s={cellSlug:e,pubkey:n.pubkey,encrypt:t},o=await i.execute({variables:s});if(o.success()){const a=Lr.create(o.payload(),n);this.setAuthToken(a)}else throw new sc(`KnishIOClient::requestGuestAuthToken() - Authorization attempt rejected by ledger. Reason: ${o.reason()}`);return o}async requestProfileAuthToken({secret:e,encrypt:t}){this.setSecret(e);const n=new Y({secret:e,token:"AUTH"}),i=await this.createMolecule({secret:e,sourceWallet:n}),s=await this.createMoleculeMutation({mutationClass:Rd,molecule:i});s.fillMolecule({meta:{encrypt:t?"true":"false"}});const o=await s.execute({});if(o.success()){const a=Lr.create(o.payload(),n);this.setAuthToken(a)}else throw new sc(`KnishIOClient::requestProfileAuthToken() - Authorization attempt rejected by ledger. Reason: ${o.reason()}`);return o}async requestAuthToken({secret:e=null,seed:t=null,cellSlug:n=null,encrypt:i=!1}){if(this.$__serverSdkVersion<3)return this.log("warn","KnishIOClient::authorize() - Server SDK version does not require an authorization..."),null;e===null&&t&&(e=gn(t)),this.$__authInProcess=!0;let s;return e?s=await this.requestProfileAuthToken({secret:e,encrypt:i}):s=await this.requestGuestAuthToken({cellSlug:n,encrypt:i}),this.log("info",`KnishIOClient::authorize() - Successfully retrieved auth token ${this.$__authToken.getToken()}...`),this.switchEncryption(i),this.$__authInProcess=!1,s}setAuthToken(e){if(!e){this.log("info","KnishIOClient::setAuthToken() - authToken object is empty.");return}this.$__authTokenObjects[this.uri()]=e,this.client().setAuthData(e.getAuthData()),this.$__authToken=e}getAuthToken(){return this.$__authToken}log(e,t){if(this.$__logging)switch(e){case"info":console.info(t);break;case"warn":console.warn(t);break;case"error":console.error(t);break;default:console.log(t)}}}return xe.Atom=Q,xe.KnishIOClient=am,xe.Meta=Ir,xe.Molecule=it,xe.Wallet=Y,xe.base64ToHex=ao,xe.bufferToHexString=rl,xe.charsetBaseConvert=so,xe.chunkSubstr=xr,xe.generateBundleHash=Pt,xe.generateSecret=gn,xe.hexStringToBuffer=nl,xe.hexToBase64=oo,xe.isHex=uo,xe.randomString=yn,Object.defineProperty(xe,Symbol.toStringTag,{value:"Module"}),xe}({});
//# sourceMappingURL=client.iife.js.map
